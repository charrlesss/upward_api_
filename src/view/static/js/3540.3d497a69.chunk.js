(self.webpackChunkupward=self.webpackChunkupward||[]).push([[3540,8658],{9109:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var r=n(74165),a=n(15861),u=n(29439),c=n(39709),o=n(1441),l=n(72791),i=n(91933),s=n(3380),d=n(637),f=n(37209),p=n(11690),h=n(36151),v=n(81258),x=n(16395),C=n(21830),y=n.n(C),N=n(65413),m=n(80184),R=[{key:"Check_Date",label:"Date",width:80},{key:"Bank",label:"Bank",width:150},{key:"Check_No",label:"Check No",width:150},{key:"Check_Amnt",label:"Amount",width:120},{key:"Status",label:"Status",width:150},{key:"RCPNO",label:"RCPNO",width:150}];function k(){var e,t,n,C,k,S,P=(0,l.useContext)(s.V),w=P.myAxios,b=P.user,g=(0,d.Z)().executeQueryToClient,D=(0,l.useState)(""),Z=(0,u.Z)(D,2),E=Z[0],O=Z[1],_=(0,l.useState)(!1),j=(0,u.Z)(_,2),T=j[0],A=j[1],I=(0,l.useState)([]),z=(0,u.Z)(I,2),B=z[0],F=z[1],M=(0,l.useRef)(g),H=(0,l.useRef)(null),L=(0,l.useRef)(null),q=(0,l.useRef)(null),V=(0,l.useRef)(null),W=(0,l.useRef)(null),Y=(0,l.useRef)(null),K=(0,l.useRef)(null),U=(0,l.useRef)(null),G=(0,l.useRef)(null),J=(0,l.useRef)(null),Q=(0,l.useRef)(null),X=(0,i.useMutation)({mutationKey:"save-pullout-request",mutationFn:function(t){return(e=e||(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.post("/task/accounting/pullout/reqeust/save-pullout-request",t,{headers:{Authorization:"Bearer ".concat(null===b||void 0===b?void 0:b.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e,t){var n=e;return n.data.success?(re(t.ppno),ne(),y().fire({position:"center",icon:"success",title:n.data.message,timer:1500})):y().fire({position:"center",icon:"warning",title:n.data.message,timer:1500})}}),$=X.isLoading,ee=X.mutate,te=(0,l.useCallback)((0,a.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!0),"SELECT DISTINCT PNo, Name FROM PDC WHERE PDC_Status = 'Stored' order by PNo DESC",e.next=4,M.current("SELECT DISTINCT PNo, Name FROM PDC WHERE PDC_Status = 'Stored' order by PNo DESC");case 4:t=e.sent,n=t.data,F(n.data),A(!1);case 8:case"end":return e.stop()}}),e)}))),[]),ne=function(){return(n=n||(0,a.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"\n        SELECT\n            right(year(curdate()) ,2) as Year,\n            lpad(COUNT(1) + 1, 4, '0') as Count\n        FROM pullout_request\n            where substring(RCPNo,5,2) = right(year(curdate()) ,2) and Branch = 'HO'",e.next=3,M.current("\n        SELECT\n            right(year(curdate()) ,2) as Year,\n            lpad(COUNT(1) + 1, 4, '0') as Count\n        FROM pullout_request\n            where substring(RCPNo,5,2) = right(year(curdate()) ,2) and Branch = 'HO'");case 3:t=e.sent,n=t.data,V.current&&(V.current.value="HOPO".concat(n.data[0].Year).concat(n.data[0].Count));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)},re=function(e){return(C=C||(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,u,c,o,l,i,s,d,f,p,h,v,x;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H.current.setData([]),u="add"===E?null===(n=V.current)||void 0===n?void 0:n.value:null===(a=q.current)||void 0===a?void 0:a.value,c="\n          SELECT DISTINCT\n                    date_format(Check_Date,'%Y-%d-%m') as Check_Date,\n                    Bank,\n                    Check_No,\n                    Check_Amnt,\n                    ifnull(c.Status,'--') as Status,\n                    ifnull(c.RCPNo,'--') as RCPNO\n                FROM\n                    PDC a\n                    left join pullout_request_details b on a.Check_No = b.CheckNo\n\t\t\t\t\tleft join pullout_request c on b.RCPNo = c.RCPNo\n                WHERE\n                    PNo = '".concat(t,"'\n\t\t\t\t\tAND PDC_Status = 'Stored'\n                ORDER BY Check_No\n        "),e.next=5,M.current(c);case 5:if(o=e.sent,l=o.data,"edit"!=E){e.next=20;break}return i="\n            SELECT DISTINCT\n                      Check_No\n                  FROM\n                      PDC a\n                      left join pullout_request_details b on a.Check_No = b.CheckNo    \n                      left join pullout_request c on b.RCPNo = c.RCPNo   \n                  WHERE\n                      PNo = '".concat(t,"'\n                      AND PDC_Status = 'Stored'\n                      AND c.Status is not null\n                      AND c.RCPNo = '").concat(u,"'\n                  ORDER BY Check_No\n          "),e.next=11,M.current(i);case 11:s=e.sent,d=s.data,f=d.data.map((function(e){return e.Check_No})),p=l.data.map((function(e,t){return f.includes(e.Check_No)?t:null})),h=p.filter((function(e){return null!==e})),H.current.setDataFormated(l.data),H.current.setSelectedRow(h),e.next=24;break;case 20:v=l.data.map((function(e,t){return"--"!==e.RCPNO&&""!==e.RCPNO&&"APPROVED"!==e.Status?t:null})),x=v.filter((function(e){return null!==e})),H.current.setDataFormated(l.data),H.current.setSelectedRow(x);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)},ae=function(){setTimeout((function(){V.current&&(V.current.value=""),W.current&&(W.current.value=""),Y.current&&(Y.current.value=""),K.current&&(K.current.selectedIndex=0)}),100)};return(0,l.useEffect)((function(){te()}),[te]),(0,m.jsxs)("div",{style:{flex:"1",display:"flex",justifyContent:"center",alignItems:"center",background:"#F1F1F1"},children:[$&&(0,m.jsx)(N.g,{}),(0,m.jsxs)("div",{style:{padding:"10px",width:"62%",border:"1px sold black",height:"500px",boxShadow:"1px 1px 2px 2px black",display:"flex",flexDirection:"column"},children:[(0,m.jsxs)("div",{style:{height:"auto"},children:["edit"===E&&(T?(0,m.jsx)(c.Z,{loading:T}):(0,m.jsx)("div",{style:{width:"100%",marginBottom:"8px"},children:(0,m.jsx)(f.lq,{ref:L,label:{title:"RCP No.  : ",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},selectRef:q,select:{style:{flex:1,height:"22px"},defaultValue:"Non-VAT",onChange:function(e){return(k=k||(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,u;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("edit"!==E){e.next=7;break}return n="\n                                                Select \n                                                        *,\n                                                        (selecT distinct(name) from pdc where PNo =a.PNNo) as 'Name'\n                                                    From PullOut_Request a \n                                                    Where Branch = 'HO' and Status = 'PENDING' and rcpno = '".concat(t.currentTarget.value,"' \n                                                    Order by RCPNo\n                                                "),e.next=4,M.current(n);case 4:a=e.sent,(u=a.data).data.length>0?(0,x.wait)(100).then((function(){W.current&&(W.current.value=u.data[0].PNNo),Y.current&&(Y.current.value=u.data[0].Name),K.current&&(K.current.value=u.data[0].Reason),re(u.data[0].PNNo)})):(H.current.setData([]),ae());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},containerStyle:{width:"50%",marginBottom:"12px"},datasource:[],values:"RCPNo",display:"RCPNo"})})),(""===E||"add"===E)&&(0,m.jsx)(f.oi,{containerStyle:{width:"50%",marginBottom:"8px"},label:{title:"RCP No. :",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},input:{disabled:!0,type:"text",style:{width:"calc(100% - 100px)"},onKeyDown:function(e){"NumpadEnter"===e.code||e.code}},inputRef:V}),T?(0,m.jsx)(c.Z,{loading:T}):(0,m.jsx)("div",{style:{width:"50%",marginBottom:"8px"},children:(0,m.jsx)(o.Autocomplete,{disableInput:""===E||"edit"===E,label:{title:"PN No. :",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},input:{id:"auto-solo-collection",style:{width:"100%",flex:1}},width:"100%",DisplayMember:"PNo",DataSource:B,inputRef:W,onChange:function(e,t){W.current&&(W.current.value=e.PNo),Y.current&&(Y.current.value=e.Name),K.current&&K.current.selectedIndex>0&&re(e.PNo)},onKeydown:function(e){"Enter"!==e.key&&"NumpadEnter"!==e.key||e.preventDefault()}})}),T?(0,m.jsx)(c.Z,{loading:T}):(0,m.jsx)("div",{style:{width:"50%",marginBottom:"8px"},children:(0,m.jsx)(o.Autocomplete,{disableInput:""===E||"edit"===E,label:{title:"Client :",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},input:{id:"auto-solo-collection",style:{width:"100%",flex:1}},width:"100%",DisplayMember:"Name",DataSource:B,inputRef:Y,onChange:function(e,t){W.current&&(W.current.value=e.PNo),Y.current&&(Y.current.value=e.Name),K.current&&K.current.selectedIndex>0&&re(e.PNo)},onKeydown:function(e){"Enter"!==e.key&&"NumpadEnter"!==e.key||e.preventDefault()}})}),(0,m.jsx)(f.lq,{label:{title:"Reason : ",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},selectRef:K,select:{disabled:""===E,style:{flex:1,height:"22px"},defaultValue:"Non-VAT",onChange:function(e){W.current&&re(W.current.value)}},containerStyle:{width:"50%",marginBottom:"12px"},datasource:[{key:"",value:""},{key:"Fully Paid",value:"Fully Paid"},{key:"Cash Replacement",value:"Cash Replacement"},{key:"Check Replacement",value:"Check Replacement"},{key:"Account Closed",value:"Account Closed"},{key:"Hold",value:"Hold"},{key:"Not Renewed by Camfin",value:"Not Renewed by Camfin"}],values:"value",display:"key"})]}),(0,m.jsx)(p.O0,{ref:H,columns:R,rows:[],containerStyle:{flex:1},rowIsSelectable:function(e){return["APPROVED","PENDING"].includes(e[4])},getSelectedItem:function(e){},onKeyDown:function(e,t,n){},onCheckAll:function(){var e=H.current.getData().map((function(e,t){return"--"!==e.RCPNO&&""!==e.RCPNO&&"APPROVED"!==e.Status?t:null})).filter((function(e){return null!==e}));H.current.setSelectedRow(e)},onUnCheckAll:function(){H.current.setSelectedRow([])}}),(0,m.jsx)("div",{style:{height:"35px",display:"flex",justifyContent:"flex-end",alignItems:"center",columnGap:"5px"},children:""===E?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(h.Z,{ref:U,variant:"contained",color:"info",style:{height:"25px",fontSize:"12px"},onClick:function(e){O("add"),ae(),J.current&&(J.current.disabled=!1),setTimeout((function(){ne()}),100)},children:"Add"}),(0,m.jsx)(h.Z,{ref:G,variant:"contained",color:"success",style:{height:"25px",fontSize:"12px",background:v.Z[800]},onClick:function(e){O("edit"),function(){(t=t||(0,a.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,M.current("\n        select '' as RCPNo\n        union \n        SELECT DISTINCT\n            (RCPNo)\n        FROM\n            PullOut_Request\n        WHERE\n            Branch = 'HO' AND Status = 'PENDING'\n        ORDER BY RCPNo\n        ");case 3:t=e.sent,n=t.data,(0,x.wait)(100).then((function(){L.current.setDataSource(n.data)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}()},children:"edit"})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(h.Z,{ref:J,variant:"contained",color:"success",style:{height:"25px",fontSize:"12px"},onClick:function(e){return(S=S||(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,u,c,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=H.current.getSelectedRowsData()).length<=0)){e.next=3;break}return e.abrupt("return",alert("No selected row found!"));case 3:a=n.map((function(e){return{Check_Date:e[0],Bank:e[1],Check_No:e[2],Check_Amnt:e[3],Status:e[4],RCPNO:e[5]}})),W.current&&Y.current&&K.current&&(o="add"===E?null===(u=V.current)||void 0===u?void 0:u.value:null===(c=q.current)||void 0===c?void 0:c.value,ee({flag:E,rcpn:o,ppno:W.current.value,name:Y.current.value,reason:K.current.value,data:JSON.stringify(a)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)},children:"save"}),(0,m.jsx)(h.Z,{ref:Q,variant:"contained",color:"error",style:{height:"25px",fontSize:"12px"},onClick:function(e){O(""),ae(),H.current.setData([])},children:"cancel"})]})})]})]})}},42419:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var a=r(n(45649)),u=n(80184),c=(0,a.default)((0,u.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");t.Z=c},29823:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var a=r(n(45649)),u=n(80184),c=(0,a.default)((0,u.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");t.Z=c},85172:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var a=r(n(45649)),u=n(80184),c=(0,a.default)((0,u.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");t.Z=c},91421:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var a=r(n(45649)),u=n(80184),c=(0,a.default)([(0,u.jsx)("circle",{cx:"10",cy:"8",r:"4"},"0"),(0,u.jsx)("path",{d:"M10.35 14.01C7.62 13.91 2 15.27 2 18v2h9.54c-2.47-2.76-1.23-5.89-1.19-5.99zm9.08 4.01c.36-.59.57-1.28.57-2.02 0-2.21-1.79-4-4-4s-4 1.79-4 4 1.79 4 4 4c.74 0 1.43-.22 2.02-.57L20.59 22 22 20.59l-2.57-2.57zM16 18c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"},"1")],"PersonSearch");t.Z=c},86753:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var a=r(n(45649)),u=n(80184),c=(0,a.default)((0,u.jsx)("path",{d:"M12 5V2L8 6l4 4V7c3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93 0-4.42-3.58-8-8-8zm-6 8c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91z"}),"RestartAlt");t.Z=c},53329:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var a=r(n(45649)),u=n(80184),c=(0,a.default)((0,u.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");t.Z=c},5403:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var a=r(n(45649)),u=n(80184),c=(0,a.default)((0,u.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search");t.Z=c},80888:function(e,t,n){"use strict";var r=n(79047);function a(){}function u(){}u.resetWarningCache=a,e.exports=function(){function e(e,t,n,a,u,c){if(c!==r){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:u,resetWarningCache:a};return n.PropTypes=n,n}},52007:function(e,t,n){e.exports=n(80888)()},79047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}}]);
//# sourceMappingURL=3540.3d497a69.chunk.js.map