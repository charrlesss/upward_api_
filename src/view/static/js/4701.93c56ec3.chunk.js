"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[4701,2074],{85074:function(e,n,t){t.r(n),t.d(n,{creditColumn:function(){return ie},debitColumn:function(){return oe},default:function(){return ce},reducer:function(){return ee},setNewStateValue:function(){return le}});var o=t(74165),i=t(15861),a=t(93433),r=t(29439),c=t(4942),l=t(1413),u=t(72791),d=t(64554),s=t(27391),h=t(36151),f=t(13239),p=t(68096),m=t(94925),x=t(77196),v=t(63466),C=t(13400),k=t(58406),y=t(23786),g=t(73766),D=t(88447),N=t(20890),_=t(42419),I=t(91933),T=t(21830),b=t.n(T),w=t(80007),A=t(29823),E=t(53329),S=t(91421),F=t(41128),R=t(3380),B=t(79018),Z=t(13784),P=t(99422),j=t(39709),L=t(56580),M=t(8185),z=t(93263),U=t(81582),O=t(54164),K=t(80184),q=function(e){var n,t=e.link,a=e.uniqueId,c=e.queryKey,l=e.responseDataKey,d=e.columns,s=e.onSelected,h=void 0===s?function(){}:s,f=e.onRemoveSelected,p=void 0===f?function(){}:f,m=e.onSuccess,x=void 0===m?function(){}:m,v=e.searchRef,C=e.onCellKeyDown,k=e.onCloseFunction,y=e.isRowSelectable,g=(0,u.useContext)(R.V),D=g.myAxios,N=g.user,_=(0,u.useState)(!1),T=(0,r.Z)(_,2),b=T[0],w=T[1],A=(0,u.useState)([]),E=(0,r.Z)(A,2),S=E[0],F=E[1],B=(0,I.useMutation)({mutationKey:c,mutationFn:function(e){return(n=n||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.get("".concat(t.queryWithVariable(n)),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var n=e;F(n.data[l]),x(n)}}),Z=B.isLoading,P=B.mutate;return{openSearchCollection:b,rows:S,isLoading:Z,openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,O.flushSync)((function(){w(!0)})),null!==v&&void 0!==v&&v.current&&(v.current.value=e,D.get("".concat(t.queryExtraBySearch,"=").concat(e),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l]),null!==v&&void 0!==v&&v.current&&v.current.focus()})))},closeModal:function(){var e;(w(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},ModalComponent:(0,K.jsx)(U.ZP,{searchRef:v,showModal:b,onCloseModal:function(){var e;(w(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},onClickCloseIcon:function(){var e;(w(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},searchOnChange:function(e){D.get("".concat(t.queryExtraBySearch,"=").concat(e.target.value),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l])}))},onSearchKeyEnter:function(e){D.get("".concat(t.queryExtraBySearch,"=").concat(e),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l])}))},onCellKeyDown:C,height:300,isLoading:Z,queryKey:c,columns:d,onSelectionChange:function(e,n){if(e.length<=0)return p(n);var t=new Set(e),o=n.filter((function(e){return t.has(e[a].toString())}));o.length<=0||h(o,n)},isRowSelectable:y,id:a,rows:S,setRows:F}),mutate:P}},V=t(86753),W=t(64230),Y=t(93346),H=t(70272),G=(0,u.createContext)({debit:[],credit:[]}),Q={ORNo:"",PNo:"",IDNo:"",Date:new Date,Name:"",Remarks:"",creditUpdateMode:!1,creditCheckIdx:"",creditCheckID:"",PDC_Status:"",Deposit_Slip:"",DateDeposit:"",OR_No:"",searchCheckedList:"",bank_transaction:"",isFao:!1,search:"",mode:""},J={cashID:"",cashMode:"add",payamentType:"CSH",amount:"",transaction_desc:[],debitHasSelected:!1},X={creditMode:"add",creditId:"",transaction:"",amount:"",FAO_Name:"",FAO_ID:"",remarks:"",option:"Non-Vat",invoice:"",Code:"",Title:"",TC:""},$={CheckIdx:"",BankName:"",BankCode:"",Branch:"",Check_Date:new Date,Check_No:"",Check_Amnt:"",Check_Remarks:"",CheckMode:"add"},ee=function(e,n){return"UPDATE_FIELD"===n.type?(0,l.Z)((0,l.Z)({},e),{},(0,c.Z)({},n.field,n.value)):e},ne="add-collection",te="collection-data-search",oe=[{field:"Payment",headerName:"Payment",flex:1,width:170},{field:"Amount",headerName:"Amount",flex:1,width:170,type:"number"},{field:"Check_No",headerName:"Check No",width:170},{field:"Check_Date",headerName:"Check Date",width:170},{field:"Bank_Branch",headerName:"Bank/Branch",width:300},{field:"Acct_Code",headerName:"DR Code",width:170},{field:"Acct_Title",headerName:"DR Title",width:300},{field:"Deposit_Slip",headerName:"Deposit Slip",width:170},{field:"Cntr",headerName:"Cntr",width:170},{field:"Remarks",headerName:"Remarks",width:300},{field:"TC",headerName:"TC",width:170},{field:"temp_id",headerName:"temp_id",hide:!0},{field:"Bank",headerName:"Bank",hide:!0},{field:"BankName",headerName:"BankName",hide:!0}],ie=[{field:"temp_id",headerName:"temp_id",hide:!0},{field:"transaction",headerName:"Transaction",width:200},{field:"amount",headerName:"Amount",width:150,type:"number"},{field:"Remarks",headerName:"Remarks",width:350},{field:"Code",headerName:"Code",width:150},{field:"Title",headerName:"Title",width:350},{field:"TC",headerName:"TC",width:200},{field:"Account_No",headerName:"Accoount No.",width:180},{field:"Name",headerName:"Name",width:350},{field:"VATType",headerName:"VAT Type",width:150},{field:"invoiceNo",headerName:"Invoice No",width:250}],ae="payment-type-code",re="new-or-number";function ce(){var e,n,t,T,U,ce,he=(0,u.useState)([]),fe=(0,r.Z)(he,2),pe=fe[0],me=fe[1],xe=(0,u.useState)([]),ve=(0,r.Z)(xe,2),Ce=ve[0],ke=ve[1],ye=(0,u.useState)(!1),ge=(0,r.Z)(ye,2),De=ge[0],Ne=ge[1],_e=(0,F.Z)(),Ie=_e.searchParams,Te=_e.setSearchParams,be=(0,u.useReducer)(ee,Q),we=(0,r.Z)(be,2),Ae=we[0],Ee=we[1],Se=(0,u.useReducer)(ee,J),Fe=(0,r.Z)(Se,2),Re=Fe[0],Be=Fe[1],Ze=(0,u.useReducer)(ee,X),Pe=(0,r.Z)(Ze,2),je=Pe[0],Le=Pe[1],Me=(0,u.useReducer)(ee,$),ze=(0,r.Z)(Me,2),Ue=ze[0],Oe=ze[1],Ke=(0,u.useContext)(R.V),qe=Ke.myAxios,Ve=Ke.user,We=(0,u.useState)(""!==Ie.get("selected")),Ye=(0,r.Z)(We,2),He=Ye[0],Ge=Ye[1],Qe=(0,u.useState)(""!==Ie.get("selected")),Je=(0,r.Z)(Qe,2),Xe=Je[0],$e=Je[1],en=(0,u.useState)(!1),nn=(0,r.Z)(en,2),tn=nn[0],on=nn[1],an=(0,u.useRef)(null),rn=(0,u.useRef)(null),cn=(0,u.useRef)(null),ln=(0,u.useRef)(null),un=(0,u.useRef)(null),dn=(0,u.useRef)(null),sn=(0,u.useRef)(null),hn=(0,u.useRef)(null),fn=(0,u.useRef)(null),pn=(0,u.useRef)(null),mn=(0,u.useRef)(null),xn=(0,u.useRef)(null),vn=(0,u.useRef)(null),Cn=(0,u.useRef)(null),kn=(0,u.useRef)(null),yn=(0,u.useRef)(null),gn=(0,u.useRef)(null),Dn=(0,u.useRef)(null),Nn=(0,u.useRef)(null),_n=(0,u.useRef)(null),In=(0,u.useRef)(null),Tn=(0,u.useRef)(null),bn=(0,I.useQueryClient)(),wn=(0,u.useRef)(null),An=(0,u.useRef)(null),En=(0,u.useRef)(null),Sn=(0,u.useRef)(null),Fn=(0,u.useRef)(null),Rn=(0,u.useRef)(null),Bn=(0,z.Z)({link:{url:"/task/accounting/search-pdc-policy-id",queryUrlName:"searchPdcPolicyIds"},columns:[{field:"Type",headerName:"Type",width:130},{field:"IDNo",headerName:"ID No.",width:200},{field:"Name",headerName:"Name",flex:1},{field:"ID",headerName:"ID",flex:1,hide:!0}],queryKey:"collection-polidy-ids",uniqueId:"IDNo",responseDataKey:"clientsId",onSelected:function(e,n){var t;Ee({type:"UPDATE_FIELD",field:"PNo",value:e[0].IDNo}),Ee({type:"UPDATE_FIELD",field:"IDNo",value:e[0].client_id}),Ee({type:"UPDATE_FIELD",field:"Name",value:null!==(t=e[0].Name)&&void 0!==t?t:""}),Ln(),(0,B.D)(50).then((function(){var e;null===(e=yn.current)||void 0===e||e.focus()}))},searchRef:dn}),Zn=Bn.ModalComponent,Pn=Bn.openModal,jn=Bn.isLoading,Ln=Bn.closeModal,Mn=(0,z.Z)({link:{url:"/task/accounting/search-pdc-policy-id",queryUrlName:"searchPdcPolicyIds"},columns:[{field:"Type",headerName:"Type",width:130},{field:"IDNo",headerName:"ID No.",width:200},{field:"Name",headerName:"Name",flex:1},{field:"ID",headerName:"ID",flex:1,hide:!0}],queryKey:"collection-polidy-ids",uniqueId:"IDNo",responseDataKey:"clientsId",onSelected:function(e,n){var t;Le({type:"UPDATE_FIELD",field:"FAO_ID",value:e[0].IDNo}),Le({type:"UPDATE_FIELD",field:"FAO_Name",value:null!==(t=e[0].Name)&&void 0!==t?t:""}),Kn(),(0,B.D)(50).then((function(){var e;null===(e=Fn.current)||void 0===e||e.focus()}))},searchRef:dn}),zn=Mn.ModalComponent,Un=Mn.openModal,On=Mn.isLoading,Kn=Mn.closeModal,qn=(0,z.Z)({link:{url:"/task/accounting/search-collection",queryUrlName:"searchCollectionInput"},columns:[{field:"Date",headerName:"OR Date",width:170},{field:"ORNo",headerName:"OR No.",width:200},{field:"Name",headerName:"Name",flex:1}],queryKey:"collection-search",uniqueId:"ORNo",responseDataKey:"collection",onSelected:function(e,n){ft({ORNo:e[0].ORNo})},onCloseFunction:function(e){Ee({type:"UPDATE_FIELD",field:"search",value:e})},searchRef:sn}),Vn=qn.ModalComponent,Wn=qn.openModal,Yn=qn.closeModal,Hn=qn.isLoading,Gn=(0,z.Z)({link:{url:"/task/accounting/search-pdc-banks",queryUrlName:"searchPdcBanks"},columns:[{field:"Bank_Code",headerName:"Code",width:130},{field:"Bank",headerName:"Bank Name",flex:1}],queryKey:"collection-banks",uniqueId:"Bank_Code",responseDataKey:"pdcBanks",onSelected:function(e,n){Oe({type:"UPDATE_FIELD",field:"BankName",value:e[0].Bank}),Oe({type:"UPDATE_FIELD",field:"BankCode",value:e[0].Bank_Code}),Xn(),setTimeout((function(){xn.current&&xn.current.focus()}),100)},searchRef:hn}),Qn=Gn.ModalComponent,Jn=Gn.openModal,Xn=Gn.closeModal,$n=Gn.isLoading,et=q({link:{queryWithVariable:function(e){return"/task/accounting/get-client-checked-by-id?PNo=".concat(e.PNo,"&searchCheckedList=").concat(e.searchCheckedList)},queryExtraBySearch:"/task/accounting/get-client-checked-by-id?PNo=".concat(Ae.PNo,"&searchCheckedList")},columns:[{field:"temp_id",headerName:"temp_id",width:0,hide:!0},{field:"Check_No",headerName:"Check No",width:130},{field:"Check_Date",headerName:"Check Date",flex:1},{field:"Amount",headerName:"Amount",width:200,type:"number"},{field:"Bank_Branch",headerName:"Bank Branch",width:200},{field:"Remarks",headerName:"Remarks",width:200,hide:!0}],queryKey:"collection-client-check",uniqueId:"temp_id",responseDataKey:"clientCheckedList",onSelected:function(e,n){Ce.filter((function(e){return""!==e.Check_No})).map((function(e){return e.Check_No})).includes(e[0].Check_No)||qe.post("/task/accounting/get-drcode-drtitle-from-collection",{code:Re.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}}).then((function(n){var t;console.log(n);var o=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.data[0],i=o.Acct_Code,r=o.Acct_Title;ke((function(n){var t=0;return t=n.length<=0?0:parseInt(n[n.length-1].temp_id)+1,n=[].concat((0,a.Z)(n),[{Payment:"Check",Amount:e[0].Amount,Check_No:e[0].Check_No,Check_Date:e[0].Check_Date,Bank_Branch:e[0].Bank_Branch,Acct_Code:i,Acct_Title:r,Deposit_Slip:"",Cntr:"",Remarks:e[0].Remarks,TC:Re.payamentType,temp_id:t.toString(),Bank:e[0].Bank,BankName:e[0].BankName,Check_Remarks:e[0].Check_Remarks,Branch:e[0].Branch}])})),ot()}))},onSuccess:function(e){tt()},searchRef:fn,isRowSelectable:function(e){return!Ce.filter((function(e){return""!==e.Check_No})).map((function(e){return e.Check_No})).includes(e.row.Check_No)}}),nt=et.ModalComponent,tt=et.openModal,ot=et.closeModal,it=et.isLoading,at=et.mutate,rt=(0,I.useQuery)({queryKey:ae,queryFn:function(){return(e=e||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qe.get("/task/accounting/get-transaction-code-title",{headers:{Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},refetchOnWindowFocus:!1,onSuccess:function(e){Be({type:"UPDATE_FIELD",field:"transaction_desc",value:e.data.transactionDesc})}}),ct=rt.isLoading,lt=(0,I.useQuery)({queryKey:re,queryFn:function(){return(n=n||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qe.get("/task/accounting/get-new-or-number",{headers:{Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},refetchOnWindowFocus:!1,onSuccess:function(e){var n,t,o=e;Ee({type:"UPDATE_FIELD",field:"ORNo",value:null===(n=o.data)||void 0===n?void 0:n.ORNo[0].collectionID}),Ee({type:"UPDATE_FIELD",field:"OR_No",value:null===(t=o.data)||void 0===t?void 0:t.ORNo[0].collectionID})}}),ut=lt.isLoading,dt=lt.refetch,st=(0,I.useMutation)({mutationKey:te,mutationFn:function(e){return(t=t||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qe.get("/task/accounting/get-collection-data-search?ORNo=".concat(n.ORNo),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var n=e.data.collection,t=n[0].ORNo,o=n[0].Date_OR,i=n[0].ID_No,a={ORNo:t,PNo:i,IDNo:i,Date:o,Name:n[0].Short},r=[],c=[];function l(e){var n=new Date(e);return n instanceof Date&&!isNaN(n.getTime())}for(var u=0;u<=n.length-1;u++)""!==n[u].Payment&&"0"!==n[u].Debit&&r.push({Payment:n[u].Payment,Amount:n[u].Debit,Check_No:n[u].Check_No,Check_Date:l(n[u].Check_Date)?new Date(n[u].Check_Date).toLocaleDateString():"",Bank_Branch:n[u].Bank,Acct_Code:n[u].DRCode,Acct_Title:n[u].DRTitle,Deposit_Slip:n[u].SlipCode,Cntr:"",Remarks:n[u].DRRemarks,TC:n[u].Check_No?"CHK":"CSH",temp_id:"".concat(u),Bank:n[u].Bank_Code,BankName:n[u].BankName,Branch:n[u].Branch,Check_Remarks:n[u].DRRemarks}),""!==n[u].Purpose&&"0"!==n[u].Credit&&""!==n[u].CRCode&&""!==n[u].CRTitle&&""!==n[u].CRLoanID&&""!==n[u].CRLoanName&&""!==n[u].CRVatType&&""!==n[u].CRInvoiceNo&&c.push({temp_id:"".concat(u),transaction:n[u].Purpose,amount:n[u].Credit,Remarks:n[u].CRRemarks,Code:n[u].CRCode,Title:n[u].CRTitle,TC:n[u].CRTitle,Account_No:n[u].CRLoanID,Name:n[u].CRLoanName,VATType:n[u].CRVATType,invoiceNo:n[u].CRInvoiceNo});le(Ee,a),ke(r),me(c),$e(!0),Ge(!0),on(!0),Yn()}}),ht=st.isLoading,ft=st.mutate,pt=(0,I.useMutation)({mutationKey:ne,mutationFn:function(e){return(T=T||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!tn){e.next=5;break}return delete n.mode,e.next=4,qe.post("/task/accounting/update-collection",n,{headers:{Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}});case 4:case 8:return e.abrupt("return",e.sent);case 5:return delete n.mode,e.next=8,qe.post("/task/accounting/add-collection",n,{headers:{Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){if(e.data.success)return Ge(!1),$e(!1),le(Ee,Q),bn.invalidateQueries("collection-search"),on(!1),ke([]),me([]),dt(),b().fire({position:"center",icon:"success",title:e.data.message,showConfirmButton:!1,timer:1500});b().fire({position:"center",icon:"error",title:e.data.message,showConfirmButton:!1,timer:1500})}}),mt=pt.mutate,xt=pt.isLoading,vt=pt.variables,Ct=(0,I.useMutation)({mutationKey:"on-print",mutationFn:function(e){return(U=U||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qe.post("/task/accounting/on-print",n,{headers:{Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){e.data.success&&function(e){var n=e.data.concat(e.data1);(0,O.flushSync)((function(){localStorage.removeItem("printString"),localStorage.setItem("dataString",JSON.stringify(n)),localStorage.setItem("paper-width","8.5in"),localStorage.setItem("paper-height","11in"),localStorage.setItem("module","collection"),"UMIS"===(null===Ve||void 0===Ve?void 0:Ve.department)?localStorage.setItem("title","UMIS"===(null===Ve||void 0===Ve?void 0:Ve.department)?"UPWARD MANAGEMENT INSURANCE SERVICES":"UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC."):localStorage.setItem("title","UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC.")})),window.open("/dashboard/print","_blank")}(e.data)}}),kt=Ct.mutate,yt=Ct.isLoading,gt=function(e){var n=e.target,t=n.name,o=n.value;Ee({type:"UPDATE_FIELD",field:t,value:o})},Dt=function(e){var n=e.target,t=n.name,o=n.value;Be({type:"UPDATE_FIELD",field:t,value:o})},Nt=function(e){var n=e.target,t=n.name,o=n.value;Le({type:"UPDATE_FIELD",field:t,value:o})};function _t(e){var n=e.target,t=n.name,o=n.value;Oe({type:"UPDATE_FIELD",field:t,value:o})}function It(e,n){b().fire({text:e,icon:"warning",showCancelButton:!1,timer:1500}).then(n)}var Tt=window.innerWidth-70,bt=window.innerHeight-500;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(H.Z,{title:"Collection"}),(0,K.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:1,padding:"5px"},children:[(0,K.jsxs)(G.Provider,{value:{credit:pe,debit:Ce},children:[(0,K.jsxs)("div",{style:{height:"auto"},children:[(0,K.jsx)(d.Z,{sx:function(e){return(0,c.Z)({display:"flex",alignItems:"center",columnGap:"20px"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-start",flex:1,marginBottom:"15px"})},children:(0,K.jsx)("div",{style:{display:"flex",alignItems:"center",columnGap:"20px"},children:(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[Hn?(0,K.jsx)(j.Z,{loading:Hn}):(0,K.jsx)(s.Z,{label:"Search",size:"small",name:"search",value:Ae.search,onChange:gt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return e.preventDefault(),Wn(e.target.value)},InputProps:{style:{height:"27px",fontSize:"14px"}},sx:{width:"300px",height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),!He&&(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,K.jsx)(_.Z,{sx:{width:15,height:15}}),id:"entry-header-save-button",onClick:function(){$e(!0),Ge(!0),Te((function(e){return e.set("selected",""),e})),ke([]),me([]),on(!1)},children:"New"}),(0,K.jsxs)(d.Z,{sx:{position:"relative"},children:[(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},ref:un,id:"save-entry-header",color:"success",variant:"contained",type:"submit",onClick:function(e){if(e.preventDefault(),""===Ae.ORNo)return b().fire({position:"center",icon:"warning",title:"Please provide OR number",timer:1500});if(""===Ae.PNo)return Ee({type:"UPDATE_FIELD",field:"isFao",value:!1}),b().fire({position:"center",icon:"warning",title:"Please provide PN/Client ID",timer:1500}).then((function(){(0,B.D)(350).then((function(){Pn()}))}));if(Ce.length<=0)return b().fire({position:"center",icon:"warning",title:"Please provide debit entry",timer:1500}).then((function(){(0,B.D)(300).then((function(){var e;null===(e=yn.current)||void 0===e||e.focus()}))}));if(pe.length<=0)return b().fire({position:"center",icon:"warning",title:"Please provide credit entry",timer:1500}).then((function(){(0,B.D)(300).then((function(){var e;null===(e=Dn.current)||void 0===e||e.focus()}))}));if(Ce.reduce((function(e,n){return e+parseFloat(n.Amount.toString().replace(/,/g,""))}),0)!==pe.reduce((function(e,n){return e+parseFloat(n.amount.toString().replace(/,/g,""))}),0))return b().fire({position:"center",icon:"warning",title:"Transaction is not balanced. Check if the amount you entered are correct!",timer:1500});if(Ae.PNo.length>=200)return b().fire({position:"center",icon:"warning",title:"PN/Client ID is too long!",timer:1500});var n={ORNo:Ae.ORNo,PNo:Ae.PNo,IDNo:Ae.IDNo,Date:Ae.Date,Name:Ae.Name,debit:JSON.stringify(Ce),credit:JSON.stringify(pe),payamentType:Re.payamentType};tn?(0,W.s)({isUpdate:!0,cb:function(e){mt((0,l.Z)((0,l.Z)({},n),{},{userCodeConfirmation:e,mode:""}))}}):(0,W.L)({isConfirm:function(){mt((0,l.Z)((0,l.Z)({},n),{},{mode:""}))}})},disabled:xt&&void 0===vt.mode||!He,startIcon:(0,K.jsx)(E.Z,{sx:{width:15,height:15}}),children:"Save"}),xt&&void 0===vt.mode&&(0,K.jsx)(f.Z,{size:24,sx:{color:w.Z[500],position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),He&&(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,K.jsx)(A.Z,{sx:{width:15,height:15}}),color:"error",onClick:function(){b().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"}).then((function(e){e.isConfirmed&&(Ge(!1),$e(!1),le(Ee,Q),dt(),ke([]),me([]),on(!1))}))},children:"Cancel"}),(0,K.jsx)(j.Z,{loading:yt,color:"secondary",variant:"contained",sx:{height:"30px",fontSize:"11px"},disabled:!tn,onClick:function(){kt({ORNo:Ae.ORNo})},children:"Print"})]})})}),(0,K.jsx)("form",{onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||e.preventDefault()},children:(0,K.jsx)(d.Z,{sx:function(e){return(0,c.Z)({},e.breakpoints.down("md"),{flexDirection:"column",rowGap:"10px"})},children:(0,K.jsxs)("div",{style:{display:"flex",gap:"10px",padding:"15px 0 "},children:[ut?(0,K.jsx)(j.Z,{loading:ut}):(0,K.jsxs)(p.Z,{sx:{width:"170px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!Xe||tn,required:!0,children:[(0,K.jsx)(m.Z,{htmlFor:"collection-id-field",children:"OR No."}),(0,K.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},readOnly:"UCSMI"!==(null===Ve||void 0===Ve?void 0:Ve.department),disabled:!Xe||tn,label:"OR No.",name:"ORNo",value:Ae.ORNo,onChange:gt,onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=wn.current)||void 0===n||n.focus())},id:"collection-id-field",endAdornment:(0,K.jsx)(v.Z,{position:"end",children:(0,K.jsx)(C.Z,{disabled:!Xe||tn,"aria-label":"search-client",color:"secondary",edge:"end",onClick:function(){dt()},children:(0,K.jsx)(V.Z,{})})})})]}),(0,K.jsx)(Z.Z,{textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}},inputRef:wn,fullWidth:!1,disabled:!Xe,label:"OR Date",onChange:function(e){Ee({type:"UPDATE_FIELD",field:"Date",value:e})},value:new Date(Ae.Date),onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=Tn.current)||void 0===n||n.focus())}}),ct||jn?(0,K.jsx)(j.Z,{loading:ct||jn}):(0,K.jsxs)(p.Z,{sx:{width:"170px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!Xe,children:[(0,K.jsx)(m.Z,{htmlFor:"client-id",children:"PN/Client ID"}),(0,K.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:Tn,name:"PNo",value:Ae.PNo,onChange:gt,id:"client-id",onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Ee({type:"UPDATE_FIELD",field:"isFao",value:!1}),Pn(Ae.PNo)},endAdornment:(0,K.jsx)(v.Z,{position:"end",children:(0,K.jsx)(C.Z,{disabled:!Xe,onClick:function(){Pn(Ae.PNo),Ee({type:"UPDATE_FIELD",field:"isFao",value:!1})},edge:"end",color:"secondary",children:(0,K.jsx)(S.Z,{})})}),label:"PN/Client ID"})]}),(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Clients Name",name:"Name",value:Ae.Name,onChange:gt,disabled:!Xe,InputProps:{readOnly:!0,style:{height:"27px",fontSize:"14px"}},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Pn(Ae.PNo)},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]})})})]}),(0,K.jsx)("div",{style:{position:"relative",width:"100%",overflow:"auto",flex:1},children:(0,K.jsxs)("div",{style:{position:"absolute",width:"100%",height:"auto"},children:[(0,K.jsxs)("fieldset",{style:{boxSizing:"border-box",border:"1px solid #cbd5e1",borderRadius:"5px",position:"relative",height:"420px",display:"flex",flexDirection:"column"},children:[(0,K.jsx)("legend",{children:"Particulars (Debit)"}),(0,K.jsxs)("div",{style:{display:"flex",marginBottom:"10px"},children:[(0,K.jsxs)(p.Z,{sx:{width:"150px",marginRight:"10px",minWidth:150,".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}},children:[(0,K.jsx)(m.Z,{id:"payment-check",children:"Payment Type"}),(0,K.jsxs)(k.Z,{inputRef:yn,disabled:!Xe,labelId:"payment-check",value:Re.payamentType,onChange:Dt,autoWidth:!0,label:"Payment Type",size:"small",name:"payamentType",sx:{height:"27px",fontSize:"14px"},children:[(0,K.jsx)(y.Z,{value:"CHK",onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||("CHK"===Re.payamentType?(0,B.D)(150).then((function(){var e;null===(e=An.current)||void 0===e||e.focus()})):(0,B.D)(150).then((function(){var e;null===(e=gn.current)||void 0===e||e.focus()})))},children:"Check"}),(0,K.jsx)(y.Z,{value:"CSH",onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||("CHK"===Re.payamentType?(0,B.D)(150).then((function(){var e;null===(e=An.current)||void 0===e||e.focus()})):(0,B.D)(150).then((function(){var e;null===(e=gn.current)||void 0===e||e.focus()})))},children:"Cash"})]})]}),"CHK"===Re.payamentType?(0,K.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,K.jsx)(h.Z,{disabled:!Xe,startIcon:(0,K.jsx)(_.Z,{sx:{width:15,height:15}}),variant:"outlined",sx:{height:"30px",fontSize:"11px"},onClick:function(){var e,n=Ce[Ce.length-1],t={CheckIdx:"",BankName:"",BankCode:"",Branch:"",Check_Date:new Date,Check_No:(0,M.incrementCheckNo)(null===n||void 0===n?void 0:n.Check_No),Check_Amnt:"",Check_Remarks:"",CheckMode:"add"};le(Oe,t),(0,O.flushSync)((function(){Ne(!0)})),null===(e=pn.current)||void 0===e||e.focus()},ref:An,children:"Add PDC Check"}),(0,K.jsx)(j.Z,{sx:{height:"30px",fontSize:"11px"},loading:ct||it,disabled:!Xe,onClick:function(){at({PNo:Ae.PNo,searchCheckedList:Ae.searchCheckedList})},startIcon:(0,K.jsx)(_.Z,{sx:{width:15,height:15}}),variant:"outlined",color:"success",children:"Add Check From PDC Entry"})]}):(0,K.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,K.jsx)(s.Z,{inputRef:gn,disabled:!Xe||""===Re.cashMode,name:"amount",label:"Amount",size:"small",value:Re.amount,onChange:Dt,placeholder:"0.00",InputProps:{inputComponent:L.a,style:{height:"27px",fontSize:"14px"}},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onBlur:function(){Be({type:"UPDATE_FIELD",field:"amount",value:parseFloat(Re.amount.replace(/,/g,"")).toFixed(2)})},onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=an.current)||void 0===n||n.click())}}),""===Re.cashMode?(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},variant:"outlined",onClick:function(){Be({type:"UPDATE_FIELD",field:"cashID",value:""}),Be({type:"UPDATE_FIELD",field:"cashMode",value:"add"})},children:"Add Cash"}):(0,K.jsx)(j.Z,{sx:{height:"30px",fontSize:"11px"},ref:an,loading:ct,variant:"outlined",color:"success",disabled:!Xe,onClick:function(){var e;if(parseFloat(Re.amount.replace(/,/g,""))<=0||isNaN(parseFloat(Re.amount.replace(/,/g,""))))return null===(e=gn.current)||void 0===e||e.focus(),b().fire({position:"center",icon:"warning",title:"Please provide amount!",showConfirmButton:!1,timer:1500});var n="";Re.amount=parseFloat(Re.amount.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),qe.post("/task/accounting/get-drcode-drtitle-from-collection",{code:Re.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}}).then((function(e){var t,o=null===e||void 0===e?void 0:e.data.data[0],i=o.Acct_Code,r=o.Acct_Title;ke((function(e){n=se(e.length>0?e[e.length-1].temp_id:"0"),"edit"===Re.cashMode&&(e=e.filter((function(e){return e.temp_id!==Re.cashID})),n=Re.cashID);var t={Payment:"Cash",Amount:Re.amount,Check_No:"",Check_Date:"",Bank_Branch:"",Acct_Code:i,Acct_Title:r,Deposit_Slip:"",Cntr:"",Remarks:"",TC:Re.payamentType,Bank:"",BankName:"",Check_Remarks:"",Branch:"",temp_id:n};return(e=[].concat((0,a.Z)(e),[t])).sort((function(e,n){var t=parseInt(e.temp_id,10),o=parseInt(n.temp_id,10);return t<o?-1:t>o?1:0})),e})),Be({type:"UPDATE_FIELD",field:"amount",value:parseFloat("0".replace(/,/g,"")).toFixed(2)}),Be({type:"UPDATE_FIELD",field:"cashID",value:""}),Be({type:"UPDATE_FIELD",field:"cashMode",value:"add"}),null===(t=En.current)||void 0===t||t.resetTableSelected()}))},children:"Save Debit"})]})]}),(0,K.jsx)(Y.r,{isLoading:xt||ht,ref:En,rows:Ce,column:oe,width:Tt,height:bt,dataReadOnly:!0,onSelectionChange:function(e){var n=e[0];e.length>0?function(e){var n;if("Cash"===e.Payment)return Oe({type:"UPDATE_FIELD",field:"CheckMode",value:""}),Oe({type:"UPDATE_FIELD",field:"CheckIdx",value:""}),Be({type:"UPDATE_FIELD",field:"amount",value:e.Amount}),Be({type:"UPDATE_FIELD",field:"cashID",value:e.temp_id}),void Be({type:"UPDATE_FIELD",field:"cashMode",value:"edit"});if($e(!0),Ge(!0),Oe({type:"UPDATE_FIELD",field:"CheckMode",value:"edit"}),Oe({type:"UPDATE_FIELD",field:"CheckIdx",value:e.temp_id}),""!==e.Deposit_Slip)return b().fire({position:"center",icon:"warning",title:"Unable to edit. Check No ".concat(e.Check_No," is a PDC deposited!"),showConfirmButton:!1,timer:1500});if(""!==e.Cntr)return b().fire({position:"center",icon:"warning",title:"Unable to edit. Check No ".concat(e.Check_No," is a PDC reference!"),showConfirmButton:!1,timer:1500});var t={CheckIdx:e.temp_id,BankName:e.BankName,BankCode:e.Bank,Branch:e.Branch,Check_Date:new Date(e.Check_Date),Check_No:e.Check_No,Check_Amnt:e.Amount,Check_Remarks:e.Remarks,CheckMode:"edit"};le(Oe,t),(0,O.flushSync)((function(){Ne(!0)})),null===(n=cn.current)||void 0===n||n.focusVisible()}(n):(Oe({type:"UPDATE_FIELD",field:"CheckIdx",value:""}),Oe({type:"UPDATE_FIELD",field:"CheckMode",value:""}),Be({type:"UPDATE_FIELD",field:"cashID",value:""}),Be({type:"UPDATE_FIELD",field:"cashMode",value:""}),Be({type:"UPDATE_FIELD",field:"amount",value:"0.00"}))},onKeyDown:function(e,n){if("Delete"===n||"Backspace"===n){var t=e[0];b().fire({title:"Are you sure?",text:"You won't to delete this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){if(e.isConfirmed)return ke((function(e){return e=e.filter((function(e){return e.temp_id!==t.temp_id}))}))}))}},inputsearchselector:".manok"}),(0,K.jsx)("div",{style:{width:"100%",marginTop:"20px"},children:(0,K.jsx)(ue,{})})]}),(0,K.jsx)("br",{}),(0,K.jsxs)("fieldset",{style:{boxSizing:"border-box",border:"1px solid #cbd5e1",borderRadius:"5px",position:"relative",height:"460px",display:"flex",flexDirection:"column"},children:[(0,K.jsx)("legend",{children:"Payment Breakdown (Credit)"}),(0,K.jsxs)("div",{style:{display:"flex",gap:"10px",flexDirection:"column",marginBottom:"10px"},children:[(0,K.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[ct?(0,K.jsx)(j.Z,{loading:ct}):(0,K.jsx)(g.Z,{freeSolo:!0,options:Re.transaction_desc,value:je.transaction,onChange:function(e,n){n?(Le({type:"UPDATE_FIELD",field:"Code",value:n.Acct_Code}),Le({type:"UPDATE_FIELD",field:"Title",value:n.Acct_Title}),Le({type:"UPDATE_FIELD",field:"TC",value:n.Code}),Le({type:"UPDATE_FIELD",field:"transaction",value:n.label})):(Le({type:"UPDATE_FIELD",field:"Code",value:""}),Le({type:"UPDATE_FIELD",field:"Title",value:""}),Le({type:"UPDATE_FIELD",field:"TC",value:""}),Le({type:"UPDATE_FIELD",field:"transaction",value:""}))},onInput:function(e){Le({type:"UPDATE_FIELD",field:"transaction",value:e.target.value})},renderInput:function(e){return(0,K.jsx)(s.Z,(0,l.Z)((0,l.Z)({},e),{},{InputProps:(0,l.Z)((0,l.Z)({},e.InputProps),{},{inputRef:Dn,style:{height:"27px",fontSize:"14px"}}),label:"Transaction"}))},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiInputBase-input":{width:"100% !important"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"},".MuiAutocomplete-input ":{position:"absolute"}},onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(0,B.D)(150).then((function(){var e;null===(e=Nn.current)||void 0===e||e.focus()}))},size:"small",disabled:!Xe}),(0,K.jsx)(s.Z,{disabled:!Xe,name:"amount",label:"Amount",size:"small",value:je.amount,onChange:Nt,placeholder:"0.00",InputProps:{inputComponent:L.a,inputRef:Nn,style:{height:"27px",fontSize:"14px"}},onBlur:function(){Le({type:"UPDATE_FIELD",field:"amount",value:parseFloat(je.amount.replace(/,/g,"")).toFixed(2)})},onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=_n.current)||void 0===n||n.focus())},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),On?(0,K.jsx)(j.Z,{loading:On}):(0,K.jsxs)(p.Z,{sx:{width:"150px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!Xe,children:[(0,K.jsx)(m.Z,{htmlFor:"fao",children:"FAO"}),(0,K.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:_n,name:"FAO_Name",value:je.FAO_Name,onChange:Nt,id:"fao",onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Ee({type:"UPDATE_FIELD",field:"isFao",value:!0}),Un(je.FAO_Name)},endAdornment:(0,K.jsx)(v.Z,{position:"end",children:(0,K.jsx)(C.Z,{disabled:!Xe,onClick:function(){Ee({type:"UPDATE_FIELD",field:"isFao",value:!0}),Un(je.FAO_Name)},edge:"end",color:"secondary",children:(0,K.jsx)(S.Z,{})})}),label:"FAO"})]}),(0,K.jsx)(s.Z,{disabled:!Xe,name:"remarks",label:"Remarks",size:"small",value:null!==(ce=je.remarks)&&void 0!==ce?ce:"",onChange:Nt,onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||Rn.current.focus()},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:Fn},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]}),(0,K.jsx)("div",{style:{display:"flex",gap:"10px",justifyContent:"space-between"},children:(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"10px"},children:[(0,K.jsxs)(p.Z,{sx:{width:"150px",marginRight:"10px",minWidth:150,".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}},children:[(0,K.jsx)(m.Z,{id:"payment-check",children:"VAT Type"}),(0,K.jsxs)(k.Z,{inputRef:Rn,disabled:!Xe,labelId:"payment-check",value:je.option,onChange:Nt,autoWidth:!0,label:"VAT Type",size:"small",name:"option",sx:{height:"27px",fontSize:"14px"},children:[(0,K.jsx)(y.Z,{value:"Vat",onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(0,B.D)(150).then((function(){var e;null===(e=In.current)||void 0===e||e.focus()}))},children:"VAT"}),(0,K.jsx)(y.Z,{value:"Non-Vat",onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(0,B.D)(150).then((function(){var e;null===(e=In.current)||void 0===e||e.focus()}))},children:"Non-VAT"})]})]}),(0,K.jsx)(s.Z,{disabled:!Xe||""===je.creditMode,name:"invoice",label:"Invoice",size:"small",value:je.invoice,onChange:Nt,InputProps:{inputRef:In,style:{height:"27px",fontSize:"14px"}},sx:{width:"300px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=ln.current)||void 0===e||e.click(),clearTimeout(n)}),100)}}),""===je.creditMode?(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},variant:"outlined",onClick:function(){Object.entries(X).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];Le({type:"UPDATE_FIELD",field:t,value:o})}))},children:"NEW"}):(0,K.jsx)(h.Z,{disabled:!Xe||""===je.creditMode,ref:ln,sx:{height:"30px",fontSize:"11px"},color:"success",variant:"outlined",onClick:function(){if(""===je.transaction||null===je.transaction||void 0===je.transaction)return It("Please select a transaction!",(function(){(0,B.D)(300).then((function(){var e;null===(e=Dn.current)||void 0===e||e.focus()}))}));if(Re.transaction_desc.filter((function(e){return e.label===je.transaction})).length<=0)return It("Transaction not yet defined!",(function(){(0,B.D)(300).then((function(){var e;null===(e=Dn.current)||void 0===e||e.focus()}))}));if(parseFloat(je.amount.replace(/,/g,""))<=0||isNaN(parseFloat(je.amount.replace(/,/g,""))))return It("Please provide amount!",(function(){(0,B.D)(300).then((function(){var e;null===(e=Nn.current)||void 0===e||e.focus()}))}));if(""===je.FAO_ID)return It("Please provide FAO!",(function(){(0,B.D)(300).then((function(){var e;null===(e=_n.current)||void 0===e||e.focus()}))}));if(""===je.invoice)return It("Please provide invoice!",(function(){(0,B.D)(300).then((function(){var e;null===(e=In.current)||void 0===e||e.focus()}))}));if(je.invoice.length>=200)return It("Invoice is too long!",(function(){}));if(je.FAO_ID.length>=200)return It("ID is too long!",(function(){}));if(je.remarks.length>=200)return It("Remarks is too long!",(function(){}));if(je.amount.length>=200)return It("Amount is too long!",(function(){}));function e(){je.amount=parseFloat(je.amount).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});var e=parseInt(pe.length<=0?"0":pe[pe.length-1].temp_id)+1,n={transaction:je.transaction,amount:je.amount,Remarks:je.remarks,Code:je.Code,Title:je.Title,TC:je.TC,Account_No:je.FAO_ID,Name:je.FAO_Name,VATType:je.option,invoiceNo:je.invoice};if(me((function(t){return"add"===je.creditMode?t=[].concat((0,a.Z)(t),[(0,l.Z)({temp_id:e},n)]):t.map((function(e){return e.temp_id===je.creditId&&(e=(0,l.Z)((0,l.Z)({},e),n)),e}))})),"Vat"===je.option){var t=.12*(parseFloat(je.amount.replace(/,/g,""))/1.12),o=Re.transaction_desc.filter((function(e){return"Output Tax"===e.label}))[0],i={temp_id:e+1,transaction:"Output Tax",amount:t.toFixed(2),Remarks:je.remarks,Code:o.Acct_Code,Title:o.Acct_Title,TC:o.Code,Account_No:je.FAO_ID,Name:je.FAO_Name,VATType:je.option,invoiceNo:je.invoice};me((function(e){return e=[].concat((0,a.Z)(e),[i])}))}b().fire({text:"edit"===je.creditMode?"Update Successfully":"Create Successfully",icon:"success",showCancelButton:!1,timer:1500}).then((function(){le(Le,X),Sn.current.resetTableSelected()}))}if("edit"===je.creditMode)return b().fire({title:"Are you sure?",text:"You won't to update this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update it!"}).then((function(n){if(n.isConfirmed)return e()}));e()},children:"Save Credit"})]})})]}),(0,K.jsx)(Y.r,{isLoading:xt||ht,ref:Sn,rows:pe,column:ie,width:Tt,height:bt,dataReadOnly:!0,onSelectionChange:function(e){var n=e[0];if(e.length>0){var t={creditMode:"edit",creditId:n.temp_id,transaction:n.transaction,amount:n.amount,remarks:n.Remarks,Code:n.Code,Title:n.Title,TC:n.TC,FAO_ID:n.Account_No,FAO_Name:n.Name,option:n.VATType,invoice:n.invoiceNo};le(Le,t)}else Object.entries(X).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];Le({type:"UPDATE_FIELD",field:t,value:o})}))},onKeyDown:function(e,n){if("Delete"===n||"Backspace"===n){var t=e[0];b().fire({title:"Are you sure?",text:"You won't to delete this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){if(e.isConfirmed)return me((function(e){return e=e.filter((function(e){return e.temp_id!==t.temp_id}))}))}))}},inputsearchselector:".manok"}),(0,K.jsx)("div",{style:{width:"100%",marginTop:"10px"},children:(0,K.jsx)(de,{})})]})]})}),Zn,Vn,Qn,nt,zn,(0,K.jsx)(D.Z,{open:De,onClose:function(){var e;Ne(!1),null===(e=En.current)||void 0===e||e.resetTableSelected()},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,K.jsxs)(d.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:700,bgcolor:"background.paper",p:4},children:[(0,K.jsx)(N.Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Check Detail"}),(0,K.jsxs)("div",{style:{display:"flex",columnGap:"10px"},children:[(0,K.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Check No.",name:"Check_No",value:Ue.Check_No,onChange:_t,disabled:!Xe||""!==Ue.CheckIdx,onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||mn.current&&mn.current.focus()},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:pn},sx:{height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),$n?(0,K.jsx)(j.Z,{loading:$n}):(0,K.jsxs)(p.Z,{sx:{width:"100%",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},fullWidth:!0,variant:"outlined",size:"small",disabled:!Xe,children:[(0,K.jsx)(m.Z,{htmlFor:"label-input-id",children:"Bank"}),(0,K.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:mn,disabled:!Xe,fullWidth:!0,label:"Bank",name:"BankName",value:Ue.BankName,onChange:_t,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Jn(Ue.BankName)},id:"label-input-id",endAdornment:(0,K.jsx)(v.Z,{position:"end",children:(0,K.jsx)(C.Z,{disabled:!Xe,"aria-label":"search-client",color:"secondary",edge:"end",onClick:function(){return Jn(Ue.BankName)},children:(0,K.jsx)(P.Z,{})})})})]}),(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Branch",name:"Branch",value:Ue.Branch,onChange:_t,disabled:!Xe,onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||vn.current&&vn.current.focus()},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:xn},sx:{height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Remarks",name:"Check_Remarks",value:Ue.Check_Remarks,onChange:_t,disabled:!Xe,rows:4,multiline:!0,onKeyDown:function(e){"Enter"===e.key&&e.shiftKey||"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),kn.current&&kn.current.focus())},InputProps:{style:{height:"auto",fontSize:"14px"},inputRef:vn},sx:{flex:1,height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]}),(0,K.jsxs)("div",{style:{display:"flex",gap:"10px",flexDirection:"column"},children:[(0,K.jsx)(Z.Z,{disabled:!Xe,label:"Check Dated",onChange:function(e){Oe({type:"UPDATE_FIELD",field:"Check_Date",value:e})},onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),Cn.current&&Cn.current.focus())},value:new Date(Ue.Check_Date),inputRef:kn,textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}}}),(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Amount",name:"Check_Amnt",value:Ue.Check_Amnt,onChange:_t,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=rn.current)||void 0===e||e.click(),clearTimeout(n)}),100)},disabled:!Xe,placeholder:"0.00",InputProps:{style:{height:"27px",fontSize:"14px"},inputComponent:L.a,inputRef:Cn},sx:{flex:1,height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onBlur:function(){Oe({type:"UPDATE_FIELD",field:"Check_Amnt",value:parseFloat(Ue.Check_Amnt.replace(/,/g,"")).toFixed(2)})}})]})]}),(0,K.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",gap:"20px"},children:[(0,K.jsx)(h.Z,{ref:rn,action:cn,color:"success",variant:"contained",autoFocus:""!==Ue.CheckIdx,onClick:function(){if(""===Ue.Check_No)return Ne(!1),It("Please provide check!",(function(e){var n;(0,O.flushSync)((function(){Ne(!0)})),null===(n=pn.current)||void 0===n||n.focus()}));if(parseFloat(Ue.Check_Amnt.replace(/,/g,""))<=0||isNaN(parseFloat(Ue.Check_Amnt.replace(/,/g,""))))return Ne(!1),It("Please provide check amount!",(function(e){var n;(0,O.flushSync)((function(){Ne(!0)})),null===(n=Cn.current)||void 0===n||n.focus()}));if(""===Ue.BankName)return Ne(!1),It("Please provide bank!",(function(e){var n;(0,O.flushSync)((function(){Ne(!0)})),null===(n=mn.current)||void 0===n||n.focus()}));if(""===Ue.Branch)return Ne(!1),It("Please provide branch!",(function(e){var n;(0,O.flushSync)((function(){Ne(!0)})),null===(n=xn.current)||void 0===n||n.focus()}));if(Ue.BankName.length>=200)return Ne(!1),It("Bank Name is too long!",(function(e){var n;(0,O.flushSync)((function(){Ne(!0)})),null===(n=mn.current)||void 0===n||n.focus()}));if(Ue.Branch.length>=200)return Ne(!1),It("Branch is too long!",(function(e){var n;(0,O.flushSync)((function(){Ne(!0)})),null===(n=xn.current)||void 0===n||n.focus()}));if(Ue.Check_No.length>=200)return Ne(!1),It("Check No is too long!",(function(e){var n;(0,O.flushSync)((function(){Ne(!0)})),null===(n=xn.current)||void 0===n||n.focus()}));if(Ue.Check_Amnt.length>=200)return Ne(!1),It("Check Ammount is too long!",(function(e){var n;(0,O.flushSync)((function(){Ne(!0)})),null===(n=xn.current)||void 0===n||n.focus()}));function e(){var e="";qe.post("/task/accounting/get-drcode-drtitle-from-collection",{code:Re.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===Ve||void 0===Ve?void 0:Ve.accessToken)}}).then((function(n){var t=null===n||void 0===n?void 0:n.data.data[0],o=t.Acct_Code,i=t.Acct_Title;ke((function(n){e=se(n.length>0?n[n.length-1].temp_id:"0"),"edit"===Ue.CheckMode&&(n=n.filter((function(e){return e.temp_id!==Ue.CheckIdx.toString()})),e=Ue.CheckIdx.toString());var t={Payment:"Check",Amount:Ue.Check_Amnt,Check_No:Ue.Check_No,Check_Date:new Date(Ue.Check_Date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),Bank_Branch:"".concat(Ue.BankName," / ").concat(Ue.Branch),Acct_Code:o,Acct_Title:i,Deposit_Slip:"",Cntr:"",Remarks:Ue.Check_Remarks,TC:Re.payamentType,temp_id:e,Bank:Ue.BankCode,BankName:Ue.BankName,Check_Remarks:Ue.Check_Remarks,Branch:Ue.Branch};return(n=[].concat((0,a.Z)(n),[t])).sort((function(e,n){var t=parseInt(e.temp_id,10),o=parseInt(n.temp_id,10);return t<o?-1:t>o?1:0})),n}))}))}return Ue.Check_Amnt=parseFloat(Ue.Check_Amnt.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),"edit"===Ue.CheckMode?((0,O.flushSync)((function(){Ne(!1)})),b().fire({title:"Are you sure? You want to Update this "+Ue.Check_No+" Check No.",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update it!",focusConfirm:!0}).then((function(n){n.isConfirmed&&(e(),b().fire({text:"Update Successfully",icon:"success",showCancelButton:!1,timer:1500,didClose:function(){var e,n;(0,O.flushSync)((function(){Ne(!0)})),null===(e=cn.current)||void 0===e||e.focusVisible(),null===(n=En.current)||void 0===n||n.resetTableSelected()}}))}))):Ce.filter((function(e){return e.Check_No===Ue.Check_No})).length>0?((0,O.flushSync)((function(){Ne(!1)})),b().fire({text:"".concat(Ue.Check_No," is already Exist!"),icon:"warning",showCancelButton:!1,timer:1500}).then((function(){Ne(!1)}))):(e(),Oe({type:"UPDATE_FIELD",field:"Check_No",value:(0,M.incrementCheckNo)(Ue.Check_No)}),(0,O.flushSync)((function(){Ne(!1)})),void b().fire({text:"Create New Check Successfully",icon:"success",showCancelButton:!1,timer:1500,didClose:function(){var e,n;(0,O.flushSync)((function(){Ne(!1)})),null===(e=cn.current)||void 0===e||e.focusVisible(),null===(n=En.current)||void 0===n||n.resetTableSelected()}}))},children:"Save"}),(0,K.jsx)(h.Z,{color:"warning",variant:"contained",onClick:function(){var e;Ne(!1),null===(e=En.current)||void 0===e||e.resetTableSelected()},children:"Cancel"}),""!==Ue.CheckIdx&&(0,K.jsx)(h.Z,{color:"error",variant:"contained",onClick:function(){var e;(0,O.flushSync)((function(){Ne(!1)})),e={Check_No:Ue.Check_No,temp_id:Ue.CheckIdx},b().fire({title:"Are you sure?",text:"You won't to delete this Check No. ".concat(e.Check_No),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(n){var t;if(n.isConfirmed)return b().fire({text:"Check No. ".concat(e.Check_No," has delete successfully."),icon:"success",showCancelButton:!0,timer:1500}).then((function(){ke((function(n){return n.filter((function(n){return n.temp_id!==e.temp_id}))}))}));Be({type:"UPDATE_FIELD",field:"amount",value:"0.00"}),null===(t=En.current)||void 0===t||t.resetTableSelected()}))},children:"Delete"})]})]})})]}),(xt||Hn)&&(0,K.jsx)("div",{className:"loading-component",children:(0,K.jsx)("div",{className:"loader"})})]})]})}function le(e,n){Object.entries(n).forEach((function(n){var t=(0,r.Z)(n,2),o=t[0],i=t[1];e({type:"UPDATE_FIELD",field:o,value:i})}))}function ue(){var e=(0,u.useContext)(G).debit;return(0,K.jsx)(d.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,K.jsxs)("strong",{style:{fontSize:"14px"},children:["Total:"," ",e.reduce((function(e,n){return e+parseFloat(n.Amount.replace(/,/g,""))}),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})}function de(){var e=(0,u.useContext)(G).credit;return(0,K.jsx)(d.Z,{sx:{px:2,py:1,display:"flex",justifyContent:"flex-end"},children:(0,K.jsxs)("strong",{style:{fontSize:"14px"},children:["Total:"," ",e.reduce((function(e,n){return e+parseFloat(n.amount.replace(/,/g,""))}),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})}function se(e){var n=parseInt(e,10)+1;return String(n).padStart(3,"0")}}}]);
//# sourceMappingURL=4701.93c56ec3.chunk.js.map