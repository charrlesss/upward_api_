"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[899,2074],{49923:function(e,n,t){t.r(n),t.d(n,{creditColumn:function(){return je},debitColumn:function(){return Be},default:function(){return ze},reducer:function(){return Ee},setNewStateValue:function(){return Ue}});var o=t(74165),i=t(15861),a=t(93433),r=t(29439),c=t(4942),l=t(1413),u=t(72791),s=t(64554),d=t(27391),f=t(36151),h=t(13239),p=t(68096),m=t(94925),x=t(77196),v=t(63466),C=t(13400),k=t(58406),y=t(23786),g=t(73766),D=t(87462),N=t(63366),_=t(79012),S=t(42071),b=t(98278);var T=u.createContext(void 0),I=t(67384),A=t(80184),Z=["actions","children","defaultValue","name","onChange","value"],w=u.forwardRef((function(e,n){var t=e.actions,o=e.children,i=e.defaultValue,a=e.name,c=e.onChange,l=e.value,s=(0,N.Z)(e,Z),d=u.useRef(null),f=(0,b.Z)({controlled:l,default:i,name:"RadioGroup"}),h=(0,r.Z)(f,2),p=h[0],m=h[1];u.useImperativeHandle(t,(function(){return{focus:function(){var e=d.current.querySelector("input:not(:disabled):checked");e||(e=d.current.querySelector("input:not(:disabled)")),e&&e.focus()}}}),[]);var x=(0,S.Z)(n,d),v=(0,I.Z)(a),C=u.useMemo((function(){return{name:v,onChange:function(e){m(e.target.value),c&&c(e,e.target.value)},value:p}}),[v,c,m,p]);return(0,A.jsx)(T.Provider,{value:C,children:(0,A.jsx)(_.Z,(0,D.Z)({role:"radiogroup",ref:x},s,{children:o}))})})),F=t(85523),E=t(63733),R=t(94419),P=t(12065),B=t(97278),j=t(31402),L=t(76189),M=(0,L.Z)((0,A.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),z=(0,L.Z)((0,A.jsx)("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),U=t(66934),O=(0,U.ZP)("span")({position:"relative",display:"flex"}),K=(0,U.ZP)(M)({transform:"scale(1)"}),W=(0,U.ZP)(z)((function(e){var n=e.theme,t=e.ownerState;return(0,D.Z)({left:0,position:"absolute",transform:"scale(0)",transition:n.transitions.create("transform",{easing:n.transitions.easing.easeIn,duration:n.transitions.duration.shortest})},t.checked&&{transform:"scale(1)",transition:n.transitions.create("transform",{easing:n.transitions.easing.easeOut,duration:n.transitions.duration.shortest})})}));var q=function(e){var n=e.checked,t=void 0!==n&&n,o=e.classes,i=void 0===o?{}:o,a=e.fontSize,r=(0,D.Z)({},e,{checked:t});return(0,A.jsxs)(O,{className:i.root,ownerState:r,children:[(0,A.jsx)(K,{fontSize:a,className:i.background,ownerState:r}),(0,A.jsx)(W,{fontSize:a,className:i.dot,ownerState:r})]})},V=t(14036),Y=t(31260);var G=t(75878),H=t(21217);function Q(e){return(0,H.Z)("MuiRadio",e)}var J=(0,G.Z)("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),X=["checked","checkedIcon","color","icon","name","onChange","size","className"],$=(0,U.ZP)(B.Z,{shouldForwardProp:function(e){return(0,U.FO)(e)||"classes"===e},name:"MuiRadio",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,n["color".concat((0,V.Z)(t.color))]]}})((function(e){var n=e.theme,t=e.ownerState;return(0,D.Z)({color:(n.vars||n).palette.text.secondary},!t.disableRipple&&{"&:hover":{backgroundColor:n.vars?"rgba(".concat("default"===t.color?n.vars.palette.action.activeChannel:n.vars.palette[t.color].mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,P.Fq)("default"===t.color?n.palette.action.active:n.palette[t.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==t.color&&(0,c.Z)({},"&.".concat(J.checked),{color:(n.vars||n).palette[t.color].main}),(0,c.Z)({},"&.".concat(J.disabled),{color:(n.vars||n).palette.action.disabled}))}));var ee=(0,A.jsx)(q,{checked:!0}),ne=(0,A.jsx)(q,{}),te=u.forwardRef((function(e,n){var t,o,i,a,r=(0,j.Z)({props:e,name:"MuiRadio"}),c=r.checked,l=r.checkedIcon,s=void 0===l?ee:l,d=r.color,f=void 0===d?"primary":d,h=r.icon,p=void 0===h?ne:h,m=r.name,x=r.onChange,v=r.size,C=void 0===v?"medium":v,k=r.className,y=(0,N.Z)(r,X),g=(0,D.Z)({},r,{color:f,size:C}),_=function(e){var n=e.classes,t=e.color,o=e.size,i={root:["root","color".concat((0,V.Z)(t)),"medium"!==o&&"size".concat((0,V.Z)(o))]};return(0,D.Z)({},n,(0,R.Z)(i,Q,n))}(g),S=u.useContext(T),b=c,I=(0,Y.Z)(x,S&&S.onChange),Z=m;return S&&("undefined"===typeof b&&(i=S.value,b="object"===typeof(a=r.value)&&null!==a?i===a:String(i)===String(a)),"undefined"===typeof Z&&(Z=S.name)),(0,A.jsx)($,(0,D.Z)({type:"radio",icon:u.cloneElement(p,{fontSize:null!=(t=ne.props.fontSize)?t:C}),checkedIcon:u.cloneElement(s,{fontSize:null!=(o=ee.props.fontSize)?o:C}),ownerState:g,classes:_,name:Z,checked:b,onChange:I,ref:n,className:(0,E.Z)(_.root,k)},y))})),oe=t(88447),ie=t(20890),ae=t(42419),re=t(91933),ce=t(21830),le=t.n(ce),ue=t(80007),se=t(29823),de=t(53329),fe=t(91421),he=t(41128),pe=t(3380),me=t(79018),xe=t(13784),ve=t(99422),Ce=t(39709),ke=t(56580),ye=t(8185),ge=t(93263),De=t(81582),Ne=t(54164),_e=function(e){var n,t=e.link,a=e.uniqueId,c=e.queryKey,l=e.responseDataKey,s=e.columns,d=e.onSelected,f=void 0===d?function(){}:d,h=e.onRemoveSelected,p=void 0===h?function(){}:h,m=e.onSuccess,x=void 0===m?function(){}:m,v=e.searchRef,C=e.onCellKeyDown,k=e.onCloseFunction,y=e.isRowSelectable,g=(0,u.useContext)(pe.V),D=g.myAxios,N=g.user,_=(0,u.useState)(!1),S=(0,r.Z)(_,2),b=S[0],T=S[1],I=(0,u.useState)([]),Z=(0,r.Z)(I,2),w=Z[0],F=Z[1],E=(0,re.useMutation)({mutationKey:c,mutationFn:function(e){return(n=n||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.get("".concat(t.queryWithVariable(n)),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var n=e;F(n.data[l]),x(n)}}),R=E.isLoading,P=E.mutate;return{openSearchCollection:b,rows:w,isLoading:R,openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,Ne.flushSync)((function(){T(!0)})),null!==v&&void 0!==v&&v.current&&(v.current.value=e,D.get("".concat(t.queryExtraBySearch,"=").concat(e),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l]),null!==v&&void 0!==v&&v.current&&v.current.focus()})))},closeModal:function(){var e;(T(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},ModalComponent:(0,A.jsx)(De.ZP,{searchRef:v,showModal:b,onCloseModal:function(){var e;(T(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},onClickCloseIcon:function(){var e;(T(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},searchOnChange:function(e){D.get("".concat(t.queryExtraBySearch,"=").concat(e.target.value),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l])}))},onSearchKeyEnter:function(e){D.get("".concat(t.queryExtraBySearch,"=").concat(e),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l])}))},onCellKeyDown:C,height:300,isLoading:R,queryKey:c,columns:s,onSelectionChange:function(e,n){if(e.length<=0)return p(n);var t=new Set(e),o=n.filter((function(e){return t.has(e[a].toString())}));o.length<=0||f(o,n)},isRowSelectable:y,id:a,rows:w,setRows:F}),mutate:P}},Se=t(86753),be=t(89767),Te=t(64230),Ie=(0,u.createContext)({debit:[],credit:[]}),Ae={ORNo:"",PNo:"",IDNo:"",Date:new Date,Name:"",Remarks:"",creditUpdateMode:!1,creditCheckIdx:"",creditCheckID:"",PDC_Status:"",Deposit_Slip:"",DateDeposit:"",OR_No:"",searchCheckedList:"",bank_transaction:"",isFao:!1,search:"",mode:""},Ze={cashID:"",cashMode:"add",payamentType:"CHK",amount:"",transaction_desc:[],debitHasSelected:!1},we={creditMode:"add",creditId:"",transaction:"",amount:"",FAO_Name:"",FAO_ID:"",remarks:"",option:"nonVAT",invoice:"",Code:"",Title:"",TC:""},Fe={CheckIdx:"",BankName:"",BankCode:"",Branch:"",Check_Date:new Date,Check_No:"",Check_Amnt:"",Check_Remarks:"",CheckMode:"add"},Ee=function(e,n){return"UPDATE_FIELD"===n.type?(0,l.Z)((0,l.Z)({},e),{},(0,c.Z)({},n.field,n.value)):e},Re="add-collection",Pe="collection-data-search",Be=[{field:"Payment",headerName:"Payment",flex:1,minWidth:170},{field:"Amount",headerName:"Amount",flex:1,minWidth:170,type:"number"},{field:"Check_No",headerName:"Check No",flex:1,minWidth:170},{field:"Check_Date",headerName:"Check Date",flex:1,minWidth:170},{field:"Bank_Branch",headerName:"Bank/Branch",flex:1,minWidth:300},{field:"Acct_Code",headerName:"DR Code",flex:1,minWidth:170},{field:"Acct_Title",headerName:"DR Title",flex:1,minWidth:300},{field:"Deposit_Slip",headerName:"Deposit Slip",flex:1,minWidth:170},{field:"Cntr",headerName:"Cntr",flex:1,minWidth:170},{field:"Remarks",headerName:"Remarks",flex:1,minWidth:300},{field:"TC",headerName:"TC",flex:1,minWidth:170},{field:"temp_id",headerName:"temp_id",flex:1,hide:!0},{field:"Bank",headerName:"Bank",flex:1,hide:!0},{field:"BankName",headerName:"BankName",flex:1,hide:!0}],je=[{field:"temp_id",headerName:"temp_id",flex:1,hide:!0},{field:"transaction",headerName:"Transaction",minWidth:200},{field:"amount",headerName:"Amount",minWidth:150,type:"number"},{field:"Remarks",headerName:"Remarks",minWidth:350},{field:"Code",headerName:"Code",minWidth:150},{field:"Title",headerName:"Title",minWidth:350},{field:"TC",headerName:"TC",minWidth:200},{field:"Account_No",headerName:"Accoount No.",minWidth:180},{field:"Name",headerName:"Name",minWidth:350},{field:"VATType",headerName:"VAT Type",minWidth:150},{field:"invoiceNo",headerName:"Invoice No",minWidth:250}],Le="payment-type-code",Me="new-or-number";function ze(){var e,n,t,D,N,_,S=(0,u.useState)([]),b=(0,r.Z)(S,2),T=b[0],I=b[1],Z=(0,u.useState)([]),E=(0,r.Z)(Z,2),R=E[0],P=E[1],B=(0,u.useState)(!1),j=(0,r.Z)(B,2),L=j[0],M=j[1],z=(0,he.Z)(),U=z.searchParams,O=z.setSearchParams,K=(0,u.useReducer)(Ee,Ae),W=(0,r.Z)(K,2),q=W[0],V=W[1],Y=(0,u.useReducer)(Ee,Ze),G=(0,r.Z)(Y,2),H=G[0],Q=G[1],J=(0,u.useReducer)(Ee,we),X=(0,r.Z)(J,2),$=X[0],ee=X[1],ne=(0,u.useReducer)(Ee,Fe),ce=(0,r.Z)(ne,2),De=ce[0],ze=ce[1],qe=(0,u.useContext)(pe.V),Ve=qe.myAxios,Ye=qe.user,Ge=(0,u.useState)(""!==U.get("selected")),He=(0,r.Z)(Ge,2),Qe=He[0],Je=He[1],Xe=(0,u.useState)(""!==U.get("selected")),$e=(0,r.Z)(Xe,2),en=$e[0],nn=$e[1],tn=(0,u.useState)(!1),on=(0,r.Z)(tn,2),an=on[0],rn=on[1],cn=(0,u.useRef)(null),ln=(0,u.useRef)(null),un=(0,u.useRef)(null),sn=(0,u.useRef)(null),dn=(0,u.useRef)(null),fn=(0,u.useRef)(null),hn=(0,u.useRef)(null),pn=(0,u.useRef)(null),mn=(0,u.useRef)(null),xn=(0,u.useRef)(null),vn=(0,u.useRef)(null),Cn=(0,u.useRef)(null),kn=(0,u.useRef)(null),yn=(0,u.useRef)(null),gn=(0,u.useRef)(null),Dn=(0,u.useRef)(null),Nn=(0,u.useRef)(null),_n=(0,u.useRef)(null),Sn=(0,u.useRef)(null),bn=(0,u.useRef)(null),Tn=(0,u.useRef)(null),In=(0,re.useQueryClient)(),An=(0,u.useRef)(null),Zn=(0,u.useRef)(null),wn=(0,ge.Z)({link:{url:"/task/accounting/search-pdc-policy-id",queryUrlName:"searchPdcPolicyIds"},columns:[{field:"Type",headerName:"Type",width:130},{field:"IDNo",headerName:"ID No.",width:200},{field:"Name",headerName:"Name",flex:1},{field:"ID",headerName:"ID",flex:1,hide:!0}],queryKey:"collection-polidy-ids",uniqueId:"IDNo",responseDataKey:"clientsId",onSelected:function(e,n){var t,o;q.isFao?(ee({type:"UPDATE_FIELD",field:"FAO_ID",value:e[0].IDNo}),ee({type:"UPDATE_FIELD",field:"FAO_Name",value:null!==(t=e[0].Name)&&void 0!==t?t:""})):(V({type:"UPDATE_FIELD",field:"PNo",value:e[0].IDNo}),V({type:"UPDATE_FIELD",field:"IDNo",value:e[0].ID}),V({type:"UPDATE_FIELD",field:"Name",value:null!==(o=e[0].Name)&&void 0!==o?o:""}));Pn()},searchRef:fn}),Fn=wn.ModalComponent,En=wn.openModal,Rn=wn.isLoading,Pn=wn.closeModal,Bn=(0,ge.Z)({link:{url:"/task/accounting/search-collection",queryUrlName:"searchCollectionInput"},columns:[{field:"Date",headerName:"OR Date",width:170},{field:"ORNo",headerName:"OR No.",width:200},{field:"Name",headerName:"Name",flex:1}],queryKey:"collection-search",uniqueId:"ORNo",responseDataKey:"collection",onSelected:function(e,n){at({ORNo:e[0].ORNo})},onCloseFunction:function(e){V({type:"UPDATE_FIELD",field:"search",value:e})},searchRef:hn}),jn=Bn.ModalComponent,Ln=Bn.openModal,Mn=Bn.closeModal,zn=Bn.isLoading,Un=(0,ge.Z)({link:{url:"/task/accounting/search-pdc-banks",queryUrlName:"searchPdcBanks"},columns:[{field:"Bank_Code",headerName:"Code",width:130},{field:"Bank",headerName:"Bank Name",flex:1}],queryKey:"collection-banks",uniqueId:"Bank_Code",responseDataKey:"pdcBanks",onSelected:function(e,n){ze({type:"UPDATE_FIELD",field:"BankName",value:e[0].Bank}),ze({type:"UPDATE_FIELD",field:"BankCode",value:e[0].Bank_Code}),Wn()},searchRef:pn}),On=Un.ModalComponent,Kn=Un.openModal,Wn=Un.closeModal,qn=Un.isLoading,Vn=_e({link:{queryWithVariable:function(e){return"/task/accounting/get-client-checked-by-id?PNo=".concat(e.PNo,"&searchCheckedList=").concat(e.searchCheckedList)},queryExtraBySearch:"/task/accounting/get-client-checked-by-id?PNo=".concat(q.PNo,"&searchCheckedList")},columns:[{field:"temp_id",headerName:"temp_id",width:0,hide:!0},{field:"Check_No",headerName:"Check No",width:130},{field:"Check_Date",headerName:"Check Date",flex:1},{field:"Amount",headerName:"Amount",width:200,type:"number"},{field:"Bank_Branch",headerName:"Bank Branch",width:200},{field:"Remarks",headerName:"Remarks",width:200,hide:!0}],queryKey:"collection-client-check",uniqueId:"temp_id",responseDataKey:"clientCheckedList",onSelected:function(e,n){R.filter((function(e){return""!==e.Check_No})).map((function(e){return e.Check_No})).includes(e[0].Check_No)||Ve.post("/task/accounting/get-drcode-drtitle-from-collection",{code:H.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}}).then((function(n){var t;console.log(n);var o=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.data[0],i=o.Acct_Code,r=o.Acct_Title;P((function(n){var t=0;return t=n.length<=0?0:parseInt(n[n.length-1].temp_id)+1,n=[].concat((0,a.Z)(n),[{Payment:"Check",Amount:e[0].Amount,Check_No:e[0].Check_No,Check_Date:e[0].Check_Date,Bank_Branch:e[0].Bank_Branch,Acct_Code:i,Acct_Title:r,Deposit_Slip:"",Cntr:"",Remarks:e[0].Remarks,TC:H.payamentType,temp_id:t.toString(),Bank:e[0].Bank,BankName:e[0].BankName,Check_Remarks:e[0].Check_Remarks,Branch:e[0].Branch}])})),Hn()}))},onSuccess:function(e){Gn()},searchRef:mn,isRowSelectable:function(e){return!R.filter((function(e){return""!==e.Check_No})).map((function(e){return e.Check_No})).includes(e.row.Check_No)}}),Yn=Vn.ModalComponent,Gn=Vn.openModal,Hn=Vn.closeModal,Qn=Vn.isLoading,Jn=Vn.mutate,Xn=(0,re.useQuery)({queryKey:Le,queryFn:function(){return(e=e||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve.get("/task/accounting/get-transaction-code-title",{headers:{Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},refetchOnWindowFocus:!1,onSuccess:function(e){Q({type:"UPDATE_FIELD",field:"transaction_desc",value:e.data.transactionDesc})}}),$n=Xn.isLoading,et=(0,re.useQuery)({queryKey:Me,queryFn:function(){return(n=n||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve.get("/task/accounting/get-new-or-number",{headers:{Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},refetchOnWindowFocus:!1,onSuccess:function(e){var n,t,o=e;V({type:"UPDATE_FIELD",field:"ORNo",value:null===(n=o.data)||void 0===n?void 0:n.ORNo[0].collectionID}),V({type:"UPDATE_FIELD",field:"OR_No",value:null===(t=o.data)||void 0===t?void 0:t.ORNo[0].collectionID})}}),nt=et.isLoading,tt=et.refetch,ot=(0,re.useMutation)({mutationKey:Pe,mutationFn:function(e){return(t=t||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve.get("/task/accounting/get-collection-data-search?ORNo=".concat(n.ORNo),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var n=e.data.collection,t=n[0].ORNo,o=n[0].Date_OR,i=n[0].ID_No,a={ORNo:t,PNo:i,IDNo:i,Date:o,Name:n[0].Short},r=[],c=[];function l(e){var n=new Date(e);return!isNaN(n)&&""!==e.trim()}for(var u=0;u<=n.length-1;u++)""!==n[u].Payment&&"0"!==n[u].Debit&&r.push({Payment:n[u].Payment,Amount:n[u].Debit,Check_No:n[u].Check_No,Check_Date:l(n[u].Check_Date)?new Date(n[u].Check_Date).toLocaleDateString():"",Bank_Branch:n[u].Bank,Acct_Code:n[u].DRCode,Acct_Title:n[u].DRTitle,Deposit_Slip:n[u].SlipCode,Cntr:"",Remarks:n[u].DRRemarks,TC:n[u].Check_No?"CHK":"CSH",temp_id:"".concat(u),Bank:n[u].Bank_Code,BankName:n[u].BankName,Branch:n[u].Branch,Check_Remarks:n[u].DRRemarks}),""!==n[u].Purpose&&"0"!==n[u].Credit&&""!==n[u].CRCode&&""!==n[u].CRTitle&&""!==n[u].CRLoanID&&""!==n[u].CRLoanName&&""!==n[u].CRVatType&&""!==n[u].CRInvoiceNo&&c.push({temp_id:"".concat(u),transaction:n[u].Purpose,amount:n[u].Credit,Remarks:n[u].CRRemarks,Code:n[u].CRCode,Title:n[u].CRTitle,TC:n[u].CRTitle,Account_No:n[u].CRLoanID,Name:n[u].CRLoanName,VATType:n[u].CRVATType,invoiceNo:n[u].CRInvoiceNo});Ue(V,a),P(r),I(c),nn(!0),Je(!0),rn(!0),Mn()}}),it=ot.isLoading,at=ot.mutate,rt=(0,re.useMutation)({mutationKey:Re,mutationFn:function(e){return(D=D||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!an){e.next=5;break}return delete n.mode,e.next=4,Ve.post("/task/accounting/update-collection",n,{headers:{Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}});case 4:case 8:return e.abrupt("return",e.sent);case 5:return delete n.mode,e.next=8,Ve.post("/task/accounting/add-collection",n,{headers:{Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){if(e.data.success)return Je(!1),nn(!1),Ue(V,Ae),In.invalidateQueries("collection-search"),rn(!1),P([]),I([]),tt(),le().fire({position:"center",icon:"success",title:e.data.message,showConfirmButton:!1,timer:1500});le().fire({position:"center",icon:"error",title:e.data.message,showConfirmButton:!1,timer:1500})}}),ct=rt.mutate,lt=rt.isLoading,ut=rt.variables,st=(0,re.useMutation)({mutationKey:"on-print",mutationFn:function(e){return(N=N||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve.post("/task/accounting/on-print",n,{headers:{Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){e.data.success&&function(e){var n=e.data.concat(e.data1);(0,Ne.flushSync)((function(){localStorage.removeItem("printString"),localStorage.setItem("dataString",JSON.stringify(n)),localStorage.setItem("paper-width","8.5in"),localStorage.setItem("paper-height","11in"),localStorage.setItem("module","collection"),"UMIS"===(null===Ye||void 0===Ye?void 0:Ye.department)?localStorage.setItem("title","UMIS"===(null===Ye||void 0===Ye?void 0:Ye.department)?"UPWARD MANAGEMENT INSURANCE SERVICES":"UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC."):localStorage.setItem("title","UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC.")})),window.open("/dashboard/print","_blank")}(e.data)}}),dt=st.mutate,ft=st.isLoading,ht=function(e){var n=e.target,t=n.name,o=n.value;V({type:"UPDATE_FIELD",field:t,value:o})},pt=function(e){var n=e.target,t=n.name,o=n.value;Q({type:"UPDATE_FIELD",field:t,value:o})},mt=function(e){var n=e.target,t=n.name,o=n.value;ee({type:"UPDATE_FIELD",field:t,value:o})};function xt(e){le().fire({title:"Are you sure?",text:"You won't to delete this Check No. ".concat(e.Check_No),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(n){var t;if(n.isConfirmed)return le().fire({text:"Check No. ".concat(e.Check_No," has delete successfully."),icon:"success",showCancelButton:!0,timer:1500}).then((function(){P((function(n){return n=n.filter((function(n){return n.temp_id!==e.temp_id}))}))}));Q({type:"UPDATE_FIELD",field:"amount",value:"0.00"}),null===(t=An.current)||void 0===t||t.removeSelection()}))}function vt(e){var n=e.target,t=n.name,o=n.value;ze({type:"UPDATE_FIELD",field:t,value:o})}function Ct(e,n){le().fire({text:e,icon:"warning",showCancelButton:!1,timer:1500}).then(n)}return(0,A.jsx)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:(0,A.jsxs)(Ie.Provider,{value:{credit:T,debit:R},children:[(0,A.jsxs)("div",{style:{height:"auto"},children:[(0,A.jsx)(s.Z,{sx:function(e){return(0,c.Z)({display:"flex",alignItems:"center",columnGap:"20px"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-start",flex:1,marginBottom:"15px"})},children:(0,A.jsx)("div",{style:{display:"flex",alignItems:"center",columnGap:"20px"},children:(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[zn?(0,A.jsx)(Ce.Z,{loading:zn}):(0,A.jsx)(d.Z,{label:"Search",size:"small",name:"search",value:q.search,onChange:ht,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return e.preventDefault(),Ln(e.target.value)},InputProps:{style:{height:"27px",fontSize:"14px"}},sx:{width:"300px",height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),!Qe&&(0,A.jsx)(f.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,A.jsx)(ae.Z,{sx:{width:15,height:15}}),id:"entry-header-save-button",onClick:function(){nn(!0),Je(!0),O((function(e){return e.set("selected",""),e})),P([]),I([]),rn(!1)},children:"New"}),(0,A.jsxs)(s.Z,{sx:{position:"relative"},children:[(0,A.jsx)(f.Z,{sx:{height:"30px",fontSize:"11px"},ref:dn,id:"save-entry-header",color:"success",variant:"contained",type:"submit",onClick:function(e){if(e.preventDefault(),""===q.ORNo)return le().fire({position:"center",icon:"warning",title:"Please provide OR number",timer:1500});if(""===q.PNo)return V({type:"UPDATE_FIELD",field:"isFao",value:!1}),le().fire({position:"center",icon:"warning",title:"Please provide PN/Client ID",timer:1500}).then((function(){(0,me.D)(350).then((function(){En()}))}));if(R.length<=0)return le().fire({position:"center",icon:"warning",title:"Please provide debit entry",timer:1500}).then((function(){(0,me.D)(300).then((function(){var e;null===(e=gn.current)||void 0===e||e.focus()}))}));if(T.length<=0)return le().fire({position:"center",icon:"warning",title:"Please provide credit entry",timer:1500}).then((function(){(0,me.D)(300).then((function(){var e;null===(e=Nn.current)||void 0===e||e.focus()}))}));if(R.reduce((function(e,n){return e+parseFloat(n.Amount.toString().replace(/,/g,""))}),0)!==T.reduce((function(e,n){return e+parseFloat(n.amount.toString().replace(/,/g,""))}),0))return le().fire({position:"center",icon:"warning",title:"Transaction is not balanced. Check if the amount you entered are correct!",timer:1500});if(q.PNo.length>=200)return le().fire({position:"center",icon:"warning",title:"PN/Client ID is too long!",timer:1500});var n={ORNo:q.ORNo,PNo:q.PNo,IDNo:q.IDNo,Date:q.Date,Name:q.Name,debit:JSON.stringify(R),credit:JSON.stringify(T),payamentType:H.payamentType};an?(0,Te.s)({isUpdate:!0,cb:function(e){ct((0,l.Z)((0,l.Z)({},n),{},{userCodeConfirmation:e,mode:""}))}}):(0,Te.L)({isConfirm:function(){ct((0,l.Z)((0,l.Z)({},n),{},{mode:""}))}})},disabled:lt&&void 0===ut.mode||!Qe,startIcon:(0,A.jsx)(de.Z,{sx:{width:15,height:15}}),children:"Save"}),lt&&void 0===ut.mode&&(0,A.jsx)(h.Z,{size:24,sx:{color:ue.Z[500],position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),Qe&&(0,A.jsx)(f.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,A.jsx)(se.Z,{sx:{width:15,height:15}}),color:"error",onClick:function(){le().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"}).then((function(e){e.isConfirmed&&(Je(!1),nn(!1),Ue(V,Ae),tt(),P([]),I([]),rn(!1))}))},children:"Cancel"}),(0,A.jsx)(Ce.Z,{loading:ft,color:"secondary",variant:"contained",sx:{height:"30px",fontSize:"11px"},disabled:!an,onClick:function(){dt({ORNo:q.ORNo})},children:"Print"})]})})}),(0,A.jsx)("form",{onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||e.preventDefault()},children:(0,A.jsx)(s.Z,{sx:function(e){return(0,c.Z)({},e.breakpoints.down("md"),{flexDirection:"column",rowGap:"10px"})},children:(0,A.jsxs)("div",{style:{display:"flex",gap:"10px",padding:"15px 0 "},children:[nt?(0,A.jsx)(Ce.Z,{loading:nt}):(0,A.jsxs)(p.Z,{sx:{width:"170px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!en||an,required:!0,children:[(0,A.jsx)(m.Z,{htmlFor:"collection-id-field",children:"OR No."}),(0,A.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},readOnly:"UCSMI"!==(null===Ye||void 0===Ye?void 0:Ye.department),disabled:!en||an,label:"OR No.",name:"ORNo",value:q.ORNo,onChange:ht,onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=dn.current)||void 0===n||n.click())},id:"collection-id-field",endAdornment:(0,A.jsx)(v.Z,{position:"end",children:(0,A.jsx)(C.Z,{disabled:!en||an,"aria-label":"search-client",color:"secondary",edge:"end",onClick:function(){tt()},children:(0,A.jsx)(Se.Z,{})})})})]}),(0,A.jsx)(xe.Z,{textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}},fullWidth:!1,disabled:!en,label:"OR Date",onChange:function(e){V({type:"UPDATE_FIELD",field:"Date",value:e})},value:new Date(q.Date),onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=dn.current)||void 0===n||n.click())}}),$n||Rn?(0,A.jsx)(Ce.Z,{loading:$n||Rn}):(0,A.jsxs)(p.Z,{sx:{width:"170px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!en,children:[(0,A.jsx)(m.Z,{htmlFor:"client-id",children:"PN/Client ID"}),(0,A.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:Tn,name:"PNo",value:q.PNo,onChange:ht,id:"client-id",onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return V({type:"UPDATE_FIELD",field:"isFao",value:!1}),En(q.PNo)},endAdornment:(0,A.jsx)(v.Z,{position:"end",children:(0,A.jsx)(C.Z,{disabled:!en,onClick:function(){En(q.PNo),V({type:"UPDATE_FIELD",field:"isFao",value:!1})},edge:"end",color:"secondary",children:(0,A.jsx)(fe.Z,{})})}),label:"PN/Client ID"})]}),(0,A.jsx)(d.Z,{required:!0,variant:"outlined",size:"small",label:"Clients Name",name:"Name",value:q.Name,onChange:ht,disabled:!en,InputProps:{readOnly:!0,style:{height:"27px",fontSize:"14px"}},onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=dn.current)||void 0===n||n.click())},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]})})})]}),(0,A.jsx)("div",{style:{position:"relative",width:"100%",overflow:"auto",flex:1},children:(0,A.jsxs)("div",{style:{position:"absolute",width:"100%",height:"auto"},children:[(0,A.jsxs)("fieldset",{style:{boxSizing:"border-box",border:"1px solid #cbd5e1",borderRadius:"5px",position:"relative",height:"500px",display:"flex",flexDirection:"column"},children:[(0,A.jsx)("legend",{children:"Particulars (Debit)"}),(0,A.jsxs)("div",{style:{display:"flex"},children:[(0,A.jsxs)(p.Z,{sx:{width:"150px",marginRight:"10px",minWidth:150,".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}},children:[(0,A.jsx)(m.Z,{id:"payment-check",children:"Payment Type"}),(0,A.jsxs)(k.Z,{inputRef:gn,disabled:!en,labelId:"payment-check",value:H.payamentType,onChange:pt,autoWidth:!0,label:"Payment Type",size:"small",name:"payamentType",sx:{height:"27px",fontSize:"14px"},children:[(0,A.jsx)(y.Z,{value:"CHK",children:"Check"}),(0,A.jsx)(y.Z,{value:"CSH",children:"Cash"})]})]}),"CHK"===H.payamentType?(0,A.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,A.jsx)(f.Z,{disabled:!en,startIcon:(0,A.jsx)(ae.Z,{sx:{width:15,height:15}}),variant:"outlined",sx:{height:"30px",fontSize:"11px"},onClick:function(){var e,n=R[R.length-1],t={CheckIdx:"",BankName:"",BankCode:"",Branch:"",Check_Date:new Date,Check_No:(0,ye.incrementCheckNo)(null===n||void 0===n?void 0:n.Check_No),Check_Amnt:"",Check_Remarks:"",CheckMode:"add"};Ue(ze,t),(0,Ne.flushSync)((function(){M(!0)})),null===(e=xn.current)||void 0===e||e.focus()},children:"Add PDC Check"}),(0,A.jsx)(Ce.Z,{sx:{height:"30px",fontSize:"11px"},loading:$n||Qn,disabled:!en,onClick:function(){Jn({PNo:q.PNo,searchCheckedList:q.searchCheckedList})},startIcon:(0,A.jsx)(ae.Z,{sx:{width:15,height:15}}),variant:"outlined",color:"success",children:"Add Check From PDC Entry"})]}):(0,A.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,A.jsx)(d.Z,{inputRef:Dn,disabled:!en||""===H.cashMode,name:"amount",label:"Amount",size:"small",value:H.amount,onChange:pt,placeholder:"0.00",InputProps:{inputComponent:ke.a,style:{height:"27px",fontSize:"14px"}},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onBlur:function(){Q({type:"UPDATE_FIELD",field:"amount",value:parseFloat(H.amount.replace(/,/g,"")).toFixed(2)})},onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=cn.current)||void 0===n||n.click())}}),""===H.cashMode?(0,A.jsx)(f.Z,{sx:{height:"30px",fontSize:"11px"},variant:"outlined",onClick:function(){Q({type:"UPDATE_FIELD",field:"cashID",value:""}),Q({type:"UPDATE_FIELD",field:"cashMode",value:"add"})},children:"Add Cash"}):(0,A.jsx)(Ce.Z,{sx:{height:"30px",fontSize:"11px"},ref:cn,loading:$n,variant:"outlined",color:"success",disabled:!en,onClick:function(){var e;if(parseFloat(H.amount.replace(/,/g,""))<=0||isNaN(parseFloat(H.amount.replace(/,/g,""))))return null===(e=Dn.current)||void 0===e||e.focus(),le().fire({position:"center",icon:"warning",title:"Please provide amount!",showConfirmButton:!1,timer:1500});var n="";H.amount=parseFloat(H.amount.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),Ve.post("/task/accounting/get-drcode-drtitle-from-collection",{code:H.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}}).then((function(e){var t,o=null===e||void 0===e?void 0:e.data.data[0],i=o.Acct_Code,r=o.Acct_Title;P((function(e){n=We(e.length>0?e[e.length-1].temp_id:"0"),"edit"===H.cashMode&&(e=e.filter((function(e){return e.temp_id!==H.cashID})),n=H.cashID);var t={Payment:"Cash",Amount:H.amount,Check_No:"",Check_Date:"",Bank_Branch:"",Acct_Code:i,Acct_Title:r,Deposit_Slip:"",Cntr:"",Remarks:"",TC:H.payamentType,Bank:"",BankName:"",Check_Remarks:"",Branch:"",temp_id:n};return(e=[].concat((0,a.Z)(e),[t])).sort((function(e,n){var t=parseInt(e.temp_id,10),o=parseInt(n.temp_id,10);return t<o?-1:t>o?1:0})),e})),Q({type:"UPDATE_FIELD",field:"amount",value:parseFloat("0".replace(/,/g,"")).toFixed(2)}),Q({type:"UPDATE_FIELD",field:"cashID",value:""}),Q({type:"UPDATE_FIELD",field:"cashMode",value:"add"}),null===(t=An.current)||void 0===t||t.removeSelection()}))},children:"Submit"})]})]}),(0,A.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative"},children:(0,A.jsx)(s.Z,{style:{height:"410px",width:"100%",overflowX:"scroll",position:"absolute"},children:(0,A.jsx)(be.Z,{ref:An,isLoading:lt||it,columns:Be,rows:R,table_id:"temp_id",isSingleSelection:!0,isRowFreeze:!1,dataSelection:function(e,n,t){var o=n.filter((function(n){return n.temp_id===e[0]}))[0];if(void 0===o||o.length<=0)return ze({type:"UPDATE_FIELD",field:"CheckIdx",value:""}),ze({type:"UPDATE_FIELD",field:"CheckMode",value:""}),Q({type:"UPDATE_FIELD",field:"cashID",value:""}),Q({type:"UPDATE_FIELD",field:"cashMode",value:""}),void Q({type:"UPDATE_FIELD",field:"amount",value:"0.00"});!function(e,n){var t;if("Cash"===e.Payment)return ze({type:"UPDATE_FIELD",field:"CheckMode",value:""}),ze({type:"UPDATE_FIELD",field:"CheckIdx",value:""}),Q({type:"UPDATE_FIELD",field:"amount",value:e.Amount}),Q({type:"UPDATE_FIELD",field:"cashID",value:e.temp_id}),void Q({type:"UPDATE_FIELD",field:"cashMode",value:"edit"});if(nn(!0),Je(!0),ze({type:"UPDATE_FIELD",field:"CheckMode",value:"edit"}),ze({type:"UPDATE_FIELD",field:"CheckIdx",value:e.temp_id}),""!==e.Deposit_Slip)return le().fire({position:"center",icon:"warning",title:"Unable to edit. Check No ".concat(e.Check_No," is a PDC deposited!"),showConfirmButton:!1,timer:1500});if(""!==e.Cntr)return le().fire({position:"center",icon:"warning",title:"Unable to edit. Check No ".concat(e.Check_No," is a PDC reference!"),showConfirmButton:!1,timer:1500});var o={CheckIdx:e.temp_id,BankName:e.BankName,BankCode:e.Bank,Branch:e.Branch,Check_Date:new Date(e.Check_Date),Check_No:e.Check_No,Check_Amnt:e.Amount,Check_Remarks:e.Remarks,CheckMode:"edit"};if("Delete"===n||"Backspace"===n)return xt(e);Ue(ze,o),(0,Ne.flushSync)((function(){M(!0)})),null===(t=un.current)||void 0===t||t.focusVisible()}(o,t),"Delete"!==t&&"Backspace"!==t||le().fire({title:"Are you sure?",text:"You won't to delete this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){if(e.isConfirmed)return P((function(e){return e=e.filter((function(e){return e.temp_id!==o.temp_id}))}))}))},footerChildren:function(){return(0,A.jsx)(Oe,{})},footerPaginationPosition:"left-right",showFooterSelectedCount:!1})})})]}),(0,A.jsx)("br",{}),(0,A.jsxs)("fieldset",{style:{boxSizing:"border-box",border:"1px solid #cbd5e1",borderRadius:"5px",position:"relative",height:"530px",display:"flex",flexDirection:"column"},children:[(0,A.jsx)("legend",{children:"Payment Breakdown (Credit)"}),(0,A.jsxs)("div",{style:{display:"flex",gap:"10px",flexDirection:"column"},children:[(0,A.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[$n?(0,A.jsx)(Ce.Z,{loading:$n}):(0,A.jsx)(g.Z,{freeSolo:!0,options:H.transaction_desc,value:$.transaction,onChange:function(e,n){n?(ee({type:"UPDATE_FIELD",field:"Code",value:n.Acct_Code}),ee({type:"UPDATE_FIELD",field:"Title",value:n.Acct_Title}),ee({type:"UPDATE_FIELD",field:"TC",value:n.Code}),ee({type:"UPDATE_FIELD",field:"transaction",value:n.label})):(ee({type:"UPDATE_FIELD",field:"Code",value:""}),ee({type:"UPDATE_FIELD",field:"Title",value:""}),ee({type:"UPDATE_FIELD",field:"TC",value:""}),ee({type:"UPDATE_FIELD",field:"transaction",value:""}))},onInput:function(e){ee({type:"UPDATE_FIELD",field:"transaction",value:e.target.value})},renderInput:function(e){return(0,A.jsx)(d.Z,(0,l.Z)((0,l.Z)({},e),{},{InputProps:(0,l.Z)((0,l.Z)({},e.InputProps),{},{inputRef:Nn,style:{height:"27px",fontSize:"14px"}}),label:"Transaction"}))},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiInputBase-input":{width:"100% !important"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"},".MuiAutocomplete-input ":{position:"absolute"}},size:"small",disabled:!en}),(0,A.jsx)(d.Z,{disabled:!en,name:"amount",label:"Amount",size:"small",value:$.amount,onChange:mt,placeholder:"0.00",InputProps:{inputComponent:ke.a,inputRef:_n,style:{height:"27px",fontSize:"14px"}},onBlur:function(){ee({type:"UPDATE_FIELD",field:"amount",value:parseFloat($.amount.replace(/,/g,"")).toFixed(2)})},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=sn.current)||void 0===e||e.click(),clearTimeout(n)}),100)},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),(0,A.jsxs)(p.Z,{sx:{width:"150px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!en,children:[(0,A.jsx)(m.Z,{htmlFor:"fao",children:"FAO"}),(0,A.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:Sn,name:"FAO_Name",value:$.FAO_Name,onChange:mt,id:"fao",onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return V({type:"UPDATE_FIELD",field:"isFao",value:!0}),En($.FAO_Name)},endAdornment:(0,A.jsx)(v.Z,{position:"end",children:(0,A.jsx)(C.Z,{disabled:!en,onClick:function(){V({type:"UPDATE_FIELD",field:"isFao",value:!0}),En($.FAO_Name)},edge:"end",color:"secondary",children:(0,A.jsx)(fe.Z,{})})}),label:"FAO"})]}),(0,A.jsx)(d.Z,{disabled:!en,name:"remarks",label:"Remarks",size:"small",value:null!==(_=$.remarks)&&void 0!==_?_:"",onChange:mt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=sn.current)||void 0===e||e.click(),clearTimeout(n)}),100)},InputProps:{style:{height:"27px",fontSize:"14px"}},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]}),(0,A.jsx)("div",{style:{display:"flex",gap:"10px",justifyContent:"space-between"},children:(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"10px"},children:[(0,A.jsxs)(w,{value:$.option,row:!0,"aria-labelledby":"option",name:"option",onChange:mt,sx:{height:"27px",display:"flex",alignItems:"center",margin:"auto",width:"170px","& .MuiSvgIcon-root":{height:15,width:15},"& .MuiTypography-root ":{fontSize:"14px !important"},"& .MuiFormControlLabel-root  ":{height:"27px"}},children:[(0,A.jsx)(F.Z,{disabled:!en||""===$.creditMode,value:"Vat",control:(0,A.jsx)(te,{size:"small"}),label:"VAT"}),(0,A.jsx)(F.Z,{disabled:!en||""===$.creditMode,value:"nonVAT",control:(0,A.jsx)(te,{size:"small"}),label:"Non-VAT"})]}),(0,A.jsx)(d.Z,{disabled:!en||""===$.creditMode,name:"invoice",label:"Invoice",size:"small",value:$.invoice,onChange:mt,InputProps:{inputRef:bn,style:{height:"27px",fontSize:"14px"}},sx:{width:"300px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=sn.current)||void 0===e||e.click(),clearTimeout(n)}),100)}}),""===$.creditMode?(0,A.jsx)(f.Z,{sx:{height:"30px",fontSize:"11px"},variant:"outlined",onClick:function(){Object.entries(we).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];ee({type:"UPDATE_FIELD",field:t,value:o})}))},children:"NEW"}):(0,A.jsx)(f.Z,{ref:sn,sx:{height:"30px",fontSize:"11px"},color:"success",variant:"outlined",onClick:function(){if(""===$.transaction||null===$.transaction||void 0===$.transaction)return Ct("Please select a transaction!",(function(){(0,me.D)(300).then((function(){var e;null===(e=Nn.current)||void 0===e||e.focus()}))}));if(H.transaction_desc.filter((function(e){return e.label===$.transaction})).length<=0)return Ct("Transaction not yet defined!",(function(){(0,me.D)(300).then((function(){var e;null===(e=Nn.current)||void 0===e||e.focus()}))}));if(parseFloat($.amount.replace(/,/g,""))<=0||isNaN(parseFloat($.amount.replace(/,/g,""))))return Ct("Please provide amount!",(function(){(0,me.D)(300).then((function(){var e;null===(e=_n.current)||void 0===e||e.focus()}))}));if(""===$.FAO_ID)return Ct("Please provide FAO!",(function(){(0,me.D)(300).then((function(){var e;null===(e=Sn.current)||void 0===e||e.focus()}))}));if(""===$.invoice)return Ct("Please provide invoice!",(function(){(0,me.D)(300).then((function(){var e;null===(e=bn.current)||void 0===e||e.focus()}))}));if($.invoice.length>=200)return Ct("Invoice is too long!",(function(){}));if($.FAO_ID.length>=200)return Ct("ID is too long!",(function(){}));if($.remarks.length>=200)return Ct("Remarks is too long!",(function(){}));if($.amount.length>=200)return Ct("Amount is too long!",(function(){}));function e(){$.amount=parseFloat($.amount).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});var e=parseInt(T.length<=0?"0":T[T.length-1].temp_id)+1,n={transaction:$.transaction,amount:$.amount,Remarks:$.remarks,Code:$.Code,Title:$.Title,TC:$.TC,Account_No:$.FAO_ID,Name:$.FAO_Name,VATType:$.option,invoiceNo:$.invoice};if(I((function(t){return"add"===$.creditMode?t=[].concat((0,a.Z)(t),[(0,l.Z)({temp_id:e},n)]):t.map((function(e){return e.temp_id===$.creditId&&(e=(0,l.Z)((0,l.Z)({},e),n)),e}))})),"Vat"===$.option){var t=.12*(parseFloat($.amount.replace(/,/g,""))/1.12),o=H.transaction_desc.filter((function(e){return"Output Tax"===e.label}))[0],i={temp_id:e+1,transaction:"Output Tax",amount:t.toFixed(2),Remarks:$.remarks,Code:o.Acct_Code,Title:o.Acct_Title,TC:o.Code,Account_No:$.FAO_ID,Name:$.FAO_Name,VATType:$.option,invoiceNo:$.invoice};I((function(e){return e=[].concat((0,a.Z)(e),[i])}))}le().fire({text:"edit"===$.creditMode?"Update Successfully":"Create Successfully",icon:"success",showCancelButton:!1,timer:1500}).then((function(){Ue(ee,we),Zn.current.removeSelection()}))}if("edit"===$.creditMode)return le().fire({title:"Are you sure?",text:"You won't to update this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update it!"}).then((function(n){if(n.isConfirmed)return e()}));e()},children:"Save"})]})})]}),(0,A.jsx)("div",{style:{marginTop:"10px",width:"100%",position:"relative"},children:(0,A.jsx)(s.Z,{style:{height:"410px",width:"100%",overflowX:"scroll",position:"absolute"},children:(0,A.jsx)(be.Z,{ref:Zn,isLoading:lt||it,columns:je,rows:T,table_id:"temp_id",isSingleSelection:!0,isRowFreeze:!1,dataSelection:function(e,n,t){var o=n.filter((function(n){return n.temp_id===e[0]}))[0];if(void 0===o||o.length<=0)Object.entries(we).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];ee({type:"UPDATE_FIELD",field:t,value:o})}));else{var i={creditMode:"edit",creditId:o.temp_id,transaction:o.transaction,amount:o.amount,remarks:o.Remarks,Code:o.Code,Title:o.Title,TC:o.TC,FAO_ID:o.Account_No,FAO_Name:o.Name,option:o.VATType,invoice:o.invoiceNo};Ue(ee,i),"Delete"!==t&&"Backspace"!==t||le().fire({title:"Are you sure?",text:"You won't to delete this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){if(e.isConfirmed)return I((function(e){return e=e.filter((function(e){return e.temp_id!==o.temp_id}))}))}))}},footerChildren:function(){return(0,A.jsx)(Ke,{})},footerPaginationPosition:"left-right",showFooterSelectedCount:!1})})})]})]})}),Fn,jn,On,Yn,(0,A.jsx)(oe.Z,{open:L,onClose:function(){var e;M(!1),null===(e=An.current)||void 0===e||e.removeSelection()},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,A.jsxs)(s.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:700,bgcolor:"background.paper",p:4},children:[(0,A.jsx)(ie.Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Check Detail"}),(0,A.jsxs)("div",{style:{display:"flex",columnGap:"10px"},children:[(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,A.jsx)(d.Z,{required:!0,variant:"outlined",size:"small",label:"Check No.",name:"Check_No",value:De.Check_No,onChange:vt,disabled:!en||""!==De.CheckIdx,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=ln.current)||void 0===e||e.click(),clearTimeout(n)}),100)},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:xn},sx:{height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),qn?(0,A.jsx)(Ce.Z,{loading:qn}):(0,A.jsxs)(p.Z,{sx:{width:"100%",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},fullWidth:!0,variant:"outlined",size:"small",disabled:!en,children:[(0,A.jsx)(m.Z,{htmlFor:"label-input-id",children:"Bank"}),(0,A.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:vn,disabled:!en,fullWidth:!0,label:"Bank",name:"BankName",value:De.BankName,onChange:vt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Kn(De.BankName)},id:"label-input-id",endAdornment:(0,A.jsx)(v.Z,{position:"end",children:(0,A.jsx)(C.Z,{disabled:!en,"aria-label":"search-client",color:"secondary",edge:"end",onClick:function(){return Kn(De.BankName)},children:(0,A.jsx)(ve.Z,{})})})})]}),(0,A.jsx)(d.Z,{required:!0,variant:"outlined",size:"small",label:"Branch",name:"Branch",value:De.Branch,onChange:vt,disabled:!en,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=ln.current)||void 0===e||e.click(),clearTimeout(n)}),100)},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:Cn},sx:{height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),(0,A.jsx)(d.Z,{required:!0,variant:"outlined",size:"small",label:"Remarks",name:"Check_Remarks",value:De.Check_Remarks,onChange:vt,disabled:!en,rows:4,multiline:!0,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=ln.current)||void 0===e||e.click(),clearTimeout(n)}),100)},InputProps:{style:{height:"auto",fontSize:"14px"}},sx:{flex:1,height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]}),(0,A.jsxs)("div",{style:{display:"flex",gap:"10px",flexDirection:"column"},children:[(0,A.jsx)(xe.Z,{disabled:!en,label:"Check Dated",onChange:function(e){ze({type:"UPDATE_FIELD",field:"Check_Date",value:e})},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=ln.current)||void 0===e||e.click(),clearTimeout(n)}),100)},value:new Date(De.Check_Date),inputRef:yn,textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}}}),(0,A.jsx)(d.Z,{required:!0,variant:"outlined",size:"small",label:"Amount",name:"Check_Amnt",value:De.Check_Amnt,onChange:vt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=ln.current)||void 0===e||e.click(),clearTimeout(n)}),100)},disabled:!en,placeholder:"0.00",InputProps:{style:{height:"27px",fontSize:"14px"},inputComponent:ke.a,inputRef:kn},sx:{flex:1,height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onBlur:function(){ze({type:"UPDATE_FIELD",field:"Check_Amnt",value:parseFloat(De.Check_Amnt.replace(/,/g,"")).toFixed(2)})}})]})]}),(0,A.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",gap:"20px"},children:[(0,A.jsx)(f.Z,{ref:ln,action:un,color:"success",variant:"contained",autoFocus:""!==De.CheckIdx,onClick:function(){if(""===De.Check_No)return M(!1),Ct("Please provide check!",(function(e){var n;(0,Ne.flushSync)((function(){M(!0)})),null===(n=xn.current)||void 0===n||n.focus()}));if(parseFloat(De.Check_Amnt.replace(/,/g,""))<=0||isNaN(parseFloat(De.Check_Amnt.replace(/,/g,""))))return M(!1),Ct("Please provide check amount!",(function(e){var n;(0,Ne.flushSync)((function(){M(!0)})),null===(n=kn.current)||void 0===n||n.focus()}));if(""===De.BankName)return M(!1),Ct("Please provide bank!",(function(e){var n;(0,Ne.flushSync)((function(){M(!0)})),null===(n=vn.current)||void 0===n||n.focus()}));if(""===De.Branch)return M(!1),Ct("Please provide branch!",(function(e){var n;(0,Ne.flushSync)((function(){M(!0)})),null===(n=Cn.current)||void 0===n||n.focus()}));if(De.BankName.length>=200)return M(!1),Ct("Bank Name is too long!",(function(e){var n;(0,Ne.flushSync)((function(){M(!0)})),null===(n=vn.current)||void 0===n||n.focus()}));if(De.Branch.length>=200)return M(!1),Ct("Branch is too long!",(function(e){var n;(0,Ne.flushSync)((function(){M(!0)})),null===(n=Cn.current)||void 0===n||n.focus()}));if(De.Check_No.length>=200)return M(!1),Ct("Check No is too long!",(function(e){var n;(0,Ne.flushSync)((function(){M(!0)})),null===(n=Cn.current)||void 0===n||n.focus()}));if(De.Check_Amnt.length>=200)return M(!1),Ct("Check Ammount is too long!",(function(e){var n;(0,Ne.flushSync)((function(){M(!0)})),null===(n=Cn.current)||void 0===n||n.focus()}));function e(){var e="";Ve.post("/task/accounting/get-drcode-drtitle-from-collection",{code:H.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===Ye||void 0===Ye?void 0:Ye.accessToken)}}).then((function(n){var t=null===n||void 0===n?void 0:n.data.data[0],o=t.Acct_Code,i=t.Acct_Title;P((function(n){e=We(n.length>0?n[n.length-1].temp_id:"0"),"edit"===De.CheckMode&&(n=n.filter((function(e){return e.temp_id!==De.CheckIdx.toString()})),e=De.CheckIdx.toString());var t={Payment:"Check",Amount:De.Check_Amnt,Check_No:De.Check_No,Check_Date:new Date(De.Check_Date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),Bank_Branch:"".concat(De.BankName," / ").concat(De.Branch),Acct_Code:o,Acct_Title:i,Deposit_Slip:"",Cntr:"",Remarks:De.Check_Remarks,TC:H.payamentType,temp_id:e,Bank:De.BankCode,BankName:De.BankName,Check_Remarks:De.Check_Remarks,Branch:De.Branch};return(n=[].concat((0,a.Z)(n),[t])).sort((function(e,n){var t=parseInt(e.temp_id,10),o=parseInt(n.temp_id,10);return t<o?-1:t>o?1:0})),n}))}))}return De.Check_Amnt=parseFloat(De.Check_Amnt.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),"edit"===De.CheckMode?((0,Ne.flushSync)((function(){M(!1)})),le().fire({title:"Are you sure? You want to Update this "+De.Check_No+" Check No.",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update it!",focusConfirm:!0}).then((function(n){n.isConfirmed&&(e(),le().fire({text:"Update Successfully",icon:"success",showCancelButton:!1,timer:1500,didClose:function(){var e,n;(0,Ne.flushSync)((function(){M(!0)})),null===(e=un.current)||void 0===e||e.focusVisible(),null===(n=An.current)||void 0===n||n.removeSelection()}}))}))):R.filter((function(e){return e.Check_No===De.Check_No})).length>0?((0,Ne.flushSync)((function(){M(!1)})),le().fire({text:"".concat(De.Check_No," is already Exist!"),icon:"warning",showCancelButton:!1,timer:1500}).then((function(){M(!1)}))):(e(),ze({type:"UPDATE_FIELD",field:"Check_No",value:(0,ye.incrementCheckNo)(De.Check_No)}),(0,Ne.flushSync)((function(){M(!1)})),void le().fire({text:"Create New Check Successfully",icon:"success",showCancelButton:!1,timer:1500,didClose:function(){var e,n;(0,Ne.flushSync)((function(){M(!1)})),null===(e=un.current)||void 0===e||e.focusVisible(),null===(n=An.current)||void 0===n||n.removeSelection()}}))},children:"Save"}),(0,A.jsx)(f.Z,{color:"warning",variant:"contained",onClick:function(){var e;M(!1),null===(e=An.current)||void 0===e||e.removeSelection()},children:"Cancel"}),""!==De.CheckIdx&&(0,A.jsx)(f.Z,{color:"error",variant:"contained",onClick:function(){(0,Ne.flushSync)((function(){M(!1)})),xt({Check_No:De.Check_No,temp_id:De.CheckIdx})},children:"Delete"})]})]})})]})})}function Ue(e,n){Object.entries(n).forEach((function(n){var t=(0,r.Z)(n,2),o=t[0],i=t[1];e({type:"UPDATE_FIELD",field:o,value:i})}))}function Oe(){var e=(0,u.useContext)(Ie).debit;return(0,A.jsx)(s.Z,{sx:{px:2,py:1,display:"flex",justifyContent:"flex-end",borderTop:"2px solid #e2e8f0"},children:(0,A.jsxs)("strong",{children:["Total:"," ",e.reduce((function(e,n){return e+parseFloat(n.Amount.replace(/,/g,""))}),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})}function Ke(){var e=(0,u.useContext)(Ie).credit;return(0,A.jsx)(s.Z,{sx:{px:2,py:1,display:"flex",justifyContent:"flex-end",borderTop:"2px solid #e2e8f0"},children:(0,A.jsxs)("strong",{children:["Total:"," ",e.reduce((function(e,n){return e+parseFloat(n.amount.replace(/,/g,""))}),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})}function We(e){var n=parseInt(e,10)+1;return String(n).padStart(3,"0")}},79012:function(e,n,t){t.d(n,{Z:function(){return C}});var o=t(63366),i=t(87462),a=t(72791),r=t(63733),c=t(94419),l=t(66934),u=t(31402),s=t(75878),d=t(21217);function f(e){return(0,d.Z)("MuiFormGroup",e)}(0,s.Z)("MuiFormGroup",["root","row","error"]);var h=t(52930),p=t(76147),m=t(80184),x=["className","row"],v=(0,l.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,t.row&&n.row]}})((function(e){var n=e.ownerState;return(0,i.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},n.row&&{flexDirection:"row"})})),C=a.forwardRef((function(e,n){var t=(0,u.Z)({props:e,name:"MuiFormGroup"}),a=t.className,l=t.row,s=void 0!==l&&l,d=(0,o.Z)(t,x),C=(0,h.Z)(),k=(0,p.Z)({props:t,muiFormControl:C,states:["error"]}),y=(0,i.Z)({},t,{row:s,error:k.error}),g=function(e){var n=e.classes,t={root:["root",e.row&&"row",e.error&&"error"]};return(0,c.Z)(t,f,n)}(y);return(0,m.jsx)(v,(0,i.Z)({className:(0,r.Z)(g.root,a),ownerState:y,ref:n},d))}))}}]);
//# sourceMappingURL=899.c0e8477a.chunk.js.map