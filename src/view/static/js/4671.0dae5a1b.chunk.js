"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[4671],{13784:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(1413),i=n(45987),o=n(71652),a=n(48193),l=n(93777),d=n(80184),s=["label","name","onChange","value","onKeyDown","inputRef","datePickerRef","fullWidth","textField","minWidth"];function c(e){var t=e.label,n=e.name,c=e.onChange,u=e.value,p=e.onKeyDown,h=e.inputRef,x=e.datePickerRef,g=e.fullWidth,f=e.textField,m=e.minWidth,y=void 0===m?"200px":m,b=(0,i.Z)(e,s);return(0,d.jsx)(o._,{dateAdapter:a.H,children:(0,d.jsx)(l.M,(0,r.Z)({floatingLabelStyle:{color:"black"},value:u,onChange:c,ref:x,slotProps:{textField:(0,r.Z)({size:"small",label:t,name:n,onKeyDown:p,inputRef:h,fullWidth:g},f)},InputLabelProps:{sx:{color:"black"}},sx:{minWidth:y,fieldset:{borderColor:"black"},".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}},b))})}},23508:function(e,t,n){n.d(t,{bq:function(){return l}});var r,i=n(74165),o=n(15861);function a(e){var t=e.data,n=e.column,r=e.beforeArrangeData,i=e.adjustMaxHeight,o=e.fontSize,a=void 0===o?"11px":o,l=e.summaryHeight,d=void 0===l?0:l,s=[],c=0,u=[],p=document.querySelector(".content").getBoundingClientRect().height-i;return t.forEach((function(e,i){e=r(e);var o=document.querySelector(".content"),l=document.createElement("table"),h=l.insertRow();e.summaryReport&&p-c<=d+20&&(c+=p-c),n.forEach((function(t){var n=h.insertCell();l.style.visibility="hidden",l.style.width="100%",l.style.fontSize=a,function(e,t,n,r,i){e.style.width=n,e.textContent=t,r.appendChild(i)}(n,e[t.datakey],t.width,o,l)})),c+=h.getBoundingClientRect().height,o.removeChild(l),u.push(e),(c>=p||i===t.length-1&&c<p)&&(s.push(u),c=0,u=[])})),s}var l=function(e){return(r=r||(0,o.Z)((0,i.Z)().mark((function e(t){var n,r,o,l,d,s,c,u;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,r=t.column,o=t.beforeArrangeData,l=t.adjustMaxHeight,d=t.cb,s=t.fontSize,c=void 0===s?"11px":s,u=t.summaryHeight,void 0!==n){e.next=3;break}return e.abrupt("return",[]);case 3:if(!d){e.next=5;break}return e.abrupt("return",d({data:n,column:r,beforeArrangeData:o,adjustMaxHeight:l}));case 5:return e.abrupt("return",a({data:n,column:r,beforeArrangeData:o,adjustMaxHeight:l,fontSize:c,summaryHeight:u}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},99101:function(e,t,n){n.r(t),n.d(t,{default:function(){return W},reducer:function(){return D}});var r=n(74165),i=n(15861),o=n(4942),a=n(1413),l=n(72791),d=n(27391),s=n(64554),c=n(68096),u=n(94925),p=n(58406),h=n(23786),x=n(91933),g=n(3380),f=n(13784),m=n(39709),y=n(48193),b=n(71652),_=n(93777),S=n(71012),j=n(23508),A=n(16386),v=n(58340),k=n(80184),C={dateFormat:"Monthly",date:new Date,sub_acct:"All",title:""},D=function(e,t){return"UPDATE_FIELD"===t.type?(0,a.Z)((0,a.Z)({},e),{},(0,o.Z)({},t.field,t.value)):e},z=[{groupHeader:"",groupId:"code"},{groupHeader:"",groupId:"title"},{groupHeader:"",groupId:"client"},{groupHeader:"",groupId:"or"},{groupHeader:"",groupId:"or"},{groupHeader:"",groupId:"or"},{groupHeader:"DEBIT",groupId:"debit"},{groupHeader:"CREDIT",groupId:"credit"},{groupHeader:"",groupId:"or"},{groupHeader:"",groupId:"or"}],F=[{groupId:"",datakey:"Date",header:"DATE",width:"90px"},{groupId:"",datakey:"IDNo",header:"ID#",width:"160px"},{groupId:"",datakey:"cName",header:"CLIENT NAME",width:"300px"},{groupId:"",datakey:"ORNo",header:"OR#",width:"80px"},{groupId:"",datakey:"Bank",header:"BANK/BRANCH",width:"100px"},{groupId:"",datakey:"cCheck_No",header:"CHECK",width:"100px"},{groupId:"debit",datakey:"Debit",header:"AMOUNT",total:!0,type:"number",width:"100px"},{groupId:"debit",datakey:"DRTitle",header:"ACCOUNTS",width:"120px"},{groupId:"credit",datakey:"Credit",header:"AMOUNT",total:!0,type:"number",width:"100px"},{groupId:"credit",datakey:"CRTitle",header:"ACCOUNTS",width:"120px"},{groupId:"",datakey:"Purpose",header:"PURPOSE",width:"300px"},{groupId:"",datakey:"CRRemarks",header:"REMARKS",width:"300px"}];function I(e,t){return"".concat("UMIS"===t?"UPWARD MANAGEMENT INSURANCE SERVICES":"UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC.","\n").concat(e.dateFormat," Abstract Collections\n").concat(function(e){var t="";"Daily"===e.dateFormat?t=e.date.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Monthly"===e.dateFormat&&(t=e.date.toLocaleDateString("en-US",{year:"numeric",month:"long"}));return t.toString()}(e))}function w(e){var t,n=e.state,a=e.dispatch,S=(0,l.useRef)(null),j=(0,l.useContext)(g.V),A=j.myAxios,v=j.user,C=(0,x.useQuery)({queryKey:"sub-accounts",queryFn:function(){return(t=t||(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("/reports/accounting/get-sub-account-acronym",{headers:{Authorization:"Bearer ".concat(null===v||void 0===v?void 0:v.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}),D=C.data,z=C.isLoading,F=function(e){var t=e.target,n=t.name,r=t.value;a({type:"UPDATE_FIELD",field:n,value:r})};return(0,k.jsxs)("div",{style:{padding:"10px"},children:[(0,k.jsx)(d.Z,{label:"Title",fullWidth:!0,name:"title",value:n.title,onChange:F,rows:6,multiline:!0,InputProps:{style:{height:"140px",fontSize:"12px"}},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),(0,k.jsxs)(s.Z,{sx:function(e){return(0,o.Z)({height:"100%",display:"grid",gridTemplateColumns:"repeat(1,1fr)",gap:"10px",margin:"10px 0"},e.breakpoints.down("sm"),{gridTemplateColumns:"repeat(1,1fr)"})},children:[(0,k.jsxs)(c.Z,{fullWidth:!0,variant:"outlined",size:"small",sx:{".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},children:[(0,k.jsx)(u.Z,{id:"date_format",children:"Report"}),(0,k.jsxs)(p.Z,{labelId:"date_format",value:n.dateFormat,label:"Report",name:"dateFormat",onChange:function(e){F(e),n.dateFormat=e.target.value,a({type:"UPDATE_FIELD",field:"title",value:I(n,null===v||void 0===v?void 0:v.department)})},sx:{height:"27px",fontSize:"14px"},children:[(0,k.jsx)(h.Z,{value:"Daily",children:"Daily"}),(0,k.jsx)(h.Z,{value:"Monthly",children:"Monthly"})]})]}),z?(0,k.jsx)(m.Z,{loading:z}):(0,k.jsxs)(c.Z,{fullWidth:!0,variant:"outlined",size:"small",sx:{".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},children:[(0,k.jsx)(u.Z,{id:"sub_account_id",children:"Sub Account"}),(0,k.jsxs)(p.Z,{labelId:"sub_account_id",value:n.sub_acct,label:"Sub Account",name:"sub_acct",onChange:F,sx:{height:"27px",fontSize:"14px"},children:[(0,k.jsx)(h.Z,{value:"All",children:"All"}),null===D||void 0===D?void 0:D.data.sub_account.map((function(e,t){return(0,k.jsx)(h.Z,{value:e.Acronym,children:e.Acronym},t)}))]})]}),"Monthly"===n.dateFormat&&(0,k.jsx)(b._,{dateAdapter:y.H,children:(0,k.jsx)(_.M,{sx:{width:"100%",".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},slotProps:{textField:{size:"small",name:"",InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}}},label:"Date",views:["month","year"],value:n.date,onChange:function(e){a({type:"UPDATE_FIELD",field:"date",value:e}),n.date=e,a({type:"UPDATE_FIELD",field:"title",value:I(n,null===v||void 0===v?void 0:v.department)})}})}),"Daily"===n.dateFormat&&(0,k.jsx)(f.Z,{fullWidth:!0,label:"Date From",onChange:function(e){a({type:"UPDATE_FIELD",field:"date",value:e}),n.date=e,a({type:"UPDATE_FIELD",field:"title",value:I(n,null===v||void 0===v?void 0:v.department)})},value:new Date(n.date),onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var t=setTimeout((function(){var e,n;null===(e=S.current)||void 0===e||null===(n=e.querySelector("button"))||void 0===n||n.click(),clearTimeout(t)}),150)},datePickerRef:S,textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}}})]})]})}function W(){var e,t=(0,l.useContext)(g.V),n=t.user,o=t.myAxios;return C.title=I(C,null===n||void 0===n?void 0:n.department),(0,k.jsx)(S.ZP,{column:F,initialState:C,Setting:function(e,t){return(0,k.jsx)(w,{state:e,dispatch:t})},onReportSubmit:function(t,a,d){return(e=e||(0,i.Z)((0,r.Z)().mark((function e(t,i,a){var d,s,c,u,p,h;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.post("/reports/accounting/abstract-collection-report",a,{headers:{Authorization:"Bearer ".concat(null===n||void 0===n?void 0:n.accessToken)}});case 2:return d=e.sent,e.next=5,d.data;case 5:s=e.sent,c=function(){return(0,k.jsx)("table",{children:(0,k.jsx)("tbody",{children:s.summary.map((function(e,t){return!e.summ||e.header||e.footer||e.signature?e.summ&&e.header?(0,k.jsx)(l.Fragment,{children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11.5px",fontWeight:"bolder",textAlign:"right"}}),(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11.5px",fontWeight:"bolder",textAlign:"center"},children:e.ORNo}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11.5px",fontWeight:"bolder",textAlign:"left"},children:e.Purpose}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11.5px",fontWeight:"bolder",textAlign:"left"},children:e.CRRemarks})]})},t):e.summ&&e.footer?(0,k.jsx)(l.Fragment,{children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right"}}),(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right"},children:e.ORNo}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right",borderTop:"1px solid black",borderBottom:"2px solid black"},children:e.Debit}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right",borderTop:"1px solid black",borderBottom:"2px solid black"},children:e.Credit})]})},t):e.summ&&e.signature?(0,k.jsxs)(l.Fragment,{children:[(0,k.jsx)("tr",{style:{height:"40px"}}),(0,k.jsx)("tr",{children:(0,k.jsx)("td",{colSpan:F.length,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"center"},children:"Prepared: ________________ \xa0\xa0\xa0\xa0\xa0 Checked: ________________ \xa0\xa0\xa0\xa0\xa0Approved: ________________"})})]},t):e.summary?(0,k.jsxs)(l.Fragment,{children:[(0,k.jsx)("tr",{style:{height:"15px"}}),(0,k.jsx)("tr",{children:(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right"},children:e.cName})}),(0,k.jsx)("tr",{style:{height:"15px"}})]},t):(0,k.jsx)(l.Fragment,{},t):(0,k.jsx)(l.Fragment,{children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"500",textAlign:"right"}}),(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"500",textAlign:"left"},children:"".concat(e.GL_Acct,"  ").concat(e.Title)}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11px",fontWeight:"500",textAlign:"right"},children:e.Debit}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11px",fontWeight:"500",textAlign:"right"},children:e.Credit})]})},t)}))})})},u=v.renderToString((0,k.jsx)(c,{})),(p=document.createElement("div")).innerHTML=u,document.body.appendChild(p),h=p.getBoundingClientRect().height,document.body.removeChild(p),(0,j.bq)({data:s.report,column:F,beforeArrangeData:function(e){return isNaN(parseFloat(e.Debit.replace(/,/g,"")))||(e.Debit=parseFloat(e.Debit.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),isNaN(parseFloat(e.Credit.replace(/,/g,"")))||(e.Credit=parseFloat(e.Credit.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),e},adjustMaxHeight:150,summaryHeight:h}).then((function(e){t(e),i(!1)}));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)},scaleDefaultValue:90,drawTable:function(e,t){return e.map((function(n,r){return(0,k.jsxs)("div",{className:"page out-page",children:[(0,k.jsx)("div",{className:"header",style:{height:"50px"}}),(0,k.jsx)("div",{className:"content",children:(0,k.jsxs)("table",{children:[(0,k.jsxs)("thead",{children:[t.title.split("\n").map((function(e,t){return(0,k.jsx)("tr",{children:(0,k.jsx)("th",{style:{fontSize:"14px",fontWeight:"bold",textAlign:"left"},colSpan:F.length,children:e})},t)})),(0,k.jsx)("tr",{style:{height:"40px"}}),(0,k.jsx)("tr",{children:z.map((function(e,t){var n=F.filter((function(t){return t.groupId===e.groupId}));return(0,k.jsx)("th",{colSpan:n.length,style:{fontSize:"10.5px",fontWeight:"bold",textAlign:"center"},children:e.groupHeader},t)}))}),(0,k.jsx)("tr",{children:F.map((function(t,n){return(0,k.jsx)("th",{onDoubleClick:function(n){return(0,S.PE)(n,t.datakey,e)},style:{width:t.width,fontSize:"10.5px",fontWeight:"bold",textAlign:"left"},children:t.header},n)}))})]}),(0,k.jsx)("tbody",{children:n.map((function(e,t){return!e.summ||e.header||e.footer||e.signature?e.summ&&e.header?(0,k.jsx)(l.Fragment,{children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11.5px",fontWeight:"bolder",textAlign:"right"}}),(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11.5px",fontWeight:"bolder",textAlign:"center"},children:e.ORNo}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11.5px",fontWeight:"bolder",textAlign:"left"},children:e.Purpose}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11.5px",fontWeight:"bolder",textAlign:"left"},children:e.CRRemarks})]})},t):e.summ&&e.footer?(0,k.jsx)(l.Fragment,{children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right"}}),(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right"},children:e.ORNo}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right",borderTop:"1px solid black",borderBottom:"2px solid black"},children:e.Debit}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right",borderTop:"1px solid black",borderBottom:"2px solid black"},children:e.Credit})]})},t):e.summ&&e.signature?(0,k.jsxs)(l.Fragment,{children:[(0,k.jsx)("tr",{style:{height:"40px"}}),(0,k.jsx)("tr",{children:(0,k.jsx)("td",{colSpan:F.length,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"center"},children:"Prepared: ________________ \xa0\xa0\xa0\xa0\xa0 Checked: ________________ \xa0\xa0\xa0\xa0\xa0Approved: ________________"})})]},t):e.summary?(0,k.jsxs)(l.Fragment,{children:[(0,k.jsx)("tr",{style:{height:"15px"}}),(0,k.jsx)("tr",{children:(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"bolder",textAlign:"right"},children:e.cName})}),(0,k.jsx)("tr",{style:{height:"15px"}})]},t):e.follows?(0,k.jsxs)(l.Fragment,{children:[(0,k.jsx)("tr",{style:{height:"10px"}}),(0,k.jsx)("tr",{children:(0,k.jsx)("td",{colSpan:F.length,style:{fontSize:"11px",fontWeight:"500",textAlign:"center"},children:e.cCheck_No})})]},t):(0,k.jsx)("tr",{children:F.map((function(n,i){return(0,k.jsx)(l.Fragment,{children:e.total&&"DRTitle"===n.datakey||e.total&&"CRTitle"===n.datakey?(0,k.jsx)(k.Fragment,{}):(0,k.jsx)("td",{onClick:S.mp,className:"editable not-looking page-".concat(r,"  row-").concat(t,"_col-").concat(i),style:{fontSize:"11px",fontWeight:e.total?"bold":"500",width:"".concat(n.width," !important"),textAlign:"number"===n.type?"right":"left",borderTop:e.total&&"Debit"===n.datakey||e.total&&"Credit"===n.datakey||e.total&&"DRTitle"===n.datakey||e.total&&"CRTitle"===n.datakey?"1px solid black":""},colSpan:e.total&&"Debit"===n.datakey||e.total&&"Credit"===n.datakey?2:1,children:e[n.datakey]})},i)}))},t):(0,k.jsx)(l.Fragment,{children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"500",textAlign:"right"}}),(0,k.jsx)("td",{colSpan:3,style:{fontSize:"11px",fontWeight:"500",textAlign:"left"},children:"".concat(e.GL_Acct,"  ").concat(e.Title)}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11px",fontWeight:"500",textAlign:"right"},children:e.Debit}),(0,k.jsx)("td",{colSpan:2,style:{fontSize:"11px",fontWeight:"500",textAlign:"right"},children:e.Credit})]})},t)}))})]})}),(0,k.jsxs)("div",{className:"footer",style:{height:"50px",display:"flex",justifyContent:"space-between"},children:[(0,k.jsx)("p",{style:{fontSize:"10px",fontWeight:"bold"},children:(0,A.Z)(new Date,"dd/MM/yyyy")}),(0,k.jsxs)("p",{style:{fontSize:"10px",fontWeight:"bold"},children:["Page ",r+1," of ",e.length]})]})]},r)}))},pageHeight:"8.5in",pageWidth:"13in",addHeaderGroup:(0,k.jsx)("tr",{children:z.map((function(e,t){var n=F.filter((function(t){return t.groupId===e.groupId}));return(0,k.jsx)("th",{colSpan:n.length,style:{fontSize:"12.5px",fontWeight:"bold",textAlign:"center"},children:e.groupHeader},t)}))})})}},45987:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(63366);function i(e,t){if(null==e)return{};var n,i,o=(0,r.Z)(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}}}]);
//# sourceMappingURL=4671.0dae5a1b.chunk.js.map