"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[4701,2074],{85074:function(e,n,t){t.r(n),t.d(n,{creditColumn:function(){return oe},debitColumn:function(){return te},default:function(){return re},reducer:function(){return $},setNewStateValue:function(){return ce}});var o=t(74165),i=t(15861),a=t(93433),r=t(29439),c=t(4942),l=t(1413),u=t(72791),d=t(64554),s=t(27391),h=t(36151),f=t(13239),p=t(68096),m=t(94925),x=t(77196),v=t(63466),C=t(13400),k=t(58406),y=t(23786),g=t(73766),D=t(88447),N=t(20890),_=t(42419),T=t(91933),I=t(21830),b=t.n(I),w=t(80007),A=t(29823),E=t(53329),S=t(91421),F=t(41128),R=t(3380),B=t(79018),Z=t(13784),P=t(99422),L=t(39709),j=t(56580),M=t(8185),z=t(93263),U=t(81582),O=t(54164),K=t(80184),q=function(e){var n,t=e.link,a=e.uniqueId,c=e.queryKey,l=e.responseDataKey,d=e.columns,s=e.onSelected,h=void 0===s?function(){}:s,f=e.onRemoveSelected,p=void 0===f?function(){}:f,m=e.onSuccess,x=void 0===m?function(){}:m,v=e.searchRef,C=e.onCellKeyDown,k=e.onCloseFunction,y=e.isRowSelectable,g=(0,u.useContext)(R.V),D=g.myAxios,N=g.user,_=(0,u.useState)(!1),I=(0,r.Z)(_,2),b=I[0],w=I[1],A=(0,u.useState)([]),E=(0,r.Z)(A,2),S=E[0],F=E[1],B=(0,T.useMutation)({mutationKey:c,mutationFn:function(e){return(n=n||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.get("".concat(t.queryWithVariable(n)),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var n=e;F(n.data[l]),x(n)}}),Z=B.isLoading,P=B.mutate;return{openSearchCollection:b,rows:S,isLoading:Z,openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,O.flushSync)((function(){w(!0)})),null!==v&&void 0!==v&&v.current&&(v.current.value=e,D.get("".concat(t.queryExtraBySearch,"=").concat(e),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l]),null!==v&&void 0!==v&&v.current&&v.current.focus()})))},closeModal:function(){var e;(w(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},ModalComponent:(0,K.jsx)(U.ZP,{searchRef:v,showModal:b,onCloseModal:function(){var e;(w(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},onClickCloseIcon:function(){var e;(w(!1),k)&&k(null===v||void 0===v||null===(e=v.current)||void 0===e?void 0:e.value)},searchOnChange:function(e){D.get("".concat(t.queryExtraBySearch,"=").concat(e.target.value),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l])}))},onSearchKeyEnter:function(e){D.get("".concat(t.queryExtraBySearch,"=").concat(e),{headers:{Authorization:"Bearer ".concat(null===N||void 0===N?void 0:N.accessToken)}}).then((function(e){if(null===e||void 0===e||!e.data.success)return alert("Error : ".concat(null===e||void 0===e?void 0:e.data.message));F(e.data[l])}))},onCellKeyDown:C,height:300,isLoading:Z,queryKey:c,columns:d,onSelectionChange:function(e,n){if(e.length<=0)return p(n);var t=new Set(e),o=n.filter((function(e){return t.has(e[a].toString())}));o.length<=0||h(o,n)},isRowSelectable:y,id:a,rows:S,setRows:F}),mutate:P}},V=t(86753),W=t(64230),Y=t(2548),H=(0,u.createContext)({debit:[],credit:[]}),G={ORNo:"",PNo:"",IDNo:"",Date:new Date,Name:"",Remarks:"",creditUpdateMode:!1,creditCheckIdx:"",creditCheckID:"",PDC_Status:"",Deposit_Slip:"",DateDeposit:"",OR_No:"",searchCheckedList:"",bank_transaction:"",isFao:!1,search:"",mode:""},Q={cashID:"",cashMode:"add",payamentType:"CSH",amount:"",transaction_desc:[],debitHasSelected:!1},J={creditMode:"add",creditId:"",transaction:"",amount:"",FAO_Name:"",FAO_ID:"",remarks:"",option:"Non-Vat",invoice:"",Code:"",Title:"",TC:""},X={CheckIdx:"",BankName:"",BankCode:"",Branch:"",Check_Date:new Date,Check_No:"",Check_Amnt:"",Check_Remarks:"",CheckMode:"add"},$=function(e,n){return"UPDATE_FIELD"===n.type?(0,l.Z)((0,l.Z)({},e),{},(0,c.Z)({},n.field,n.value)):e},ee="add-collection",ne="collection-data-search",te=[{field:"Payment",headerName:"Payment",flex:1,width:170},{field:"Amount",headerName:"Amount",flex:1,width:170,type:"number"},{field:"Check_No",headerName:"Check No",width:170},{field:"Check_Date",headerName:"Check Date",width:170},{field:"Bank_Branch",headerName:"Bank/Branch",width:300},{field:"Acct_Code",headerName:"DR Code",width:170},{field:"Acct_Title",headerName:"DR Title",width:300},{field:"Deposit_Slip",headerName:"Deposit Slip",width:170},{field:"Cntr",headerName:"Cntr",width:170},{field:"Remarks",headerName:"Remarks",width:300},{field:"TC",headerName:"TC",width:170},{field:"temp_id",headerName:"temp_id",hide:!0},{field:"Bank",headerName:"Bank",hide:!0},{field:"BankName",headerName:"BankName",hide:!0}],oe=[{field:"temp_id",headerName:"temp_id",hide:!0},{field:"transaction",headerName:"Transaction",width:200},{field:"amount",headerName:"Amount",width:150,type:"number"},{field:"Remarks",headerName:"Remarks",width:350},{field:"Code",headerName:"Code",width:150},{field:"Title",headerName:"Title",width:350},{field:"TC",headerName:"TC",width:200},{field:"Account_No",headerName:"Accoount No.",width:180},{field:"Name",headerName:"Name",width:350},{field:"VATType",headerName:"VAT Type",width:150},{field:"invoiceNo",headerName:"Invoice No",width:250}],ie="payment-type-code",ae="new-or-number";function re(){var e,n,t,I,U,re,se=(0,u.useState)([]),he=(0,r.Z)(se,2),fe=he[0],pe=he[1],me=(0,u.useState)([]),xe=(0,r.Z)(me,2),ve=xe[0],Ce=xe[1],ke=(0,u.useState)(!1),ye=(0,r.Z)(ke,2),ge=ye[0],De=ye[1],Ne=(0,F.Z)(),_e=Ne.searchParams,Te=Ne.setSearchParams,Ie=(0,u.useReducer)($,G),be=(0,r.Z)(Ie,2),we=be[0],Ae=be[1],Ee=(0,u.useReducer)($,Q),Se=(0,r.Z)(Ee,2),Fe=Se[0],Re=Se[1],Be=(0,u.useReducer)($,J),Ze=(0,r.Z)(Be,2),Pe=Ze[0],Le=Ze[1],je=(0,u.useReducer)($,X),Me=(0,r.Z)(je,2),ze=Me[0],Ue=Me[1],Oe=(0,u.useContext)(R.V),Ke=Oe.myAxios,qe=Oe.user,Ve=(0,u.useState)(""!==_e.get("selected")),We=(0,r.Z)(Ve,2),Ye=We[0],He=We[1],Ge=(0,u.useState)(""!==_e.get("selected")),Qe=(0,r.Z)(Ge,2),Je=Qe[0],Xe=Qe[1],$e=(0,u.useState)(!1),en=(0,r.Z)($e,2),nn=en[0],tn=en[1],on=(0,u.useRef)(null),an=(0,u.useRef)(null),rn=(0,u.useRef)(null),cn=(0,u.useRef)(null),ln=(0,u.useRef)(null),un=(0,u.useRef)(null),dn=(0,u.useRef)(null),sn=(0,u.useRef)(null),hn=(0,u.useRef)(null),fn=(0,u.useRef)(null),pn=(0,u.useRef)(null),mn=(0,u.useRef)(null),xn=(0,u.useRef)(null),vn=(0,u.useRef)(null),Cn=(0,u.useRef)(null),kn=(0,u.useRef)(null),yn=(0,u.useRef)(null),gn=(0,u.useRef)(null),Dn=(0,u.useRef)(null),Nn=(0,u.useRef)(null),_n=(0,u.useRef)(null),Tn=(0,T.useQueryClient)(),In=(0,u.useRef)(null),bn=(0,u.useRef)(null),wn=(0,u.useRef)(null),An=(0,u.useRef)(null),En=(0,u.useRef)(null),Sn=(0,u.useRef)(null),Fn=(0,z.Z)({link:{url:"/task/accounting/search-pdc-policy-id",queryUrlName:"searchPdcPolicyIds"},columns:[{field:"Type",headerName:"Type",width:130},{field:"IDNo",headerName:"ID No.",width:200},{field:"Name",headerName:"Name",flex:1},{field:"ID",headerName:"ID",flex:1,hide:!0}],queryKey:"collection-polidy-ids",uniqueId:"IDNo",responseDataKey:"clientsId",onSelected:function(e,n){var t;Ae({type:"UPDATE_FIELD",field:"PNo",value:e[0].IDNo}),Ae({type:"UPDATE_FIELD",field:"IDNo",value:e[0].ID}),Ae({type:"UPDATE_FIELD",field:"Name",value:null!==(t=e[0].Name)&&void 0!==t?t:""}),Pn(),(0,B.D)(50).then((function(){var e;null===(e=Cn.current)||void 0===e||e.focus()}))},searchRef:un}),Rn=Fn.ModalComponent,Bn=Fn.openModal,Zn=Fn.isLoading,Pn=Fn.closeModal,Ln=(0,z.Z)({link:{url:"/task/accounting/search-pdc-policy-id",queryUrlName:"searchPdcPolicyIds"},columns:[{field:"Type",headerName:"Type",width:130},{field:"IDNo",headerName:"ID No.",width:200},{field:"Name",headerName:"Name",flex:1},{field:"ID",headerName:"ID",flex:1,hide:!0}],queryKey:"collection-polidy-ids",uniqueId:"IDNo",responseDataKey:"clientsId",onSelected:function(e,n){var t;Le({type:"UPDATE_FIELD",field:"FAO_ID",value:e[0].IDNo}),Le({type:"UPDATE_FIELD",field:"FAO_Name",value:null!==(t=e[0].Name)&&void 0!==t?t:""}),Un(),(0,B.D)(50).then((function(){var e;null===(e=En.current)||void 0===e||e.focus()}))},searchRef:un}),jn=Ln.ModalComponent,Mn=Ln.openModal,zn=Ln.isLoading,Un=Ln.closeModal,On=(0,z.Z)({link:{url:"/task/accounting/search-collection",queryUrlName:"searchCollectionInput"},columns:[{field:"Date",headerName:"OR Date",width:170},{field:"ORNo",headerName:"OR No.",width:200},{field:"Name",headerName:"Name",flex:1}],queryKey:"collection-search",uniqueId:"ORNo",responseDataKey:"collection",onSelected:function(e,n){st({ORNo:e[0].ORNo})},onCloseFunction:function(e){Ae({type:"UPDATE_FIELD",field:"search",value:e})},searchRef:dn}),Kn=On.ModalComponent,qn=On.openModal,Vn=On.closeModal,Wn=On.isLoading,Yn=(0,z.Z)({link:{url:"/task/accounting/search-pdc-banks",queryUrlName:"searchPdcBanks"},columns:[{field:"Bank_Code",headerName:"Code",width:130},{field:"Bank",headerName:"Bank Name",flex:1}],queryKey:"collection-banks",uniqueId:"Bank_Code",responseDataKey:"pdcBanks",onSelected:function(e,n){Ue({type:"UPDATE_FIELD",field:"BankName",value:e[0].Bank}),Ue({type:"UPDATE_FIELD",field:"BankCode",value:e[0].Bank_Code}),Qn()},searchRef:sn}),Hn=Yn.ModalComponent,Gn=Yn.openModal,Qn=Yn.closeModal,Jn=Yn.isLoading,Xn=q({link:{queryWithVariable:function(e){return"/task/accounting/get-client-checked-by-id?PNo=".concat(e.PNo,"&searchCheckedList=").concat(e.searchCheckedList)},queryExtraBySearch:"/task/accounting/get-client-checked-by-id?PNo=".concat(we.PNo,"&searchCheckedList")},columns:[{field:"temp_id",headerName:"temp_id",width:0,hide:!0},{field:"Check_No",headerName:"Check No",width:130},{field:"Check_Date",headerName:"Check Date",flex:1},{field:"Amount",headerName:"Amount",width:200,type:"number"},{field:"Bank_Branch",headerName:"Bank Branch",width:200},{field:"Remarks",headerName:"Remarks",width:200,hide:!0}],queryKey:"collection-client-check",uniqueId:"temp_id",responseDataKey:"clientCheckedList",onSelected:function(e,n){ve.filter((function(e){return""!==e.Check_No})).map((function(e){return e.Check_No})).includes(e[0].Check_No)||Ke.post("/task/accounting/get-drcode-drtitle-from-collection",{code:Fe.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}}).then((function(n){var t;console.log(n);var o=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.data[0],i=o.Acct_Code,r=o.Acct_Title;Ce((function(n){var t=0;return t=n.length<=0?0:parseInt(n[n.length-1].temp_id)+1,n=[].concat((0,a.Z)(n),[{Payment:"Check",Amount:e[0].Amount,Check_No:e[0].Check_No,Check_Date:e[0].Check_Date,Bank_Branch:e[0].Bank_Branch,Acct_Code:i,Acct_Title:r,Deposit_Slip:"",Cntr:"",Remarks:e[0].Remarks,TC:Fe.payamentType,temp_id:t.toString(),Bank:e[0].Bank,BankName:e[0].BankName,Check_Remarks:e[0].Check_Remarks,Branch:e[0].Branch}])})),nt()}))},onSuccess:function(e){et()},searchRef:hn,isRowSelectable:function(e){return!ve.filter((function(e){return""!==e.Check_No})).map((function(e){return e.Check_No})).includes(e.row.Check_No)}}),$n=Xn.ModalComponent,et=Xn.openModal,nt=Xn.closeModal,tt=Xn.isLoading,ot=Xn.mutate,it=(0,T.useQuery)({queryKey:ie,queryFn:function(){return(e=e||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get("/task/accounting/get-transaction-code-title",{headers:{Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},refetchOnWindowFocus:!1,onSuccess:function(e){Re({type:"UPDATE_FIELD",field:"transaction_desc",value:e.data.transactionDesc})}}),at=it.isLoading,rt=(0,T.useQuery)({queryKey:ae,queryFn:function(){return(n=n||(0,i.Z)((0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get("/task/accounting/get-new-or-number",{headers:{Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},refetchOnWindowFocus:!1,onSuccess:function(e){var n,t,o=e;Ae({type:"UPDATE_FIELD",field:"ORNo",value:null===(n=o.data)||void 0===n?void 0:n.ORNo[0].collectionID}),Ae({type:"UPDATE_FIELD",field:"OR_No",value:null===(t=o.data)||void 0===t?void 0:t.ORNo[0].collectionID})}}),ct=rt.isLoading,lt=rt.refetch,ut=(0,T.useMutation)({mutationKey:ne,mutationFn:function(e){return(t=t||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get("/task/accounting/get-collection-data-search?ORNo=".concat(n.ORNo),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var n=e.data.collection,t=n[0].ORNo,o=n[0].Date_OR,i=n[0].ID_No,a={ORNo:t,PNo:i,IDNo:i,Date:o,Name:n[0].Short},r=[],c=[];function l(e){var n=new Date(e);return n instanceof Date&&!isNaN(n.getTime())}for(var u=0;u<=n.length-1;u++)""!==n[u].Payment&&"0"!==n[u].Debit&&r.push({Payment:n[u].Payment,Amount:n[u].Debit,Check_No:n[u].Check_No,Check_Date:l(n[u].Check_Date)?new Date(n[u].Check_Date).toLocaleDateString():"",Bank_Branch:n[u].Bank,Acct_Code:n[u].DRCode,Acct_Title:n[u].DRTitle,Deposit_Slip:n[u].SlipCode,Cntr:"",Remarks:n[u].DRRemarks,TC:n[u].Check_No?"CHK":"CSH",temp_id:"".concat(u),Bank:n[u].Bank_Code,BankName:n[u].BankName,Branch:n[u].Branch,Check_Remarks:n[u].DRRemarks}),""!==n[u].Purpose&&"0"!==n[u].Credit&&""!==n[u].CRCode&&""!==n[u].CRTitle&&""!==n[u].CRLoanID&&""!==n[u].CRLoanName&&""!==n[u].CRVatType&&""!==n[u].CRInvoiceNo&&c.push({temp_id:"".concat(u),transaction:n[u].Purpose,amount:n[u].Credit,Remarks:n[u].CRRemarks,Code:n[u].CRCode,Title:n[u].CRTitle,TC:n[u].CRTitle,Account_No:n[u].CRLoanID,Name:n[u].CRLoanName,VATType:n[u].CRVATType,invoiceNo:n[u].CRInvoiceNo});ce(Ae,a),Ce(r),pe(c),Xe(!0),He(!0),tn(!0),Vn()}}),dt=ut.isLoading,st=ut.mutate,ht=(0,T.useMutation)({mutationKey:ee,mutationFn:function(e){return(I=I||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!nn){e.next=5;break}return delete n.mode,e.next=4,Ke.post("/task/accounting/update-collection",n,{headers:{Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}});case 4:case 8:return e.abrupt("return",e.sent);case 5:return delete n.mode,e.next=8,Ke.post("/task/accounting/add-collection",n,{headers:{Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){if(e.data.success)return He(!1),Xe(!1),ce(Ae,G),Tn.invalidateQueries("collection-search"),tn(!1),Ce([]),pe([]),lt(),b().fire({position:"center",icon:"success",title:e.data.message,showConfirmButton:!1,timer:1500});b().fire({position:"center",icon:"error",title:e.data.message,showConfirmButton:!1,timer:1500})}}),ft=ht.mutate,pt=ht.isLoading,mt=ht.variables,xt=(0,T.useMutation)({mutationKey:"on-print",mutationFn:function(e){return(U=U||(0,i.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.post("/task/accounting/on-print",n,{headers:{Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){e.data.success&&function(e){var n=e.data.concat(e.data1);(0,O.flushSync)((function(){localStorage.removeItem("printString"),localStorage.setItem("dataString",JSON.stringify(n)),localStorage.setItem("paper-width","8.5in"),localStorage.setItem("paper-height","11in"),localStorage.setItem("module","collection"),"UMIS"===(null===qe||void 0===qe?void 0:qe.department)?localStorage.setItem("title","UMIS"===(null===qe||void 0===qe?void 0:qe.department)?"UPWARD MANAGEMENT INSURANCE SERVICES":"UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC."):localStorage.setItem("title","UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC.")})),window.open("/dashboard/print","_blank")}(e.data)}}),vt=xt.mutate,Ct=xt.isLoading,kt=function(e){var n=e.target,t=n.name,o=n.value;Ae({type:"UPDATE_FIELD",field:t,value:o})},yt=function(e){var n=e.target,t=n.name,o=n.value;Re({type:"UPDATE_FIELD",field:t,value:o})},gt=function(e){var n=e.target,t=n.name,o=n.value;Le({type:"UPDATE_FIELD",field:t,value:o})};function Dt(e){var n=e.target,t=n.name,o=n.value;Ue({type:"UPDATE_FIELD",field:t,value:o})}function Nt(e,n){b().fire({text:e,icon:"warning",showCancelButton:!1,timer:1500}).then(n)}var _t=window.innerWidth-70,Tt=window.innerHeight-500;return(0,K.jsxs)("div",{style:{display:"flex",flexDirection:"column",flex:1},children:[(0,K.jsxs)(H.Provider,{value:{credit:fe,debit:ve},children:[(0,K.jsxs)("div",{style:{height:"auto"},children:[(0,K.jsx)(d.Z,{sx:function(e){return(0,c.Z)({display:"flex",alignItems:"center",columnGap:"20px"},e.breakpoints.down("sm"),{flexDirection:"column",alignItems:"flex-start",flex:1,marginBottom:"15px"})},children:(0,K.jsx)("div",{style:{display:"flex",alignItems:"center",columnGap:"20px"},children:(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[Wn?(0,K.jsx)(L.Z,{loading:Wn}):(0,K.jsx)(s.Z,{label:"Search",size:"small",name:"search",value:we.search,onChange:kt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return e.preventDefault(),qn(e.target.value)},InputProps:{style:{height:"27px",fontSize:"14px"}},sx:{width:"300px",height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),!Ye&&(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,K.jsx)(_.Z,{sx:{width:15,height:15}}),id:"entry-header-save-button",onClick:function(){Xe(!0),He(!0),Te((function(e){return e.set("selected",""),e})),Ce([]),pe([]),tn(!1)},children:"New"}),(0,K.jsxs)(d.Z,{sx:{position:"relative"},children:[(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},ref:ln,id:"save-entry-header",color:"success",variant:"contained",type:"submit",onClick:function(e){if(e.preventDefault(),""===we.ORNo)return b().fire({position:"center",icon:"warning",title:"Please provide OR number",timer:1500});if(""===we.PNo)return Ae({type:"UPDATE_FIELD",field:"isFao",value:!1}),b().fire({position:"center",icon:"warning",title:"Please provide PN/Client ID",timer:1500}).then((function(){(0,B.D)(350).then((function(){Bn()}))}));if(ve.length<=0)return b().fire({position:"center",icon:"warning",title:"Please provide debit entry",timer:1500}).then((function(){(0,B.D)(300).then((function(){var e;null===(e=Cn.current)||void 0===e||e.focus()}))}));if(fe.length<=0)return b().fire({position:"center",icon:"warning",title:"Please provide credit entry",timer:1500}).then((function(){(0,B.D)(300).then((function(){var e;null===(e=yn.current)||void 0===e||e.focus()}))}));if(ve.reduce((function(e,n){return e+parseFloat(n.Amount.toString().replace(/,/g,""))}),0)!==fe.reduce((function(e,n){return e+parseFloat(n.amount.toString().replace(/,/g,""))}),0))return b().fire({position:"center",icon:"warning",title:"Transaction is not balanced. Check if the amount you entered are correct!",timer:1500});if(we.PNo.length>=200)return b().fire({position:"center",icon:"warning",title:"PN/Client ID is too long!",timer:1500});var n={ORNo:we.ORNo,PNo:we.PNo,IDNo:we.IDNo,Date:we.Date,Name:we.Name,debit:JSON.stringify(ve),credit:JSON.stringify(fe),payamentType:Fe.payamentType};nn?(0,W.s)({isUpdate:!0,cb:function(e){ft((0,l.Z)((0,l.Z)({},n),{},{userCodeConfirmation:e,mode:""}))}}):(0,W.L)({isConfirm:function(){ft((0,l.Z)((0,l.Z)({},n),{},{mode:""}))}})},disabled:pt&&void 0===mt.mode||!Ye,startIcon:(0,K.jsx)(E.Z,{sx:{width:15,height:15}}),children:"Save"}),pt&&void 0===mt.mode&&(0,K.jsx)(f.Z,{size:24,sx:{color:w.Z[500],position:"absolute",top:"50%",left:"50%",marginTop:"-12px",marginLeft:"-12px"}})]}),Ye&&(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,K.jsx)(A.Z,{sx:{width:15,height:15}}),color:"error",onClick:function(){b().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"}).then((function(e){e.isConfirmed&&(He(!1),Xe(!1),ce(Ae,G),lt(),Ce([]),pe([]),tn(!1))}))},children:"Cancel"}),(0,K.jsx)(L.Z,{loading:Ct,color:"secondary",variant:"contained",sx:{height:"30px",fontSize:"11px"},disabled:!nn,onClick:function(){vt({ORNo:we.ORNo})},children:"Print"})]})})}),(0,K.jsx)("form",{onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||e.preventDefault()},children:(0,K.jsx)(d.Z,{sx:function(e){return(0,c.Z)({},e.breakpoints.down("md"),{flexDirection:"column",rowGap:"10px"})},children:(0,K.jsxs)("div",{style:{display:"flex",gap:"10px",padding:"15px 0 "},children:[ct?(0,K.jsx)(L.Z,{loading:ct}):(0,K.jsxs)(p.Z,{sx:{width:"170px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!Je||nn,required:!0,children:[(0,K.jsx)(m.Z,{htmlFor:"collection-id-field",children:"OR No."}),(0,K.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},readOnly:"UCSMI"!==(null===qe||void 0===qe?void 0:qe.department),disabled:!Je||nn,label:"OR No.",name:"ORNo",value:we.ORNo,onChange:kt,onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=In.current)||void 0===n||n.focus())},id:"collection-id-field",endAdornment:(0,K.jsx)(v.Z,{position:"end",children:(0,K.jsx)(C.Z,{disabled:!Je||nn,"aria-label":"search-client",color:"secondary",edge:"end",onClick:function(){lt()},children:(0,K.jsx)(V.Z,{})})})})]}),(0,K.jsx)(Z.Z,{textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}},inputRef:In,fullWidth:!1,disabled:!Je,label:"OR Date",onChange:function(e){Ae({type:"UPDATE_FIELD",field:"Date",value:e})},value:new Date(we.Date),onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=_n.current)||void 0===n||n.focus())}}),at||Zn?(0,K.jsx)(L.Z,{loading:at||Zn}):(0,K.jsxs)(p.Z,{sx:{width:"170px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!Je,children:[(0,K.jsx)(m.Z,{htmlFor:"client-id",children:"PN/Client ID"}),(0,K.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:_n,name:"PNo",value:we.PNo,onChange:kt,id:"client-id",onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Ae({type:"UPDATE_FIELD",field:"isFao",value:!1}),Bn(we.PNo)},endAdornment:(0,K.jsx)(v.Z,{position:"end",children:(0,K.jsx)(C.Z,{disabled:!Je,onClick:function(){Bn(we.PNo),Ae({type:"UPDATE_FIELD",field:"isFao",value:!1})},edge:"end",color:"secondary",children:(0,K.jsx)(S.Z,{})})}),label:"PN/Client ID"})]}),(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Clients Name",name:"Name",value:we.Name,onChange:kt,disabled:!Je,InputProps:{readOnly:!0,style:{height:"27px",fontSize:"14px"}},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Bn(we.PNo)},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]})})})]}),(0,K.jsx)("div",{style:{position:"relative",width:"100%",overflow:"auto",flex:1},children:(0,K.jsxs)("div",{style:{position:"absolute",width:"100%",height:"auto"},children:[(0,K.jsxs)("fieldset",{style:{boxSizing:"border-box",border:"1px solid #cbd5e1",borderRadius:"5px",position:"relative",height:"420px",display:"flex",flexDirection:"column"},children:[(0,K.jsx)("legend",{children:"Particulars (Debit)"}),(0,K.jsxs)("div",{style:{display:"flex",marginBottom:"10px"},children:[(0,K.jsxs)(p.Z,{sx:{width:"150px",marginRight:"10px",minWidth:150,".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}},children:[(0,K.jsx)(m.Z,{id:"payment-check",children:"Payment Type"}),(0,K.jsxs)(k.Z,{inputRef:Cn,disabled:!Je,labelId:"payment-check",value:Fe.payamentType,onChange:yt,autoWidth:!0,label:"Payment Type",size:"small",name:"payamentType",sx:{height:"27px",fontSize:"14px"},children:[(0,K.jsx)(y.Z,{value:"CHK",onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||("CHK"===Fe.payamentType?(0,B.D)(150).then((function(){var e;null===(e=bn.current)||void 0===e||e.focus()})):(0,B.D)(150).then((function(){var e;null===(e=kn.current)||void 0===e||e.focus()})))},children:"Check"}),(0,K.jsx)(y.Z,{value:"CSH",onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||("CHK"===Fe.payamentType?(0,B.D)(150).then((function(){var e;null===(e=bn.current)||void 0===e||e.focus()})):(0,B.D)(150).then((function(){var e;null===(e=kn.current)||void 0===e||e.focus()})))},children:"Cash"})]})]}),"CHK"===Fe.payamentType?(0,K.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,K.jsx)(h.Z,{disabled:!Je,startIcon:(0,K.jsx)(_.Z,{sx:{width:15,height:15}}),variant:"outlined",sx:{height:"30px",fontSize:"11px"},onClick:function(){var e,n=ve[ve.length-1],t={CheckIdx:"",BankName:"",BankCode:"",Branch:"",Check_Date:new Date,Check_No:(0,M.incrementCheckNo)(null===n||void 0===n?void 0:n.Check_No),Check_Amnt:"",Check_Remarks:"",CheckMode:"add"};ce(Ue,t),(0,O.flushSync)((function(){De(!0)})),null===(e=fn.current)||void 0===e||e.focus()},ref:bn,children:"Add PDC Check"}),(0,K.jsx)(L.Z,{sx:{height:"30px",fontSize:"11px"},loading:at||tt,disabled:!Je,onClick:function(){ot({PNo:we.PNo,searchCheckedList:we.searchCheckedList})},startIcon:(0,K.jsx)(_.Z,{sx:{width:15,height:15}}),variant:"outlined",color:"success",children:"Add Check From PDC Entry"})]}):(0,K.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,K.jsx)(s.Z,{inputRef:kn,disabled:!Je||""===Fe.cashMode,name:"amount",label:"Amount",size:"small",value:Fe.amount,onChange:yt,placeholder:"0.00",InputProps:{inputComponent:j.a,style:{height:"27px",fontSize:"14px"}},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onBlur:function(){Re({type:"UPDATE_FIELD",field:"amount",value:parseFloat(Fe.amount.replace(/,/g,"")).toFixed(2)})},onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=on.current)||void 0===n||n.click())}}),""===Fe.cashMode?(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},variant:"outlined",onClick:function(){Re({type:"UPDATE_FIELD",field:"cashID",value:""}),Re({type:"UPDATE_FIELD",field:"cashMode",value:"add"})},children:"Add Cash"}):(0,K.jsx)(L.Z,{sx:{height:"30px",fontSize:"11px"},ref:on,loading:at,variant:"outlined",color:"success",disabled:!Je,onClick:function(){var e;if(parseFloat(Fe.amount.replace(/,/g,""))<=0||isNaN(parseFloat(Fe.amount.replace(/,/g,""))))return null===(e=kn.current)||void 0===e||e.focus(),b().fire({position:"center",icon:"warning",title:"Please provide amount!",showConfirmButton:!1,timer:1500});var n="";Fe.amount=parseFloat(Fe.amount.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),Ke.post("/task/accounting/get-drcode-drtitle-from-collection",{code:Fe.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}}).then((function(e){var t,o=null===e||void 0===e?void 0:e.data.data[0],i=o.Acct_Code,r=o.Acct_Title;Ce((function(e){n=de(e.length>0?e[e.length-1].temp_id:"0"),"edit"===Fe.cashMode&&(e=e.filter((function(e){return e.temp_id!==Fe.cashID})),n=Fe.cashID);var t={Payment:"Cash",Amount:Fe.amount,Check_No:"",Check_Date:"",Bank_Branch:"",Acct_Code:i,Acct_Title:r,Deposit_Slip:"",Cntr:"",Remarks:"",TC:Fe.payamentType,Bank:"",BankName:"",Check_Remarks:"",Branch:"",temp_id:n};return(e=[].concat((0,a.Z)(e),[t])).sort((function(e,n){var t=parseInt(e.temp_id,10),o=parseInt(n.temp_id,10);return t<o?-1:t>o?1:0})),e})),Re({type:"UPDATE_FIELD",field:"amount",value:parseFloat("0".replace(/,/g,"")).toFixed(2)}),Re({type:"UPDATE_FIELD",field:"cashID",value:""}),Re({type:"UPDATE_FIELD",field:"cashMode",value:"add"}),null===(t=wn.current)||void 0===t||t.resetTableSelected()}))},children:"Save Debit"})]})]}),(0,K.jsx)(Y.r,{isLoading:pt||dt,ref:wn,rows:ve,column:te,width:_t,height:Tt,dataReadOnly:!0,onSelectionChange:function(e){var n=e[0];e.length>0?function(e){var n;if("Cash"===e.Payment)return Ue({type:"UPDATE_FIELD",field:"CheckMode",value:""}),Ue({type:"UPDATE_FIELD",field:"CheckIdx",value:""}),Re({type:"UPDATE_FIELD",field:"amount",value:e.Amount}),Re({type:"UPDATE_FIELD",field:"cashID",value:e.temp_id}),void Re({type:"UPDATE_FIELD",field:"cashMode",value:"edit"});if(Xe(!0),He(!0),Ue({type:"UPDATE_FIELD",field:"CheckMode",value:"edit"}),Ue({type:"UPDATE_FIELD",field:"CheckIdx",value:e.temp_id}),""!==e.Deposit_Slip)return b().fire({position:"center",icon:"warning",title:"Unable to edit. Check No ".concat(e.Check_No," is a PDC deposited!"),showConfirmButton:!1,timer:1500});if(""!==e.Cntr)return b().fire({position:"center",icon:"warning",title:"Unable to edit. Check No ".concat(e.Check_No," is a PDC reference!"),showConfirmButton:!1,timer:1500});var t={CheckIdx:e.temp_id,BankName:e.BankName,BankCode:e.Bank,Branch:e.Branch,Check_Date:new Date(e.Check_Date),Check_No:e.Check_No,Check_Amnt:e.Amount,Check_Remarks:e.Remarks,CheckMode:"edit"};ce(Ue,t),(0,O.flushSync)((function(){De(!0)})),null===(n=rn.current)||void 0===n||n.focusVisible()}(n):(Ue({type:"UPDATE_FIELD",field:"CheckIdx",value:""}),Ue({type:"UPDATE_FIELD",field:"CheckMode",value:""}),Re({type:"UPDATE_FIELD",field:"cashID",value:""}),Re({type:"UPDATE_FIELD",field:"cashMode",value:""}),Re({type:"UPDATE_FIELD",field:"amount",value:"0.00"}))},onKeyDown:function(e,n){if("Delete"===n||"Backspace"===n){var t=e[0];b().fire({title:"Are you sure?",text:"You won't to delete this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){if(e.isConfirmed)return Ce((function(e){return e=e.filter((function(e){return e.temp_id!==t.temp_id}))}))}))}},inputsearchselector:".manok"}),(0,K.jsx)("div",{style:{width:"100%",marginTop:"20px"},children:(0,K.jsx)(le,{})})]}),(0,K.jsx)("br",{}),(0,K.jsxs)("fieldset",{style:{boxSizing:"border-box",border:"1px solid #cbd5e1",borderRadius:"5px",position:"relative",height:"460px",display:"flex",flexDirection:"column"},children:[(0,K.jsx)("legend",{children:"Payment Breakdown (Credit)"}),(0,K.jsxs)("div",{style:{display:"flex",gap:"10px",flexDirection:"column",marginBottom:"10px"},children:[(0,K.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[at?(0,K.jsx)(L.Z,{loading:at}):(0,K.jsx)(g.Z,{freeSolo:!0,options:Fe.transaction_desc,value:Pe.transaction,onChange:function(e,n){n?(Le({type:"UPDATE_FIELD",field:"Code",value:n.Acct_Code}),Le({type:"UPDATE_FIELD",field:"Title",value:n.Acct_Title}),Le({type:"UPDATE_FIELD",field:"TC",value:n.Code}),Le({type:"UPDATE_FIELD",field:"transaction",value:n.label})):(Le({type:"UPDATE_FIELD",field:"Code",value:""}),Le({type:"UPDATE_FIELD",field:"Title",value:""}),Le({type:"UPDATE_FIELD",field:"TC",value:""}),Le({type:"UPDATE_FIELD",field:"transaction",value:""}))},onInput:function(e){Le({type:"UPDATE_FIELD",field:"transaction",value:e.target.value})},renderInput:function(e){return(0,K.jsx)(s.Z,(0,l.Z)((0,l.Z)({},e),{},{InputProps:(0,l.Z)((0,l.Z)({},e.InputProps),{},{inputRef:yn,style:{height:"27px",fontSize:"14px"}}),label:"Transaction"}))},sx:{flex:1,".MuiFormLabel-root":{fontSize:"14px"},".MuiInputBase-input":{width:"100% !important"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"},".MuiAutocomplete-input ":{position:"absolute"}},onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(0,B.D)(150).then((function(){var e;null===(e=gn.current)||void 0===e||e.focus()}))},size:"small",disabled:!Je}),(0,K.jsx)(s.Z,{disabled:!Je,name:"amount",label:"Amount",size:"small",value:Pe.amount,onChange:gt,placeholder:"0.00",InputProps:{inputComponent:j.a,inputRef:gn,style:{height:"27px",fontSize:"14px"}},onBlur:function(){Le({type:"UPDATE_FIELD",field:"amount",value:parseFloat(Pe.amount.replace(/,/g,"")).toFixed(2)})},onKeyDown:function(e){var n;"Enter"!==e.code&&"NumpadEnter"!==e.code||(null===(n=Dn.current)||void 0===n||n.focus())},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),zn?(0,K.jsx)(L.Z,{loading:zn}):(0,K.jsxs)(p.Z,{sx:{width:"150px",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},variant:"outlined",size:"small",disabled:!Je,children:[(0,K.jsx)(m.Z,{htmlFor:"fao",children:"FAO"}),(0,K.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:Dn,name:"FAO_Name",value:Pe.FAO_Name,onChange:gt,id:"fao",onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Ae({type:"UPDATE_FIELD",field:"isFao",value:!0}),Mn(Pe.FAO_Name)},endAdornment:(0,K.jsx)(v.Z,{position:"end",children:(0,K.jsx)(C.Z,{disabled:!Je,onClick:function(){Ae({type:"UPDATE_FIELD",field:"isFao",value:!0}),Mn(Pe.FAO_Name)},edge:"end",color:"secondary",children:(0,K.jsx)(S.Z,{})})}),label:"FAO"})]}),(0,K.jsx)(s.Z,{disabled:!Je,name:"remarks",label:"Remarks",size:"small",value:null!==(re=Pe.remarks)&&void 0!==re?re:"",onChange:gt,onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||Sn.current.focus()},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:En},sx:{width:"160px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]}),(0,K.jsx)("div",{style:{display:"flex",gap:"10px",justifyContent:"space-between"},children:(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"10px"},children:[(0,K.jsxs)(p.Z,{sx:{width:"150px",marginRight:"10px",minWidth:150,".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-1px"}},children:[(0,K.jsx)(m.Z,{id:"payment-check",children:"VAT Type"}),(0,K.jsxs)(k.Z,{inputRef:Sn,disabled:!Je,labelId:"payment-check",value:Pe.option,onChange:gt,autoWidth:!0,label:"VAT Type",size:"small",name:"option",sx:{height:"27px",fontSize:"14px"},children:[(0,K.jsx)(y.Z,{value:"Vat",onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(0,B.D)(150).then((function(){var e;null===(e=Nn.current)||void 0===e||e.focus()}))},children:"VAT"}),(0,K.jsx)(y.Z,{value:"Non-Vat",onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(0,B.D)(150).then((function(){var e;null===(e=Nn.current)||void 0===e||e.focus()}))},children:"Non-VAT"})]})]}),(0,K.jsx)(s.Z,{disabled:!Je||""===Pe.creditMode,name:"invoice",label:"Invoice",size:"small",value:Pe.invoice,onChange:gt,InputProps:{inputRef:Nn,style:{height:"27px",fontSize:"14px"}},sx:{width:"300px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=cn.current)||void 0===e||e.click(),clearTimeout(n)}),100)}}),""===Pe.creditMode?(0,K.jsx)(h.Z,{sx:{height:"30px",fontSize:"11px"},variant:"outlined",onClick:function(){Object.entries(J).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];Le({type:"UPDATE_FIELD",field:t,value:o})}))},children:"NEW"}):(0,K.jsx)(h.Z,{disabled:!Je||""===Pe.creditMode,ref:cn,sx:{height:"30px",fontSize:"11px"},color:"success",variant:"outlined",onClick:function(){if(""===Pe.transaction||null===Pe.transaction||void 0===Pe.transaction)return Nt("Please select a transaction!",(function(){(0,B.D)(300).then((function(){var e;null===(e=yn.current)||void 0===e||e.focus()}))}));if(Fe.transaction_desc.filter((function(e){return e.label===Pe.transaction})).length<=0)return Nt("Transaction not yet defined!",(function(){(0,B.D)(300).then((function(){var e;null===(e=yn.current)||void 0===e||e.focus()}))}));if(parseFloat(Pe.amount.replace(/,/g,""))<=0||isNaN(parseFloat(Pe.amount.replace(/,/g,""))))return Nt("Please provide amount!",(function(){(0,B.D)(300).then((function(){var e;null===(e=gn.current)||void 0===e||e.focus()}))}));if(""===Pe.FAO_ID)return Nt("Please provide FAO!",(function(){(0,B.D)(300).then((function(){var e;null===(e=Dn.current)||void 0===e||e.focus()}))}));if(""===Pe.invoice)return Nt("Please provide invoice!",(function(){(0,B.D)(300).then((function(){var e;null===(e=Nn.current)||void 0===e||e.focus()}))}));if(Pe.invoice.length>=200)return Nt("Invoice is too long!",(function(){}));if(Pe.FAO_ID.length>=200)return Nt("ID is too long!",(function(){}));if(Pe.remarks.length>=200)return Nt("Remarks is too long!",(function(){}));if(Pe.amount.length>=200)return Nt("Amount is too long!",(function(){}));function e(){Pe.amount=parseFloat(Pe.amount).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});var e=parseInt(fe.length<=0?"0":fe[fe.length-1].temp_id)+1,n={transaction:Pe.transaction,amount:Pe.amount,Remarks:Pe.remarks,Code:Pe.Code,Title:Pe.Title,TC:Pe.TC,Account_No:Pe.FAO_ID,Name:Pe.FAO_Name,VATType:Pe.option,invoiceNo:Pe.invoice};if(pe((function(t){return"add"===Pe.creditMode?t=[].concat((0,a.Z)(t),[(0,l.Z)({temp_id:e},n)]):t.map((function(e){return e.temp_id===Pe.creditId&&(e=(0,l.Z)((0,l.Z)({},e),n)),e}))})),"Vat"===Pe.option){var t=.12*(parseFloat(Pe.amount.replace(/,/g,""))/1.12),o=Fe.transaction_desc.filter((function(e){return"Output Tax"===e.label}))[0],i={temp_id:e+1,transaction:"Output Tax",amount:t.toFixed(2),Remarks:Pe.remarks,Code:o.Acct_Code,Title:o.Acct_Title,TC:o.Code,Account_No:Pe.FAO_ID,Name:Pe.FAO_Name,VATType:Pe.option,invoiceNo:Pe.invoice};pe((function(e){return e=[].concat((0,a.Z)(e),[i])}))}b().fire({text:"edit"===Pe.creditMode?"Update Successfully":"Create Successfully",icon:"success",showCancelButton:!1,timer:1500}).then((function(){ce(Le,J),An.current.resetTableSelected()}))}if("edit"===Pe.creditMode)return b().fire({title:"Are you sure?",text:"You won't to update this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update it!"}).then((function(n){if(n.isConfirmed)return e()}));e()},children:"Save Credit"})]})})]}),(0,K.jsx)(Y.r,{isLoading:pt||dt,ref:An,rows:fe,column:oe,width:_t,height:Tt,dataReadOnly:!0,onSelectionChange:function(e){var n=e[0];if(e.length>0){var t={creditMode:"edit",creditId:n.temp_id,transaction:n.transaction,amount:n.amount,remarks:n.Remarks,Code:n.Code,Title:n.Title,TC:n.TC,FAO_ID:n.Account_No,FAO_Name:n.Name,option:n.VATType,invoice:n.invoiceNo};ce(Le,t)}else Object.entries(J).forEach((function(e){var n=(0,r.Z)(e,2),t=n[0],o=n[1];Le({type:"UPDATE_FIELD",field:t,value:o})}))},onKeyDown:function(e,n){if("Delete"===n||"Backspace"===n){var t=e[0];b().fire({title:"Are you sure?",text:"You won't to delete this?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){if(e.isConfirmed)return pe((function(e){return e=e.filter((function(e){return e.temp_id!==t.temp_id}))}))}))}},inputsearchselector:".manok"}),(0,K.jsx)("div",{style:{width:"100%",marginTop:"10px"},children:(0,K.jsx)(ue,{})})]})]})}),Rn,Kn,Hn,$n,jn,(0,K.jsx)(D.Z,{open:ge,onClose:function(){var e;De(!1),null===(e=wn.current)||void 0===e||e.resetTableSelected()},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,K.jsxs)(d.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:700,bgcolor:"background.paper",p:4},children:[(0,K.jsx)(N.Z,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Check Detail"}),(0,K.jsxs)("div",{style:{display:"flex",columnGap:"10px"},children:[(0,K.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Check No.",name:"Check_No",value:ze.Check_No,onChange:Dt,disabled:!Je||""!==ze.CheckIdx,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=an.current)||void 0===e||e.click(),clearTimeout(n)}),100)},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:fn},sx:{height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),Jn?(0,K.jsx)(L.Z,{loading:Jn}):(0,K.jsxs)(p.Z,{sx:{width:"100%",".MuiFormLabel-root":{fontSize:"14px",background:"white",zIndex:99,padding:"0 3px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},fullWidth:!0,variant:"outlined",size:"small",disabled:!Je,children:[(0,K.jsx)(m.Z,{htmlFor:"label-input-id",children:"Bank"}),(0,K.jsx)(x.Z,{sx:{height:"27px",fontSize:"14px"},inputRef:pn,disabled:!Je,fullWidth:!0,label:"Bank",name:"BankName",value:ze.BankName,onChange:Dt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return Gn(ze.BankName)},id:"label-input-id",endAdornment:(0,K.jsx)(v.Z,{position:"end",children:(0,K.jsx)(C.Z,{disabled:!Je,"aria-label":"search-client",color:"secondary",edge:"end",onClick:function(){return Gn(ze.BankName)},children:(0,K.jsx)(P.Z,{})})})})]}),(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Branch",name:"Branch",value:ze.Branch,onChange:Dt,disabled:!Je,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=an.current)||void 0===e||e.click(),clearTimeout(n)}),100)},InputProps:{style:{height:"27px",fontSize:"14px"},inputRef:mn},sx:{height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Remarks",name:"Check_Remarks",value:ze.Check_Remarks,onChange:Dt,disabled:!Je,rows:4,multiline:!0,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=an.current)||void 0===e||e.click(),clearTimeout(n)}),100)},InputProps:{style:{height:"auto",fontSize:"14px"}},sx:{flex:1,height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}})]}),(0,K.jsxs)("div",{style:{display:"flex",gap:"10px",flexDirection:"column"},children:[(0,K.jsx)(Z.Z,{disabled:!Je,label:"Check Dated",onChange:function(e){Ue({type:"UPDATE_FIELD",field:"Check_Date",value:e})},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=an.current)||void 0===e||e.click(),clearTimeout(n)}),100)},value:new Date(ze.Check_Date),inputRef:vn,textField:{InputLabelProps:{style:{fontSize:"14px"}},InputProps:{style:{height:"27px",fontSize:"14px"}}}}),(0,K.jsx)(s.Z,{required:!0,variant:"outlined",size:"small",label:"Amount",name:"Check_Amnt",value:ze.Check_Amnt,onChange:Dt,onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)var n=setTimeout((function(){var e;null===(e=an.current)||void 0===e||e.click(),clearTimeout(n)}),100)},disabled:!Je,placeholder:"0.00",InputProps:{style:{height:"27px",fontSize:"14px"},inputComponent:j.a,inputRef:xn},sx:{flex:1,height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}},onBlur:function(){Ue({type:"UPDATE_FIELD",field:"Check_Amnt",value:parseFloat(ze.Check_Amnt.replace(/,/g,"")).toFixed(2)})}})]})]}),(0,K.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"flex-end",gap:"20px"},children:[(0,K.jsx)(h.Z,{ref:an,action:rn,color:"success",variant:"contained",autoFocus:""!==ze.CheckIdx,onClick:function(){if(""===ze.Check_No)return De(!1),Nt("Please provide check!",(function(e){var n;(0,O.flushSync)((function(){De(!0)})),null===(n=fn.current)||void 0===n||n.focus()}));if(parseFloat(ze.Check_Amnt.replace(/,/g,""))<=0||isNaN(parseFloat(ze.Check_Amnt.replace(/,/g,""))))return De(!1),Nt("Please provide check amount!",(function(e){var n;(0,O.flushSync)((function(){De(!0)})),null===(n=xn.current)||void 0===n||n.focus()}));if(""===ze.BankName)return De(!1),Nt("Please provide bank!",(function(e){var n;(0,O.flushSync)((function(){De(!0)})),null===(n=pn.current)||void 0===n||n.focus()}));if(""===ze.Branch)return De(!1),Nt("Please provide branch!",(function(e){var n;(0,O.flushSync)((function(){De(!0)})),null===(n=mn.current)||void 0===n||n.focus()}));if(ze.BankName.length>=200)return De(!1),Nt("Bank Name is too long!",(function(e){var n;(0,O.flushSync)((function(){De(!0)})),null===(n=pn.current)||void 0===n||n.focus()}));if(ze.Branch.length>=200)return De(!1),Nt("Branch is too long!",(function(e){var n;(0,O.flushSync)((function(){De(!0)})),null===(n=mn.current)||void 0===n||n.focus()}));if(ze.Check_No.length>=200)return De(!1),Nt("Check No is too long!",(function(e){var n;(0,O.flushSync)((function(){De(!0)})),null===(n=mn.current)||void 0===n||n.focus()}));if(ze.Check_Amnt.length>=200)return De(!1),Nt("Check Ammount is too long!",(function(e){var n;(0,O.flushSync)((function(){De(!0)})),null===(n=mn.current)||void 0===n||n.focus()}));function e(){var e="";Ke.post("/task/accounting/get-drcode-drtitle-from-collection",{code:Fe.payamentType},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(null===qe||void 0===qe?void 0:qe.accessToken)}}).then((function(n){var t=null===n||void 0===n?void 0:n.data.data[0],o=t.Acct_Code,i=t.Acct_Title;Ce((function(n){e=de(n.length>0?n[n.length-1].temp_id:"0"),"edit"===ze.CheckMode&&(n=n.filter((function(e){return e.temp_id!==ze.CheckIdx.toString()})),e=ze.CheckIdx.toString());var t={Payment:"Check",Amount:ze.Check_Amnt,Check_No:ze.Check_No,Check_Date:new Date(ze.Check_Date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}),Bank_Branch:"".concat(ze.BankName," / ").concat(ze.Branch),Acct_Code:o,Acct_Title:i,Deposit_Slip:"",Cntr:"",Remarks:ze.Check_Remarks,TC:Fe.payamentType,temp_id:e,Bank:ze.BankCode,BankName:ze.BankName,Check_Remarks:ze.Check_Remarks,Branch:ze.Branch};return(n=[].concat((0,a.Z)(n),[t])).sort((function(e,n){var t=parseInt(e.temp_id,10),o=parseInt(n.temp_id,10);return t<o?-1:t>o?1:0})),n}))}))}return ze.Check_Amnt=parseFloat(ze.Check_Amnt.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),"edit"===ze.CheckMode?((0,O.flushSync)((function(){De(!1)})),b().fire({title:"Are you sure? You want to Update this "+ze.Check_No+" Check No.",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update it!",focusConfirm:!0}).then((function(n){n.isConfirmed&&(e(),b().fire({text:"Update Successfully",icon:"success",showCancelButton:!1,timer:1500,didClose:function(){var e,n;(0,O.flushSync)((function(){De(!0)})),null===(e=rn.current)||void 0===e||e.focusVisible(),null===(n=wn.current)||void 0===n||n.resetTableSelected()}}))}))):ve.filter((function(e){return e.Check_No===ze.Check_No})).length>0?((0,O.flushSync)((function(){De(!1)})),b().fire({text:"".concat(ze.Check_No," is already Exist!"),icon:"warning",showCancelButton:!1,timer:1500}).then((function(){De(!1)}))):(e(),Ue({type:"UPDATE_FIELD",field:"Check_No",value:(0,M.incrementCheckNo)(ze.Check_No)}),(0,O.flushSync)((function(){De(!1)})),void b().fire({text:"Create New Check Successfully",icon:"success",showCancelButton:!1,timer:1500,didClose:function(){var e,n;(0,O.flushSync)((function(){De(!1)})),null===(e=rn.current)||void 0===e||e.focusVisible(),null===(n=wn.current)||void 0===n||n.resetTableSelected()}}))},children:"Save"}),(0,K.jsx)(h.Z,{color:"warning",variant:"contained",onClick:function(){var e;De(!1),null===(e=wn.current)||void 0===e||e.resetTableSelected()},children:"Cancel"}),""!==ze.CheckIdx&&(0,K.jsx)(h.Z,{color:"error",variant:"contained",onClick:function(){var e;(0,O.flushSync)((function(){De(!1)})),e={Check_No:ze.Check_No,temp_id:ze.CheckIdx},b().fire({title:"Are you sure?",text:"You won't to delete this Check No. ".concat(e.Check_No),icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(n){var t;if(n.isConfirmed)return b().fire({text:"Check No. ".concat(e.Check_No," has delete successfully."),icon:"success",showCancelButton:!0,timer:1500}).then((function(){Ce((function(n){return n.filter((function(n){return n.temp_id!==e.temp_id}))}))}));Re({type:"UPDATE_FIELD",field:"amount",value:"0.00"}),null===(t=wn.current)||void 0===t||t.resetTableSelected()}))},children:"Delete"})]})]})})]}),(pt||Wn)&&(0,K.jsx)("div",{className:"loading-component",children:(0,K.jsx)("div",{className:"loader"})})]})}function ce(e,n){Object.entries(n).forEach((function(n){var t=(0,r.Z)(n,2),o=t[0],i=t[1];e({type:"UPDATE_FIELD",field:o,value:i})}))}function le(){var e=(0,u.useContext)(H).debit;return(0,K.jsx)(d.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,K.jsxs)("strong",{style:{fontSize:"14px"},children:["Total:"," ",e.reduce((function(e,n){return e+parseFloat(n.Amount.replace(/,/g,""))}),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})}function ue(){var e=(0,u.useContext)(H).credit;return(0,K.jsx)(d.Z,{sx:{px:2,py:1,display:"flex",justifyContent:"flex-end"},children:(0,K.jsxs)("strong",{style:{fontSize:"14px"},children:["Total:"," ",e.reduce((function(e,n){return e+parseFloat(n.amount.replace(/,/g,""))}),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})}function de(e){var n=parseInt(e,10)+1;return String(n).padStart(3,"0")}}}]);
//# sourceMappingURL=4701.f6d64380.chunk.js.map