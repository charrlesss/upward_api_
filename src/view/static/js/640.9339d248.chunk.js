"use strict";(self.webpackChunkupward=self.webpackChunkupward||[]).push([[640,2074],{44158:function(e,t,n){n.r(t),n.d(t,{default:function(){return q},reducer:function(){return F}});var o=n(93433),r=n(74165),a=n(15861),i=n(29439),c=n(4942),u=n(1413),l=n(72791),d=n(27391),s=n(36151),p=n(16088),f=n(39709),h=n(42419),m=n(29823),x=n(21830),y=n.n(x),g=n(3380),v=n(91933),w=n(93263),b=n(79018),D=n(84669),S=n(95643),N=n(5519),I=n(37209),k=n(16386),C=n(8185),E=n(64230),j=n(54164),A=n(30948),T=n(70272),R=n(80184),Z={sub_refNo:"",refNo:"",dateEntry:(0,k.Z)(new Date,"yyyy-MM-dd"),explanation:"",particulars:"",totalDebit:"",totalCredit:"",totalBalance:"",jobAutoExp:!1,jobTransactionDate:new Date,jobType:"",search:"",cashMode:""},F=function(e,t){return"UPDATE_FIELD"===t.type?(0,u.Z)((0,u.Z)({},e),{},(0,c.Z)({},t.field,t.value)):e},L=[{key:"code",label:"Code",width:150,type:"text"},{key:"acctName",label:"Account Name",width:400,type:"text"},{key:"subAcctName",label:"Sub Account",width:170,type:"text",readonly:function(){return!0}},{key:"ClientName",label:"Name",width:400,type:"text"},{key:"debit",label:"Debit",width:120,type:"number"},{key:"credit",label:"Credit",width:120,type:"number"},{key:"checkNo",label:"Check No",width:120,type:"text",readonly:function(e,t,n,o){return"1.01.10"!==e[0]}},{key:"checkDate",label:"Check Date",width:120,type:"date",readonly:function(e,t,n,o){return"1.01.10"!==e[0]}},{key:"TC_Code",label:"TC",width:120,type:"text"},{key:"remarks",label:"Remarks",width:400,type:"text"},{key:"Payto",label:"Payto",width:400,type:"text",readonly:function(e,t,n,o){return"1.01.10"!==e[0]}},{key:"vatType",label:"Vat Type",width:100,type:"select",options:[{key:"NON-VAT"},{key:"VAT"}],setDefaultValue:function(){return"NON-VAT"}},{key:"invoice",label:"Invoice",width:200,type:"text"},{key:"TempID",label:"TempId",hide:!0},{key:"IDNo",label:"I.D.",width:300,hide:!0},{key:"BranchCode",headerName:"BranchCode",width:300,hide:!0},{key:"addres",headerName:"addres",hide:!0},{key:"subAcct",headerName:"subAcct",hide:!0},{key:"TC_Desc",headerName:"TC_Desc",hide:!0}];function q(){var e,t,n,o,c,u=(0,l.useRef)(null),p=(0,l.useContext)(g.V),x=p.myAxios,k=p.user,A=(0,l.useReducer)(F,Z),q=(0,i.Z)(A,2),U=q[0],P=q[1],_=(0,l.useRef)(null),K=(0,l.useRef)(null),z=(0,l.useRef)(null),B=(0,l.useRef)(null),O=(0,l.useRef)(null),V=(0,l.useRef)(null),W=(0,l.useState)(""),G=(0,i.Z)(W,2),J=G[0],Y=G[1],X=(0,l.useState)(0),H=(0,i.Z)(X,2),Q=H[0],$=H[1],ee=(0,l.useState)(0),te=(0,i.Z)(ee,2),ne=te[0],oe=te[1],re=(0,l.useState)(0),ae=(0,i.Z)(re,2),ie=ae[0],ce=ae[1],ue=""===J,le=(0,v.useQuery)({queryKey:"general-journal-id-generator",queryFn:function(){return(e=e||(0,a.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("/task/accounting/cash-disbursement/generate-id",{headers:{Authorization:"Bearer ".concat(null===k||void 0===k?void 0:k.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},refetchOnWindowFocus:!1,onSuccess:function(e){var t=e;P({type:"UPDATE_FIELD",field:"refNo",value:t.data.generatedId[0].id}),P({type:"UPDATE_FIELD",field:"sub_refNo",value:t.data.generatedId[0].id})}}),de=le.isLoading,se=le.refetch,pe=(0,w.Z)({link:{url:"/task/accounting/general-journal/get-chart-account",queryUrlName:"chartAccountSearch"},columns:[{field:"Acct_Code",headerName:"Account Code",width:130},{field:"Acct_Title",headerName:"Account Title.",width:250},{field:"Short",headerName:"Short",flex:1}],queryKey:"get-chart-account",uniqueId:"Acct_Code",responseDataKey:"getChartOfAccount",onSelected:function(e,t){var n=u.current.getSelectedIndex(),o=u.current.getData();o[n][0]=e[0].Acct_Code,o[n][1]=e[0].Acct_Title,u.current.updateData(o),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(n,".col-3"));null===e||void 0===e||e.focus()})),xe()},searchRef:V}),fe=pe.ModalComponent,he=pe.openModal,me=pe.isLoading,xe=pe.closeModal,ye=(0,w.Z)({link:{url:"/task/accounting/search-pdc-policy-id",queryUrlName:"searchPdcPolicyIds"},columns:[{field:"Type",headerName:"Type",width:130},{field:"IDNo",headerName:"ID No.",width:200},{field:"Name",headerName:"Name",flex:1},{field:"ID",headerName:"ID",hide:!0}],queryKey:"get-policyId-ClientId-RefId",uniqueId:"IDNo",responseDataKey:"clientsId",onSelected:function(e){var t=u.current.getSelectedIndex(),n=u.current.getData();n[t][3]=e[0].Name,n[t][14]=e[0].IDNo,n[t][17]=e[0].sub_account,n[t][2]=e[0].ShortName,n[t][16]=e[0].address,u.current.updateData(n),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(t,".col-4"));null===e||void 0===e||e.focus()})),be()},searchRef:O}),ge=ye.ModalComponent,ve=ye.openModal,we=ye.isLoading,be=ye.closeModal,De=(0,w.Z)({link:{url:"/task/accounting/general-journal/get-transaction-account",queryUrlName:"transactionCodeSearch"},columns:[{field:"Code",headerName:"Code",width:130},{field:"Description",headerName:"Description",flex:1}],queryKey:"get-transaction-account",uniqueId:"Code",responseDataKey:"getTransactionAccount",onSelected:function(e){var t=u.current.getSelectedIndex(),n=u.current.getData();n[t][8]=e[0].Code,n[t][18]=e[0].Description,u.current.updateData(n),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(t,".col-9"));null===e||void 0===e||e.focus()})),ke()},searchRef:O}),Se=De.ModalComponent,Ne=De.openModal,Ie=De.isLoading,ke=De.closeModal,Ce=(0,w.Z)({link:{url:"/task/accounting/search-payto-clients-name",queryUrlName:"searchPdcPolicyIds"},columns:[{field:"Type",headerName:"Type",width:130},{field:"IDNo",headerName:"ID No.",width:200},{field:"Name",headerName:"Name",flex:1},{field:"ID",headerName:"ID",hide:!0}],queryKey:"get-policyId-ClientId-RefId",uniqueId:"IDNo",responseDataKey:"clientsId",onSelected:function(e){var t=u.current.getSelectedIndex(),n=u.current.getData();n[t][10]=e[0].Name,u.current.updateData(n),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(t,".col-11"));null===e||void 0===e||e.focus()})),Te()},searchRef:O}),Ee=Ce.ModalComponent,je=Ce.openModal,Ae=Ce.isLoading,Te=Ce.closeModal,Re=(0,v.useMutation)({mutationKey:"get-selected-search-general-journal",mutationFn:function(e){return(t=t||(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.post("/task/accounting/cash-disbursement/get-selected-search-cash-disbursement",t,{headers:{Authorization:"Bearer ".concat(null===k||void 0===k?void 0:k.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e.data.selectedCashDisbursement,n=t[0],o=n.explanation,r=n.dateEntry,a=n.refNo,i=n.particulars;P({type:"UPDATE_FIELD",field:"sub_refNo",value:a}),P({type:"UPDATE_FIELD",field:"refNo",value:a}),P({type:"UPDATE_FIELD",field:"dateEntry",value:r}),P({type:"UPDATE_FIELD",field:"explanation",value:o}),P({type:"UPDATE_FIELD",field:"particulars",value:i});var c=t.map((function(e,t){return e.credit=parseFloat(e.credit.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),e.debit=parseFloat(e.debit.replace(/,/g,"")).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),"1.01.10"===e.code?e.checkDate=new Date(e.checkDate).toISOString().split("T")[0]:e.checkDate="",[e.code,e.acctName,e.subAcctName,e.ClientName,e.debit,e.credit,e.checkNo,e.checkDate,e.TC_Code,e.remarks,e.Payto,e.vatType,e.invoice,e.TempID,e.IDNo,e.Branch_Code,e.refNo,e.address,e.subAcct]}));(0,b.D)(250).then((function(){var e,t;null===(e=u.current)||void 0===e||e.updateData(c),null===(t=u.current)||void 0===t||t.setNewRowIndex(0),Xe(c),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(0,".col-0"));e&&e.focus()}))}))}}),Ze=Re.mutate,Fe=Re.isLoading,Le=(0,w.Z)({link:{url:"/task/accounting/cash-disbursement/search-cash-disbursement",queryUrlName:"searchCashDisbursement"},columns:[{field:"Date_Entry",headerName:"Date",width:130},{field:"Source_No",headerName:"Ref No.",width:250},{field:"Explanation",headerName:"Explanation",flex:1}],queryKey:"search-cash-disbursement",uniqueId:"Source_No",responseDataKey:"search",onSelected:function(e,t){Ze({Source_No:e[0].Source_No}),Y("update"),Pe()},onCloseFunction:function(e){},searchRef:V}),qe=Le.ModalComponent,Me=Le.openModal,Ue=Le.isLoading,Pe=Le.closeModal,_e=(0,v.useMutation)({mutationKey:"add-cash-disbursement",mutationFn:function(e){return(n=n||(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.post("/task/accounting/cash-disbursement/add-cash-disbursement",t,{headers:{Authorization:"Bearer ".concat(null===k||void 0===k?void 0:k.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e;return t.data.success?(He(),y().fire({position:"center",icon:"success",title:t.data.message,timer:1500})):y().fire({position:"center",icon:"warning",title:t.data.message,timer:1500})}}),Ke=_e.mutate,ze=_e.isLoading,Be=(0,v.useMutation)({mutationKey:"void-cash-disbursement",mutationFn:function(e){return(o=o||(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.post("/task/accounting/cash-disbursement/void-cash-disbursement",t,{headers:{Authorization:"Bearer ".concat(null===k||void 0===k?void 0:k.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e;return t.data.success?(He(),y().fire({position:"center",icon:"success",title:t.data.message,timer:1500})):y().fire({position:"center",icon:"warning",title:t.data.message,timer:1500})}}),Oe=Be.mutate,Ve=Be.isLoading,We=(0,v.useMutation)({mutationKey:"get-selected-search-general-journal",mutationFn:function(e){return(c=c||(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.post("/task/accounting/cash-disbursement/print",t,{headers:{Authorization:"Bearer ".concat(null===k||void 0===k?void 0:k.accessToken)}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onSuccess:function(e){var t=e;(0,j.flushSync)((function(){localStorage.removeItem("printString"),localStorage.setItem("dataString",JSON.stringify(t.data.print.PrintTable)),localStorage.setItem("paper-width","8.5in"),localStorage.setItem("paper-height","11in"),localStorage.setItem("module","cash-disbursement"),localStorage.setItem("state",JSON.stringify(t.data.print.PrintPayeeDetails)),localStorage.setItem("column",JSON.stringify([{datakey:"Account",header:"ACCOUNT",width:"200px"},{datakey:"Identity",header:"IDENTITY",width:"277px"},{datakey:"Debit",header:"DEBIT",width:"100px"},{datakey:"Credit",header:"CREDIT",width:"100px"}])),localStorage.setItem("title","UMIS"===(null===k||void 0===k?void 0:k.department)?"UPWARD MANAGEMENT INSURANCE SERVICES\n":"UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC.\n")})),window.open("/dashboard/print","_blank")}}),Ge=We.mutate,Je=We.isLoading,Ye=(0,l.useCallback)((function(){if(""===U.refNo)return y().fire({position:"center",icon:"warning",title:"Please provide reference number!",timer:1500});if(""===U.explanation)return y().fire({position:"center",icon:"warning",title:"Please provide explanation!",timer:1500}).then((function(){(0,b.D)(300).then((function(){var e;null===(e=z.current)||void 0===e||e.focus()}))}));if(Q<=0&&ne<=0)return y().fire({position:"center",icon:"warning",title:"Total Debit and Credit amount must not be zero(0), please double check the entries",timer:1500});if(Q!==ne)return y().fire({position:"center",icon:"warning",title:"Total Debit and Credit amount must be balance, please double check the entries",timer:1500});var e=u.current.getData().filter((function(e){return""!==e[0]})).map((function(e,t){return{code:e[0],acctName:e[1],subAcctName:e[2],ClientName:e[3],debit:e[4],credit:e[5],checkNo:e[6],checkDate:e[7],TC_Code:e[8],remarks:e[9],Payto:e[10],vatType:e[11],invoice:e[12],TempID:t,IDNo:e[14],BranchCode:e[15],addres:e[16],subAcct:e[17],TC_Desc:e[18]}}));"update"===J?(0,E.s)({isUpdate:!0,cb:function(t){Ke({hasSelected:"update"===J,refNo:U.refNo,dateEntry:U.dateEntry,explanation:U.explanation,particulars:U.particulars,cashDisbursement:e,userCodeConfirmation:t})}}):(0,E.L)({isConfirm:function(){Ke({hasSelected:"update"===J,refNo:U.refNo,dateEntry:U.dateEntry,explanation:U.explanation,particulars:U.particulars,cashDisbursement:e})}})}),[U,Ke,J,ne,Q]);function Xe(e){var t=(null===e||void 0===e?void 0:e.reduce((function(e,t){var n=0;return isNaN(parseFloat(t[5].replace(/,/g,"")))||(n=parseFloat(t[5].replace(/,/g,""))),e+n}),0))||0,n=(null===e||void 0===e?void 0:e.reduce((function(e,t){var n=0;return isNaN(parseFloat(t[4].replace(/,/g,"")))||(n=parseFloat(t[4].replace(/,/g,""))),e+n}),0))||0;ce(e.length),$(n),oe(t)}function He(){Y(""),(0,C.setNewStateValue)(P,Z),se(),$(0),oe(0),ce(0),(0,b.D)(250).then((function(){var e,t,n;null===(e=u.current)||void 0===e||e.updateData([]),null===(t=u.current)||void 0===t||t.AddRow(),null===(n=u.current)||void 0===n||n.setNewRowIndex(0),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(0,".col-0"));e&&e.focus()}))}))}return(0,l.useEffect)((function(){var e=function(e){(e.ctrlKey||e.metaKey)&&"s"===e.key&&(e.preventDefault(),Ye())};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[Ye]),Fe||de||we||me||Ae||Ie?(0,R.jsx)("div",{children:"Loading..."}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(T.Z,{title:"Cash Disbursement"}),(0,R.jsxs)("div",{children:[(0,R.jsx)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:(0,R.jsxs)("div",{style:{display:"flex",alignItems:"center",columnGap:"5px"},children:[Ue?(0,R.jsx)(f.Z,{loading:Ue}):(0,R.jsx)(d.Z,{label:"Search",size:"small",name:"search",onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code)return e.preventDefault(),Me(e.target.value)},InputProps:{style:{height:"27px",fontSize:"14px"}},sx:{width:"300px",height:"27px",".MuiFormLabel-root":{fontSize:"14px"},".MuiFormLabel-root[data-shrink=false]":{top:"-5px"}}}),""===J&&(0,R.jsx)(s.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,R.jsx)(h.Z,{sx:{width:15,height:15}}),id:"entry-header-save-button",onClick:function(){Y("add")},color:"primary",children:"New"}),(0,R.jsx)(f.Z,{sx:{height:"30px",fontSize:"11px"},loading:ze,disabled:""===J,onClick:Ye,color:"success",variant:"contained",children:"Save"}),""!==J&&(0,R.jsx)(f.Z,{sx:{height:"30px",fontSize:"11px"},variant:"contained",startIcon:(0,R.jsx)(m.Z,{sx:{width:15,height:15}}),color:"error",onClick:function(){y().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"}).then((function(e){e.isConfirmed&&He()}))},disabled:""===J,children:"Cancel"}),(0,R.jsx)(f.Z,{sx:{height:"30px",fontSize:"11px",background:S.Z[500],":hover":{background:S.Z[600]}},onClick:function(){(0,E.s)({isUpdate:!1,text:"Are you sure you want to void ".concat(U.refNo),cb:function(e){Oe({refNo:U.refNo,dateEntry:U.dateEntry,userCodeConfirmation:e})}})},loading:Ve,disabled:"update"!==J,variant:"contained",startIcon:(0,R.jsx)(D.Z,{sx:{width:20,height:20}}),children:"Void"}),(0,R.jsx)(f.Z,{loading:Je,disabled:"update"!==J,id:"basic-button","aria-haspopup":"true",onClick:function(){Ge({Source_No:U.refNo})},sx:{height:"30px",fontSize:"11px",color:"white",backgroundColor:N.Z[600],"&:hover":{backgroundColor:N.Z[700]}},children:"Print"})]})}),(0,R.jsxs)("div",{style:{display:"flex",marginBottom:"10px"},children:[(0,R.jsxs)("fieldset",{style:{border:"1px solid #cbd5e1",borderRadius:"5px",position:"relative",flex:1,height:"auto",display:"flex",marginTop:"10px",gap:"10px",padding:"15px",flexDirection:"column"},children:[de?(0,R.jsx)(f.Z,{loading:de}):(0,R.jsx)(I.oi,{label:{title:"Reference CV- : ",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},input:{disabled:ue,type:"text",style:{width:"190px"},readOnly:!0,value:U.refNo,name:"refNo",onKeyDown:function(e){var t;"NumpadEnter"!==e.code&&"Enter"!==e.code||(null===(t=K.current)||void 0===t||t.focus())}},inputRef:_}),(0,R.jsx)(I.oi,{label:{title:"Date : ",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},input:{disabled:ue,type:"date",name:"dateEntry",value:U.dateEntry,style:{width:"190px"},onKeyDown:function(e){var t;"NumpadEnter"!==e.code&&"Enter"!==e.code||(null===(t=z.current)||void 0===t||t.focus())},onChange:function(e){P({type:"UPDATE_FIELD",field:"dateEntry",value:e.target.value})}},inputRef:K}),(0,R.jsx)(I.oi,{label:{title:"Explanation : ",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},input:{disabled:ue,type:"text",style:{flex:1},name:"explanation",value:U.explanation,onChange:function(e){P({type:"UPDATE_FIELD",field:"explanation",value:e.target.value})},onKeyDown:function(e){var t;"NumpadEnter"!==e.code&&"Enter"!==e.code||(null===(t=B.current)||void 0===t||t.focus())}},inputRef:z}),(0,R.jsx)(I.Fz,{label:{title:"Particulars : ",style:{fontSize:"12px",fontWeight:"bold",width:"100px"}},textarea:{rows:4,disabled:ue,style:{flex:1},name:"particulars",value:U.particulars,onKeyDown:function(e){"NumpadEnter"===e.code||e.code},onChange:function(e){P({type:"UPDATE_FIELD",field:"particulars",value:e.target.value})}},_inputRef:B})]}),(0,R.jsxs)("fieldset",{style:{border:"1px solid #cbd5e1",borderRadius:"5px",position:"relative",width:"400px",height:"auto",display:"flex",marginTop:"10px",gap:"10px",padding:"15px"},children:[(0,R.jsx)("div",{style:{alignItems:"center",display:"flex",textAlign:"center",width:"100px"},children:(0,R.jsxs)("p",{style:{margin:0,padding:0,color:"black",display:"flex",flexDirection:"column"},children:[(0,R.jsx)("span",{style:{fontSize:"12px"},children:"Total Rows:"})," ",(0,R.jsx)("strong",{children:ie})]})}),(0,R.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",flexDirection:"column",flex:1},children:[(0,R.jsxs)("p",{style:{margin:0,padding:0,color:"black"},children:[(0,R.jsx)("span",{style:{fontSize:"12px"},children:"Total Debit:"})," ",(0,R.jsx)("strong",{children:Q.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,R.jsxs)("p",{style:{margin:0,padding:0,color:"black"},children:[(0,R.jsx)("span",{style:{fontSize:"12px"},children:"Total Credit:"})," ",(0,R.jsx)("strong",{children:ne.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})]}),(0,R.jsxs)("p",{style:{margin:0,padding:0,color:"black"},children:[(0,R.jsx)("span",{style:{fontSize:"12px"},children:"Balance:"})," ",(0,R.jsx)("strong",{style:{color:Q-ne>0?"red":"black"},children:(Q-ne).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})})]})]})]})]}),(0,R.jsx)(M,{height:"300px",ref:u,rows:[],columns:L.filter((function(e){return!e.hide})),onInputKeyDown:function(e,t,n){var o=u.current.getData();if(0===t)he(n);else if(3===t)ve(n);else if(8===t)Ne(n);else if(10===t&&"1.01.10"===o[e][0])je(n);else if(5===t&&"1.01.10"!==o[e][0]){var r=document.querySelector(".input.row-".concat(e,".col-").concat(t+3));r&&r.focus()}else if(9===t&&"1.01.10"!==o[e][0]){var a=document.querySelector(".input.row-".concat(e,".col-").concat(t+2));a&&a.focus()}else{var i=document.querySelector(".input.row-".concat(e,".col-").concat(t+1));if(i)i.focus();else if(function(){var e=u.current.getSelectedIndex(),t=u.current.getData();if(""===t[e][0])return alert("Account Code is required"),(0,b.D)(500).then((function(){var t=document.querySelector(".input.row-".concat(e,".col-0"));t&&t.focus()})),!1;if(""!==t[e][0]&&"1.01.10"===t[e][0]&&""===t[e][6])return alert("Check No is required"),(0,b.D)(500).then((function(){var t=document.querySelector(".input.row-".concat(e,".col-6"));t&&t.focus()})),!1;if(""!==t[e][0]&&"1.01.10"===t[e][0]&&""===t[e][7])return alert("Check Date is required"),(0,b.D)(500).then((function(){var t=document.querySelector(".input.row-".concat(e,".col-7"));t&&t.focus()})),!1;if(""!==t[e][0]&&"1.01.10"===t[e][0]&&""===t[e][10])return alert("Pay To is required"),(0,b.D)(500).then((function(){var t=document.querySelector(".input.row-".concat(e,".col-10"));t&&t.focus()})),!1;if(""===t[e][3])return alert("Name is required"),(0,b.D)(500).then((function(){var t=document.querySelector(".input.row-".concat(e,".col-3"));t&&t.focus()})),!1;if(t[e][4]===t[e][5])return alert("Credit and Debit cannot be the same. They must have a difference."),(0,b.D)(500).then((function(){var t=document.querySelector(".input.row-".concat(e,".col-4"));t&&t.focus()})),!1;if(""===t[e][8])return alert("TC is required"),(0,b.D)(500).then((function(){var t=document.querySelector(".input.row-".concat(e,".col-8"));t&&t.focus()})),!1;if("VAT"===t[e][11]&&"1.06.02"!==t[e][0]){var n=parseFloat(t[e][5].replace(/,/g,"")),o=parseFloat(t[e][4].replace(/,/g,"")),r=0;0!==o?(r=o/1.12,t[e][4]=r.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})):(r=n/1.12,t[e][5]=r.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}));var a=L.filter((function(e){return!e.hide})).map((function(e){return e.setDefaultValue?e.setDefaultValue():""})),i=.12*r;t.push(a),t[e+1][0]="1.06.02",t[e+1][1]="Input Tax",t[e+1][2]=t[e][2],t[e+1][3]=t[e][3],0!==parseFloat(t[e][4].replace(/,/g,""))?(t[e+1][4]=i.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),t[e+1][5]=t[e][5]):(t[e+1][5]=i.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),t[e+1][4]=t[e][4]),t[e+1][6]=t[e][6],t[e+1][7]=t[e][7],t[e+1][8]=t[e][8],t[e+1][9]=t[e][9],t[e+1][10]=t[e][10],t[e+1][11]=t[e][11],t[e+1][12]=t[e][12],t[e+1][13]=t[e][13],t[e+1][14]=t[e][14],t[e+1][15]=t[e][15],t[e+1][16]=t[e][16],t[e+1][17]=t[e][17],t[e+1][18]=t[e][18],u.current.updateData(t)}return Xe(t),!0}())if(window.confirm("Add New Row?")){u.current.AddRow();var c=u.current.getSelectedIndex();"vat"===o[c][11].toLowerCase()?(u.current.setNewRowIndex(c+2),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(c+2,".col-0"));e&&e.focus()}))):(u.current.setNewRowIndex(c+1),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(c+1,".col-0"));e&&e.focus()})))}}},RightClickComponent:function(e){var t=e.rowItm,n={padding:"5px 10px",margin:"0px",background:"transparent",color:"black",fontSize:"14px",width:"100%",borderRadius:"0px",textAlign:"left"};return(0,R.jsxs)("div",{children:[(0,R.jsx)("button",{className:"button-r",style:n,onClick:function(){!function(){var e,t=u.current.getData(),n=null===(e=u.current)||void 0===e?void 0:e.getSelectedIndex();y().fire({title:"Are you sure?",text:"Do you want Delete This Row",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((function(e){if(e.isConfirmed)if(1===t.length){var o,r,a;null===(o=u.current)||void 0===o||o.updateData([]),null===(r=u.current)||void 0===r||r.AddRow(),null===(a=u.current)||void 0===a||a.setNewRowIndex(0),(0,b.D)(250).then((function(){var e=document.querySelector(".input.row-".concat(0,".col-0"));e&&e.focus()}))}else{var i,c=n;c>-1&&c<t.length&&t.splice(c,1);var l=t;null===(i=u.current)||void 0===i||i.updatePages(l)}}))}()},children:"Delete"}),"1.01.10"===t[0]&&(0,R.jsx)("button",{className:"button-r",style:n,onClick:function(){!function(e){(0,j.flushSync)((function(){localStorage.removeItem("printString"),localStorage.setItem("dataString",JSON.stringify([])),localStorage.setItem("paper-width","8.5in"),localStorage.setItem("paper-height","11in"),localStorage.setItem("module","cash-disbursement-check"),localStorage.setItem("state",JSON.stringify({checkDate:e[7],Payto:e[10],credit:e[5]})),localStorage.setItem("column",JSON.stringify([])),localStorage.setItem("title","UMIS"===(null===k||void 0===k?void 0:k.department)?"UPWARD MANAGEMENT INSURANCE SERVICES\n":"UPWARD CONSULTANCY SERVICES AND MANAGEMENT INC.\n")})),window.open("/dashboard/print","_blank")}(t)},children:"Print"})]})}}),ge,fe,Ee,Se,qe]})]})}var M=(0,l.forwardRef)((function(e,t){var n=e.rows,r=e.columns,a=e.onInputKeyDown,c=e.height,u=e.RightClickComponent,d=(0,l.useRef)(null),s=(0,l.useRef)(null),f=(0,l.useState)([]),h=(0,i.Z)(f,2),m=h[0],x=h[1],y=(0,l.useState)(0),g=(0,i.Z)(y,2),v=g[0],w=g[1],D=(0,l.useState)(n),S=(0,i.Z)(D,2),N=S[0],k=S[1],C=(0,l.useState)(r),E=(0,i.Z)(C,2),j=E[0],T=E[1],Z=j.reduce((function(e,t){return e+t.width}),0),F=(0,l.useState)(0),L=(0,i.Z)(F,2),q=L[0],M=L[1],P=(0,l.useRef)((function(){var e=j.map((function(e){return e.setDefaultValue?e.setDefaultValue():""}));k((function(t){return[].concat((0,o.Z)(t),[e])}))}));(0,l.useImperativeHandle)(t,(function(){return{getSelectedIndex:function(){return q},onInputKeyDown:function(e,t,n){a(e,t,n)},updateData:function(e){k(e)},updatePages:function(e){var t=U(e,100);x(t)},getData:function(){return N},AddRow:function(){P.current()},setNewRowIndex:function(e){M(e)}}})),(0,l.useEffect)((function(){P.current()}),["add"]),(0,l.useEffect)((function(){var e=U(N,100);x(e)}),[N]);var _=function(){return(0,R.jsxs)("tr",{children:[(0,R.jsx)("th",{className:"header",style:{width:"30px",border:"1px solid black",position:"sticky",top:0,zIndex:1,background:"white"}}),j.map((function(e,t){return(0,R.jsxs)("th",{className:"header col-".concat(t," ").concat(e.key),style:{width:e.width,border:"1px solid black",position:"sticky",top:0,zIndex:1,background:"white"},children:[(0,R.jsx)("div",{className:"resize-handle",onMouseDown:function(e){e.preventDefault(),function(e,t){t.preventDefault(),t.stopPropagation();var n=t.clientX,a=r[e].width,i=function(t){var i=a+(t.clientX-n),c=(0,o.Z)(r);c[e].width=i>50?i:50,T(c)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",(function e(){document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",e)}))}(t,e)}}),e.label]},t)}))]})};function K(e,t,n){"ArrowDown"===n.code&&M((function(n){return e>=m[v].length-1?n:((0,b.D)(150).then((function(){var n=document.querySelector(".input.row-".concat(e+1,".col-").concat(t));n&&n.focus()})),e+1)})),"ArrowUp"===n.code&&M((function(n){return e<=0?n:((0,b.D)(150).then((function(){var n=document.querySelector(".input.row-".concat(e-1,".col-").concat(t));n&&n.focus()})),e-1)}))}var z=(0,l.forwardRef)((function(e,t){var n=e.rowIdx,o=e.colIdx,r=e.colItm,a=e.rowItm,c=e.parentRef,d=(0,l.useState)(""===a[o]&&"date"===r.type&&"1.01.10"===a[0]?(new Date).toISOString().split("T")[0]:a[o]),s=(0,i.Z)(d,2),p=s[0],f=s[1],h=(0,l.useRef)(a[o]),m=(0,l.useRef)(null),x=(0,l.useState)(!1),y=(0,i.Z)(x,2),g=y[0],v=y[1],w=function(e){e.preventDefault(),v(!0)};(0,l.useEffect)((function(){var e=function(e){m.current&&!m.current.contains(e.target)&&v(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[]);var b=null,D=q===n?"#082f49":"black";return b=q===n?"select"===r.type?(0,R.jsx)(I.lq,{label:{title:"",style:{width:"0px",display:"none"}},select:{readOnly:r.readonly&&(null===r||void 0===r?void 0:r.readonly(a,r,n,o)),className:"input row-".concat(n," col-").concat(o," ").concat(r.key),style:{width:"100%",height:"22px",background:q===n?"transparent":"white",padding:0,margin:0,border:"none",cursor:"pointer",color:D},value:p,onChange:function(e){f(e.target.value)},onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(k((function(e){return e[n][o]=p,e})),h.current=p,c.current&&c.current.onInputKeyDown(n,o,p)),K(n,o,e)},onBlur:function(){f(h.current)},onContextMenu:function(e){return w(e)}},datasource:r.options,values:"key",display:"key"}):"number"===r.type?(0,R.jsx)(A.h3,{readOnly:r.readonly&&(null===r||void 0===r?void 0:r.readonly(a,r,n,o)),className:"input row-".concat(n," col-").concat(o," ").concat(r.key),value:p,getInputRef:t,decimalScale:2,fixedDecimalScale:!0,onValueChange:function(e){f(e.formattedValue)},style:{width:"100%",height:"100%",background:q===n?"transparent":"white",margin:0,border:"none",cursor:"pointer",color:D},onKeyDown:function(e){if("Enter"===e.code||"NumpadEnter"===e.code){var t=e.currentTarget.value;""!==t&&null!==t&&void 0!==t?isNaN(parseFloat(t.replace(/,/g,"")))?(f("0.00"),k((function(e){return e[n][o]="0.00",e})),h.current="0.00"):(k((function(e){return e[n][o]=p,e})),h.current=p):(f("0.00"),k((function(e){return e[n][o]="0.00",e})),h.current="0.00"),c.current&&c.current.onInputKeyDown(n,o,p)}K(n,o,e)},onBlur:function(e){f(h.current)},onContextMenu:function(e){w(e)},allowNegative:!1,thousandSeparator:!0,valueIsNumericString:!0}):"date"===r.type?(0,R.jsx)("input",{readOnly:r.readonly&&(null===r||void 0===r?void 0:r.readonly(a,r,n,o)),className:"input row-".concat(n," col-").concat(o," ").concat(r.key),style:{width:"100%",height:"100%",background:q===n?"transparent":"white",margin:0,border:"none",cursor:"pointer",color:D},type:""===p?"text":"date",value:p,onChange:function(e){f(e.target.value)},onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(k((function(e){return e[n][o]=p,e})),h.current=p,c.current&&c.current.onInputKeyDown(n,o,p)),K(n,o,e)},onBlur:function(){f(h.current)},onContextMenu:function(e){w(e)}}):(0,R.jsx)("input",{readOnly:r.readonly&&(null===r||void 0===r?void 0:r.readonly(a,r,n,o)),className:"input row-".concat(n," col-").concat(o," ").concat(r.key),style:{width:"100%",height:"100%",background:q===n?"transparent":"white",margin:0,border:"none",cursor:"pointer",color:D},value:p,onChange:function(e){f(e.target.value)},onKeyDown:function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(k((function(e){return e[n][o]=p,e})),h.current=p,c.current&&c.current.onInputKeyDown(n,o,p)),K(n,o,e)},onBlur:function(){f(h.current)},onContextMenu:function(e){w(e)}}):(0,R.jsx)("input",{readOnly:q!==n,className:"input row-".concat(n," col-").concat(o," ").concat(r.key),style:{width:"100%",height:"100%",border:"none",cursor:"pointer",color:D},value:a[o],onDoubleClick:function(e){M(n)},onContextMenu:function(e){e.preventDefault()},onKeyDown:function(e){K(n,o,e)}}),(0,R.jsxs)(R.Fragment,{children:[b,g&&(0,R.jsx)("div",{ref:m,style:{position:"absolute",top:"110%",left:"0px",background:"#e2e8f0",width:"80px",height:"auto",padding:"7px 0",boxShadow:"-3px -1px 13px -8px rgba(0,0,0,0.75)",border:"1px solid #cbd5e1",zIndex:"99999"},children:(0,R.jsx)(u,{rowItm:a,colItm:r,rowIdx:n,colIdx:o})})]})})),B=(0,l.forwardRef)((function(e,t){var n=e.rowItm,o=e.rowIdx,r=e.parentRef,a=(0,l.useRef)(null),c=(0,l.useState)(!1),d=(0,i.Z)(c,2),s=d[0],p=d[1];return(0,l.useEffect)((function(){var e=function(e){a.current&&!a.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[]),(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)("td",{style:{position:"relative",borderBottom:"1px solid black",borderLeft:"1px solid black",borderTop:"none",borderRight:"1px solid black",cursor:"pointer",background:q===o?"#bae6fd":""},children:[(0,R.jsx)("input",{style:{cursor:"pointer"},readOnly:!0,type:"checkbox",checked:q===o,onClick:function(){M(o),(0,b.D)(150).then((function(){var e=document.querySelector(".input.row-".concat(o,".col-0"));e&&e.focus()}))},onContextMenu:function(e){e.preventDefault(),o===q&&(p(!0),setTimeout((function(){a.current&&a.current.scrollIntoView({behavior:"smooth"})}),100))}}),s&&(0,R.jsx)("div",{ref:a,style:{position:"absolute",top:"110%",left:"0px",background:"#e2e8f0",width:"80px",height:"auto",padding:"7px 0",boxShadow:"-3px -1px 13px -8px rgba(0,0,0,0.75)",border:"1px solid #cbd5e1",zIndex:"99999"},children:(0,R.jsx)(u,{rowItm:n,colItm:null,rowIdx:o,colIdx:null})})]}),j.map((function(e,t){return(0,R.jsx)("td",{className:"td row-".concat(o," col-").concat(t," ").concat(e.key),style:{width:e.width,padding:"0 important",margin:0,background:q===o?"#bae6fd":"",position:"relative",height:"22px",borderBottom:"1px solid black",borderLeft:"1px solid black",borderTop:"none",borderRight:"1px solid black",cursor:"pointer"},children:(0,R.jsx)(z,{rowIdx:o,colIdx:t,colItm:e,rowItm:n,parentRef:r})},t)}))]})})),O=(0,l.forwardRef)((function(e,t){var n,o=e.parentRef;return(0,R.jsx)("tbody",{children:null===(n=m[v])||void 0===n?void 0:n.map((function(e,t){return(0,R.jsx)("tr",{className:"tr row-".concat(t),children:(0,R.jsx)(B,{parentRef:o,rowItm:e,rowIdx:t})},t)}))})}));return(0,R.jsxs)(l.Fragment,{children:[(0,R.jsx)("div",{ref:d,style:{width:"calc(100vw - 40px)",height:c,overflow:"auto",position:"relative"},children:(0,R.jsx)("div",{style:{position:"absolute",width:"".concat(Z,"px"),height:"auto"},children:(0,R.jsxs)("table",{style:{borderCollapse:"collapse",width:"100%",position:"relative"},children:[(0,R.jsx)("thead",{children:(0,R.jsx)(_,{})}),(0,R.jsx)(O,{ref:s,parentRef:t})]})})}),(0,R.jsxs)("div",{style:{width:"calc(100vw - 40px)",display:"flex",height:"40px"},children:[(0,R.jsx)("div",{style:{width:"50%",display:"flex",alignItems:"center"},children:(0,R.jsxs)("span",{style:{fontSize:"14px"},children:["Records : ",N.length]})}),(0,R.jsx)("div",{style:{width:"50%",display:"flex",justifyContent:"flex-end",alignItems:"center"},children:(0,R.jsx)(p.Z,{count:m.length,onChange:function(e,t){w(t-1)}})})]})]})}));function U(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=[],o=0;o<e.length;o+=t)n.push(e.slice(o,o+t));return n}},84669:function(e,t,n){var o=n(64836);t.Z=void 0;var r=o(n(45649)),a=n(80184),i=(0,r.default)((0,a.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8 0-1.85.63-3.55 1.69-4.9L16.9 18.31C15.55 19.37 13.85 20 12 20zm6.31-3.1L7.1 5.69C8.45 4.63 10.15 4 12 4c4.42 0 8 3.58 8 8 0 1.85-.63 3.55-1.69 4.9z"}),"NotInterested");t.Z=i},95643:function(e,t){t.Z={50:"#fbe9e7",100:"#ffccbc",200:"#ffab91",300:"#ff8a65",400:"#ff7043",500:"#ff5722",600:"#f4511e",700:"#e64a19",800:"#d84315",900:"#bf360c",A100:"#ff9e80",A200:"#ff6e40",A400:"#ff3d00",A700:"#dd2c00"}}}]);
//# sourceMappingURL=640.9339d248.chunk.js.map